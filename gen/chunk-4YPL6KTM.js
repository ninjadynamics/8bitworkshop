import{C as ht,P as At,S as vt,T as St,U as rt,Z as Ct,g as ae,i as dt,r as nt}from"./chunk-JC7DT6V7.js";var xn=[{mn:"BRK",am:"",nb:1,il:0,c1:7,c2:0},{mn:"ORA",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"SLO",am:"(aa,x)",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa",nb:2,il:1,c1:3,c2:0},{mn:"ORA",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"ASL",am:"aa",nb:2,il:0,c1:5,c2:0},{mn:"SLO",am:"aa",nb:2,il:1,c1:5,c2:0},{mn:"PHP",am:"",nb:1,il:0,c1:3,c2:0},{mn:"ORA",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"ASL",am:"",nb:1,il:0,c1:2,c2:0},{mn:"ANC",am:"#aa",nb:2,il:1,c1:2,c2:0},{mn:"NOP",am:"AAAA",nb:3,il:1,c1:4,c2:0},{mn:"ORA",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"ASL",am:"AAAA",nb:3,il:0,c1:6,c2:0},{mn:"SLO",am:"AAAA",nb:3,il:1,c1:6,c2:0},{mn:"BPL",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"ORA",am:"(aa),y",nb:2,il:0,c1:5,c2:1},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"SLO",am:"(aa),y",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa,x",nb:2,il:1,c1:4,c2:0},{mn:"ORA",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"ASL",am:"aa,x",nb:2,il:0,c1:6,c2:0},{mn:"SLO",am:"aa,x",nb:2,il:1,c1:6,c2:1},{mn:"CLC",am:"",nb:1,il:0,c1:2,c2:0},{mn:"ORA",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"NOP",am:"",nb:1,il:1,c1:0,c2:0},{mn:"SLO",am:"AAAA,y",nb:3,il:1,c1:7,c2:1},{mn:"NOP",am:"AAAA,x",nb:3,il:1,c1:4,c2:1},{mn:"ORA",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"ASL",am:"AAAA,x",nb:3,il:0,c1:7,c2:0},{mn:"SLO",am:"AAAA,x",nb:3,il:1,c1:7,c2:1},{mn:"JSR",am:"AAAA",nb:3,il:0,c1:6,c2:0},{mn:"AND",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"RLA",am:"(aa,x)",nb:2,il:1,c1:8,c2:1},{mn:"BIT",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"AND",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"ROL",am:"aa",nb:2,il:0,c1:5,c2:0},{mn:"RLA",am:"aa",nb:2,il:1,c1:5,c2:0},{mn:"PLP",am:"",nb:1,il:0,c1:4,c2:0},{mn:"AND",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"ROL",am:"",nb:1,il:0,c1:2,c2:0},{mn:"ANC",am:"#aa",nb:2,il:1,c1:2,c2:0},{mn:"BIT",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"AND",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"ROL",am:"AAAA",nb:3,il:0,c1:6,c2:0},{mn:"RLA",am:"AAAA",nb:3,il:1,c1:6,c2:0},{mn:"BMI",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"AND",am:"(aa),y",nb:2,il:0,c1:5,c2:1},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"RLA",am:"(aa),y",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa,x",nb:2,il:1,c1:4,c2:0},{mn:"AND",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"ROL",am:"aa,x",nb:2,il:0,c1:6,c2:0},{mn:"RLA",am:"aa,x",nb:2,il:1,c1:6,c2:1},{mn:"SEC",am:"",nb:1,il:0,c1:2,c2:0},{mn:"AND",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"NOP",am:"",nb:1,il:1,c1:0,c2:0},{mn:"RLA",am:"AAAA,y",nb:3,il:1,c1:7,c2:1},{mn:"NOP",am:"AAAA,x",nb:3,il:1,c1:4,c2:1},{mn:"AND",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"ROL",am:"AAAA,x",nb:3,il:0,c1:7,c2:0},{mn:"RLA",am:"AAAA,x",nb:3,il:1,c1:7,c2:1},{mn:"RTI",am:"",nb:1,il:0,c1:6,c2:0},{mn:"EOR",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"SRE",am:"(aa,x)",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa",nb:2,il:1,c1:3,c2:0},{mn:"EOR",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"LSR",am:"aa",nb:2,il:0,c1:5,c2:0},{mn:"SRE",am:"aa",nb:2,il:1,c1:5,c2:0},{mn:"PHA",am:"",nb:1,il:0,c1:3,c2:0},{mn:"EOR",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"LSR",am:"",nb:1,il:0,c1:2,c2:0},{mn:"ASR",am:"#aa",nb:2,il:1,c1:2,c2:0},{mn:"JMP",am:"AAAA",nb:3,il:0,c1:3,c2:0},{mn:"EOR",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"LSR",am:"AAAA",nb:3,il:0,c1:6,c2:0},{mn:"SRE",am:"AAAA",nb:3,il:1,c1:6,c2:0},{mn:"BVC",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"EOR",am:"(aa),y",nb:2,il:0,c1:5,c2:1},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"SRE",am:"(aa),y",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa,x",nb:2,il:1,c1:4,c2:0},{mn:"EOR",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"LSR",am:"aa,x",nb:2,il:0,c1:6,c2:0},{mn:"SRE",am:"aa,x",nb:2,il:1,c1:6,c2:1},{mn:"CLI",am:"",nb:1,il:0,c1:2,c2:0},{mn:"EOR",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"NOP",am:"",nb:1,il:1,c1:0,c2:0},{mn:"SRE",am:"AAAA,y",nb:3,il:1,c1:7,c2:1},{mn:"NOP",am:"AAAA,x",nb:3,il:1,c1:4,c2:1},{mn:"EOR",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"LSR",am:"AAAA,x",nb:3,il:0,c1:7,c2:0},{mn:"SRE",am:"AAAA,x",nb:3,il:1,c1:7,c2:1},{mn:"RTS",am:"",nb:1,il:0,c1:6,c2:0},{mn:"ADC",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"RRA",am:"(aa,x)",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa",nb:2,il:1,c1:3,c2:0},{mn:"ADC",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"ROR",am:"aa",nb:2,il:0,c1:5,c2:0},{mn:"RRA",am:"aa",nb:2,il:1,c1:5,c2:0},{mn:"PLA",am:"",nb:1,il:0,c1:4,c2:0},{mn:"ADC",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"ROR",am:"",nb:1,il:0,c1:2,c2:0},{mn:"ARR",am:"#aa",nb:2,il:1,c1:2,c2:0},{mn:"JMP",am:"(AAAA)",nb:3,il:0,c1:5,c2:0},{mn:"ADC",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"ROR",am:"AAAA",nb:3,il:0,c1:6,c2:0},{mn:"RRA",am:"AAAA",nb:3,il:1,c1:6,c2:0},{mn:"BVS",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"ADC",am:"(aa),y",nb:2,il:0,c1:5,c2:1},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"RRA",am:"(aa),y",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa,x",nb:2,il:1,c1:4,c2:0},{mn:"ADC",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"ROR",am:"aa,x",nb:2,il:0,c1:6,c2:0},{mn:"RRA",am:"aa,x",nb:2,il:1,c1:6,c2:1},{mn:"SEI",am:"",nb:1,il:0,c1:2,c2:0},{mn:"ADC",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"NOP",am:"",nb:1,il:1,c1:0,c2:0},{mn:"RRA",am:"AAAA,y",nb:3,il:1,c1:7,c2:1},{mn:"NOP",am:"AAAA,x",nb:3,il:1,c1:4,c2:1},{mn:"ADC",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"ROR",am:"AAAA,x",nb:3,il:0,c1:7,c2:0},{mn:"RRA",am:"AAAA,x",nb:3,il:1,c1:7,c2:1},{mn:"NOP",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"STA",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"NOP",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"SAX",am:"(aa,x)",nb:2,il:1,c1:6,c2:1},{mn:"STY",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"STA",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"STX",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"SAX",am:"aa",nb:2,il:1,c1:3,c2:0},{mn:"DEY",am:"",nb:1,il:0,c1:2,c2:0},{mn:"NOP",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"TXA",am:"",nb:1,il:0,c1:2,c2:0},{mn:"ANE",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"STY",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"STA",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"STX",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"SAX",am:"AAAA",nb:3,il:1,c1:4,c2:0},{mn:"BCC",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"STA",am:"(aa),y",nb:2,il:0,c1:6,c2:0},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"SHA",am:"(aa),y",nb:2,il:1,c1:0,c2:0},{mn:"STY",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"STA",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"STX",am:"aa,y",nb:2,il:0,c1:4,c2:0},{mn:"SAX",am:"aa,y",nb:3,il:1,c1:4,c2:1},{mn:"TYA",am:"",nb:1,il:0,c1:2,c2:0},{mn:"STA",am:"AAAA,y",nb:3,il:0,c1:5,c2:0},{mn:"TXS",am:"",nb:1,il:0,c1:2,c2:0},{mn:"SHS",am:"AAAA,y",nb:3,il:1,c1:0,c2:0},{mn:"SHY",am:"AAAA,x",nb:3,il:1,c1:0,c2:0},{mn:"STA",am:"AAAA,x",nb:3,il:0,c1:5,c2:0},{mn:"SHX",am:"AAAA,y",nb:3,il:1,c1:0,c2:0},{mn:"SHA",am:"AAAA,y",nb:3,il:1,c1:0,c2:0},{mn:"LDY",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"LDA",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"LDX",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"LAX",am:"(aa,x)",nb:2,il:1,c1:6,c2:1},{mn:"LDY",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"LDA",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"LDX",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"LAX",am:"aa",nb:2,il:1,c1:3,c2:0},{mn:"TAY",am:"",nb:1,il:0,c1:2,c2:0},{mn:"LDA",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"TAX",am:"",nb:1,il:0,c1:2,c2:0},{mn:"LXA",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"LDY",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"LDA",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"LDX",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"LAX",am:"AAAA",nb:3,il:1,c1:4,c2:0},{mn:"BCS",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"LDA",am:"(aa),y",nb:2,il:0,c1:5,c2:1},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"LAX",am:"(aa),y",nb:2,il:1,c1:5,c2:1},{mn:"LDY",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"LDA",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"LDX",am:"aa,y",nb:2,il:0,c1:4,c2:0},{mn:"LAX",am:"aa,y",nb:2,il:1,c1:4,c2:1},{mn:"CLV",am:"",nb:1,il:0,c1:2,c2:0},{mn:"LDA",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"TSX",am:"",nb:1,il:0,c1:2,c2:0},{mn:"LAS",am:"AAAA,y",nb:3,il:1,c1:0,c2:0},{mn:"LDY",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"LDA",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"LDX",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"LAX",am:"AAAA,y",nb:3,il:1,c1:4,c2:1},{mn:"CPY",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"CMP",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"NOP",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"DCP",am:"(aa,x)",nb:2,il:1,c1:8,c2:1},{mn:"CPY",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"CMP",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"DEC",am:"aa",nb:2,il:0,c1:5,c2:0},{mn:"DCP",am:"aa",nb:2,il:1,c1:5,c2:0},{mn:"INY",am:"",nb:1,il:0,c1:2,c2:0},{mn:"CMP",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"DEX",am:"",nb:1,il:0,c1:2,c2:0},{mn:"SBX",am:"#aa",nb:2,il:1,c1:2,c2:0},{mn:"CPY",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"CMP",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"DEC",am:"AAAA",nb:3,il:0,c1:3,c2:0},{mn:"DCP",am:"AAAA",nb:3,il:1,c1:6,c2:0},{mn:"BNE",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"CMP",am:"(aa),y",nb:2,il:0,c1:5,c2:1},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"DCP",am:"(aa),y",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa,x",nb:2,il:1,c1:4,c2:0},{mn:"CMP",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"DEC",am:"aa,x",nb:2,il:0,c1:6,c2:0},{mn:"DCP",am:"aa,x",nb:2,il:1,c1:6,c2:1},{mn:"CLD",am:"",nb:1,il:0,c1:2,c2:0},{mn:"CMP",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"NOP",am:"",nb:1,il:1,c1:0,c2:0},{mn:"DCP",am:"AAAA,y",nb:3,il:1,c1:7,c2:1},{mn:"NOP",am:"AAAA,x",nb:3,il:1,c1:4,c2:1},{mn:"CMP",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"DEC",am:"AAAA,x",nb:3,il:0,c1:7,c2:0},{mn:"DCP",am:"AAAA,x",nb:3,il:1,c1:7,c2:1},{mn:"CPX",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"SBC",am:"(aa,x)",nb:2,il:0,c1:6,c2:0},{mn:"NOP",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"ISB",am:"(aa,x)",nb:2,il:1,c1:8,c2:1},{mn:"CPX",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"SBC",am:"aa",nb:2,il:0,c1:3,c2:0},{mn:"INC",am:"aa",nb:2,il:0,c1:5,c2:0},{mn:"ISB",am:"aa",nb:2,il:1,c1:5,c2:0},{mn:"INX",am:"",nb:1,il:0,c1:2,c2:0},{mn:"SBC",am:"#aa",nb:2,il:0,c1:2,c2:0},{mn:"NOP",am:"",nb:1,il:0,c1:2,c2:0},{mn:"SBC",am:"#aa",nb:2,il:1,c1:0,c2:0},{mn:"CPX",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"SBC",am:"AAAA",nb:3,il:0,c1:4,c2:0},{mn:"INC",am:"AAAA",nb:3,il:0,c1:6,c2:0},{mn:"ISB",am:"AAAA",nb:3,il:1,c1:6,c2:0},{mn:"BEQ",am:"branch",nb:2,il:0,c1:2,c2:2},{mn:"SBC",am:"(aa),y",nb:2,il:0,c1:5,c2:1},{mn:"KIL",am:"",nb:1,il:1,c1:0,c2:0},{mn:"ISB",am:"(aa),y",nb:2,il:1,c1:8,c2:1},{mn:"NOP",am:"aa,x",nb:2,il:1,c1:4,c2:0},{mn:"SBC",am:"aa,x",nb:2,il:0,c1:4,c2:0},{mn:"INC",am:"aa,x",nb:2,il:0,c1:6,c2:0},{mn:"ISB",am:"aa,x",nb:2,il:1,c1:6,c2:1},{mn:"SED",am:"",nb:1,il:0,c1:2,c2:0},{mn:"SBC",am:"AAAA,y",nb:3,il:0,c1:4,c2:1},{mn:"NOP",am:"",nb:1,il:1,c1:0,c2:0},{mn:"ISB",am:"AAAA,y",nb:3,il:1,c1:7,c2:1},{mn:"NOP",am:"AAAA,x",nb:3,il:1,c1:4,c2:1},{mn:"SBC",am:"AAAA,x",nb:3,il:0,c1:4,c2:1},{mn:"INC",am:"AAAA,x",nb:3,il:0,c1:7,c2:0},{mn:"ISB",am:"AAAA,x",nb:3,il:1,c1:7,c2:1}];function at(h,e,r,f){var l=xn[e];if(l==null)return{line:"???",nbytes:1,isaddr:!1};var x=l.mn,d=l.am,u=!1;if(d=="branch"){var a=r<128?h+2+r:h+2-(256-r);a&=65535,d="$"+ae(a,4),u=!0}else d=d.replace("aa","$"+ae(r,2)),d=d.replace("AAAA","$"+ae(r+(f<<8),4)),d.indexOf("#")<0&&d.indexOf("$")>=0&&(u=!0);return{line:l.mn+" "+d,nbytes:l.nb,isaddr:u}}function un(h){let e=h;if(!e||typeof e.mem_read!="function"||typeof e.mem_write!="function"||typeof e.io_read!="function"||typeof e.io_write!="function")throw"Z80: Core object is missing required functions.";let r=0,f=0,l=0,x=0,d=0,u=0,a=0,V=0,L=0,p=0,I=0,k=0,G=0,oe=0,A=0,R=0,E=0,U=0,z=57328,i=0,c={S:0,Z:0,Y:0,H:0,X:0,P:0,N:0,C:0},ge={S:0,Z:0,Y:0,H:0,X:0,P:0,N:0,C:0},Fe=0,W=0,Be=0,_=!1,C=!1,Ze=!1,te=0;function q(){return{PC:i,SP:z,IX:A,IY:R,AF:(r<<8)+Xe(),BC:(f<<8)+l,DE:(x<<8)+d,HL:(u<<8)+a,AF_:(V<<8)+Ve(),BC_:(L<<8)+p,DE_:(I<<8)+k,HL_:(G<<8)+oe,IR:(E<<8)+U,im:Fe,iff1:W,iff2:Be,halted:_,do_delayed_di:C,do_delayed_ei:Ze,cycle_counter:te}}function We(t){i=t.PC,z=t.SP,A=t.IX,R=t.IY,r=t.AF>>8&255,Ue(t.AF),f=t.BC>>8&255,l=t.BC&255,x=t.DE>>8&255,d=t.DE&255,u=t.HL>>8&255,a=t.HL&255,V=t.AF_>>8&255,De(t.AF_),L=t.BC_>>8&255,p=t.BC_&255,I=t.DE_>>8&255,k=t.DE_&255,G=t.HL_>>8&255,oe=t.HL_&255,E=t.IR>>8&255,U=t.IR&255,Fe=t.im,W=t.iff1,Be=t.iff2,_=t.halted,C=t.do_delayed_di,Ze=t.do_delayed_ei,te=t.cycle_counter}let K=function(){z=57328,i=0,r=0,U=0,Ue(0),Fe=0,W=0,Be=0,_=!1,C=!1,Ze=!1,te=0},H=function(){if(_)return 1;var t=!1,b=!1;C?(C=!1,t=!0):Ze&&(Ze=!1,b=!0),U=U&128|(U&127)+1&127;var P=e.mem_read(i);ue(P),i=i+1&65535,t?(W=0,Be=0):b&&(W=1,Be=1);var Le=te;return te=0,Le},Ae=function(t,b){if(t)return U=U&128|(U&127)+1&127,_=!1,Be=W,W=0,we(i),i=102,te+=11,!0;if(W){if(U=U&128|(U&127)+1&127,_=!1,W=0,Be=0,Fe===0)i=i-1&65535,ue(b),i=i+1&65535,te+=2;else if(Fe===1)we(i),i=56,te+=13;else if(Fe===2){we(i);var P=E<<8|b;i=e.mem_read(P)|e.mem_read(P+1&65535)<<8,te+=19}return!0}},ue=function(t){var b=function(Oe){return(Oe&7)==0?f:(Oe&7)==1?l:(Oe&7)==2?x:(Oe&7)==3?d:(Oe&7)==4?u:(Oe&7)==5?a:(Oe&7)==6?e.mem_read(a|u<<8):r};if(t===118)_=!0;else if(t>=64&&t<128){var P=b(t);(t&56)>>>3==0?f=P:(t&56)>>>3==1?l=P:(t&56)>>>3==2?x=P:(t&56)>>>3==3?d=P:(t&56)>>>3==4?u=P:(t&56)>>>3==5?a=P:(t&56)>>>3==6?e.mem_write(a|u<<8,P):(t&56)>>>3==7&&(r=P)}else if(t>=128&&t<192){var P=b(t),Le=[ce,ie,M,D,fe,ne,T,F];Le[(t&56)>>>3](P)}else{var Je=S[t];Je()}te+=o[t]},O=function(t){return t&=255,t&128&&(t=-((255&~t)+1)),t},Xe=function(){return c.S<<7|c.Z<<6|c.Y<<5|c.H<<4|c.X<<3|c.P<<2|c.N<<1|c.C},Ve=function(){return ge.S<<7|ge.Z<<6|ge.Y<<5|ge.H<<4|ge.X<<3|ge.P<<2|ge.N<<1|ge.C},Ue=function(t){c.S=(t&128)>>>7,c.Z=(t&64)>>>6,c.Y=(t&32)>>>5,c.H=(t&16)>>>4,c.X=(t&8)>>>3,c.P=(t&4)>>>2,c.N=(t&2)>>>1,c.C=t&1},De=function(t){ge.S=(t&128)>>>7,ge.Z=(t&64)>>>6,ge.Y=(t&32)>>>5,ge.H=(t&16)>>>4,ge.X=(t&8)>>>3,ge.P=(t&4)>>>2,ge.N=(t&2)>>>1,ge.C=t&1},Q=function(t){c.Y=(t&32)>>>5,c.X=(t&8)>>>3},me=function(t){var b=[1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1];return b[t]},we=function(t){z=z-1&65535,e.mem_write(z,(t&65280)>>>8),z=z-1&65535,e.mem_write(z,t&255)},be=function(){var t=e.mem_read(z)&255;return z=z+1&65535,t|=e.mem_read(z)<<8,z=z+1&65535,t},ye=function(t){t?(i=e.mem_read(i+1&65535)|e.mem_read(i+2&65535)<<8,i=i-1&65535):i=i+2&65535},ze=function(t){if(t){te+=5;var b=O(e.mem_read(i+1&65535));i=i+b+1&65535}else i=i+1&65535},Ne=function(t){t?(te+=7,we(i+3&65535),i=e.mem_read(i+1&65535)|e.mem_read(i+2&65535)<<8,i=i-1&65535):i=i+2&65535},He=function(t){t&&(te+=6,i=be()-1&65535)},pe=function(t){we(i+1&65535),i=t-1&65535},ce=function(t){var b=r+t;c.S=b&128?1:0,c.Z=b&255?0:1,c.H=(t&15)+(r&15)&16?1:0,c.P=(r&128)==(t&128)&&(r&128)!=(b&128)?1:0,c.N=0,c.C=b&256?1:0,r=b&255,Q(r)},ie=function(t){var b=r+t+c.C;c.S=b&128?1:0,c.Z=b&255?0:1,c.H=(t&15)+(r&15)+c.C&16?1:0,c.P=(r&128)==(t&128)&&(r&128)!=(b&128)?1:0,c.N=0,c.C=b&256?1:0,r=b&255,Q(r)},M=function(t){var b=r-t;c.S=b&128?1:0,c.Z=b&255?0:1,c.H=(r&15)-(t&15)&16?1:0,c.P=(r&128)!=(t&128)&&(r&128)!=(b&128)?1:0,c.N=1,c.C=b&256?1:0,r=b&255,Q(r)},D=function(t){var b=r-t-c.C;c.S=b&128?1:0,c.Z=b&255?0:1,c.H=(r&15)-(t&15)-c.C&16?1:0,c.P=(r&128)!=(t&128)&&(r&128)!=(b&128)?1:0,c.N=1,c.C=b&256?1:0,r=b&255,Q(r)},F=function(t){var b=r;M(t),r=b,Q(t)},fe=function(t){r&=t&255,c.S=r&128?1:0,c.Z=r?0:1,c.H=1,c.P=me(r),c.N=0,c.C=0,Q(r)},T=function(t){r=(t|r)&255,c.S=r&128?1:0,c.Z=r?0:1,c.H=0,c.P=me(r),c.N=0,c.C=0,Q(r)},ne=function(t){r=(t^r)&255,c.S=r&128?1:0,c.Z=r?0:1,c.H=0,c.P=me(r),c.N=0,c.C=0,Q(r)},w=function(t){var b=t+1;return c.S=b&128?1:0,c.Z=b&255?0:1,c.H=(t&15)==15?1:0,c.P=t===127?1:0,c.N=0,b&=255,Q(b),b},N=function(t){var b=t-1;return c.S=b&128?1:0,c.Z=b&255?0:1,c.H=(t&15)==0?1:0,c.P=t===128?1:0,c.N=1,b&=255,Q(b),b},_e=function(t){var b=a|u<<8,P=b+t;c.N=0,c.C=P&65536?1:0,c.H=(b&4095)+(t&4095)&4096?1:0,a=P&255,u=(P&65280)>>>8,Q(u)},Y=function(t){t+=c.C;var b=a|u<<8,P=b+t;c.S=P&32768?1:0,c.Z=P&65535?0:1,c.H=(b&4095)+(t&4095)&4096?1:0,c.P=(b&32768)==(t&32768)&&(P&32768)!=(b&32768)?1:0,c.N=0,c.C=P&65536?1:0,a=P&255,u=P>>>8&255,Q(u)},re=function(t){t+=c.C;var b=a|u<<8,P=b-t;c.S=P&32768?1:0,c.Z=P&65535?0:1,c.H=(b&4095)-(t&4095)&4096?1:0,c.P=(b&32768)!=(t&32768)&&(P&32768)!=(b&32768)?1:0,c.N=1,c.C=P&65536?1:0,a=P&255,u=P>>>8&255,Q(u)},ve=function(t){var b=e.io_read(t);return c.S=b&128?1:0,c.Z=b?0:1,c.H=0,c.P=me(b)?1:0,c.N=0,Q(b),b},$=function(){r!==128&&(r=O(r),r=-r&255),c.S=r&128?1:0,c.Z=r?0:1,c.H=(-r&15)>0?1:0,c.P=r===128?1:0,c.N=1,c.C=r?1:0,Q(r)},le=function(){var t=e.mem_read(a|u<<8);e.mem_write(d|x<<8,t);var b=(d|x<<8)+1;d=b&255,x=(b&65280)>>>8,b=(a|u<<8)+1,a=b&255,u=(b&65280)>>>8,b=(l|f<<8)-1,l=b&255,f=(b&65280)>>>8,c.H=0,c.P=l||f?1:0,c.N=0,c.Y=(r+t&2)>>>1,c.X=(r+t&8)>>>3},Ie=function(){var t=c.C,b=e.mem_read(a|u<<8);F(b),c.C=t,c.Y=(r-b-c.H&2)>>>1,c.X=(r-b-c.H&8)>>>3;var P=(a|u<<8)+1;a=P&255,u=(P&65280)>>>8,P=(l|f<<8)-1,l=P&255,f=(P&65280)>>>8,c.P=P?1:0},Z=function(){f=N(f),e.mem_write(a|u<<8,e.io_read(f<<8|l));var t=(a|u<<8)+1;a=t&255,u=(t&65280)>>>8,c.N=1},ee=function(){e.io_write(f<<8|l,e.mem_read(a|u<<8));var t=(a|u<<8)+1;a=t&255,u=(t&65280)>>>8,f=N(f),c.N=1},se=function(){c.N=0,c.H=0;var t=e.mem_read(a|u<<8);e.mem_write(d|x<<8,t);var b=(d|x<<8)-1;d=b&255,x=(b&65280)>>>8,b=(a|u<<8)-1,a=b&255,u=(b&65280)>>>8,b=(l|f<<8)-1,l=b&255,f=(b&65280)>>>8,c.P=l||f?1:0,c.Y=(r+t&2)>>>1,c.X=(r+t&8)>>>3},Pe=function(){var t=c.C,b=e.mem_read(a|u<<8);F(b),c.C=t,c.Y=(r-b-c.H&2)>>>1,c.X=(r-b-c.H&8)>>>3;var P=(a|u<<8)-1;a=P&255,u=(P&65280)>>>8,P=(l|f<<8)-1,l=P&255,f=(P&65280)>>>8,c.P=P?1:0},Re=function(){f=N(f),e.mem_write(a|u<<8,e.io_read(f<<8|l));var t=(a|u<<8)-1;a=t&255,u=(t&65280)>>>8,c.N=1},Ye=function(){e.io_write(f<<8|l,e.mem_read(a|u<<8));var t=(a|u<<8)-1;a=t&255,u=(t&65280)>>>8,f=N(f),c.N=1},xe=function(t){return c.N=0,c.H=0,c.C=(t&128)>>>7,t=(t<<1|c.C)&255,c.Z=t?0:1,c.P=me(t),c.S=t&128?1:0,Q(t),t},de=function(t){return c.N=0,c.H=0,c.C=t&1,t=t>>>1&127|c.C<<7,c.Z=t&255?0:1,c.P=me(t),c.S=t&128?1:0,Q(t),t&255},Me=function(t){c.N=0,c.H=0;var b=c.C;return c.C=(t&128)>>>7,t=(t<<1|b)&255,c.Z=t?0:1,c.P=me(t),c.S=t&128?1:0,Q(t),t},ke=function(t){c.N=0,c.H=0;var b=c.C;return c.C=t&1,t=t>>>1&127|b<<7,c.Z=t?0:1,c.P=me(t),c.S=t&128?1:0,Q(t),t},Ke=function(t){return c.N=0,c.H=0,c.C=(t&128)>>>7,t=t<<1&255,c.Z=t?0:1,c.P=me(t),c.S=t&128?1:0,Q(t),t},X=function(t){return c.N=0,c.H=0,c.C=t&1,t=t>>>1&127|t&128,c.Z=t?0:1,c.P=me(t),c.S=t&128?1:0,Q(t),t},je=function(t){return c.N=0,c.H=0,c.C=(t&128)>>>7,t=t<<1&255|1,c.Z=t?0:1,c.P=me(t),c.S=t&128?1:0,Q(t),t},Qe=function(t){return c.N=0,c.H=0,c.C=t&1,t=t>>>1&127,c.Z=t?0:1,c.P=me(t),c.S=0,Q(t),t},t0=function(t){c.N=0;var b=A+t;c.C=b&65536?1:0,c.H=(A&4095)+(t&4095)&4096?1:0,Q((b&65280)>>>8),A=b&65535},S=[];S[0]=function(){},S[1]=function(){i=i+1&65535,l=e.mem_read(i),i=i+1&65535,f=e.mem_read(i)},S[2]=function(){e.mem_write(l|f<<8,r)},S[3]=function(){var t=l|f<<8;t+=1,l=t&255,f=(t&65280)>>>8},S[4]=function(){f=w(f)},S[5]=function(){f=N(f)},S[6]=function(){i=i+1&65535,f=e.mem_read(i)},S[7]=function(){var t=c.S,b=c.Z,P=c.P;r=xe(r),c.S=t,c.Z=b,c.P=P},S[8]=function(){var t=r;r=V,V=t,t=Xe(),Ue(Ve()),De(t)},S[9]=function(){_e(l|f<<8)},S[10]=function(){r=e.mem_read(l|f<<8)},S[11]=function(){var t=l|f<<8;t-=1,l=t&255,f=(t&65280)>>>8},S[12]=function(){l=w(l)},S[13]=function(){l=N(l)},S[14]=function(){i=i+1&65535,l=e.mem_read(i)},S[15]=function(){var t=c.S,b=c.Z,P=c.P;r=de(r),c.S=t,c.Z=b,c.P=P},S[16]=function(){f=f-1&255,ze(f!==0)},S[17]=function(){i=i+1&65535,d=e.mem_read(i),i=i+1&65535,x=e.mem_read(i)},S[18]=function(){e.mem_write(d|x<<8,r)},S[19]=function(){var t=d|x<<8;t+=1,d=t&255,x=(t&65280)>>>8},S[20]=function(){x=w(x)},S[21]=function(){x=N(x)},S[22]=function(){i=i+1&65535,x=e.mem_read(i)},S[23]=function(){var t=c.S,b=c.Z,P=c.P;r=Me(r),c.S=t,c.Z=b,c.P=P},S[24]=function(){var t=O(e.mem_read(i+1&65535));i=i+t+1&65535},S[25]=function(){_e(d|x<<8)},S[26]=function(){r=e.mem_read(d|x<<8)},S[27]=function(){var t=d|x<<8;t-=1,d=t&255,x=(t&65280)>>>8},S[28]=function(){d=w(d)},S[29]=function(){d=N(d)},S[30]=function(){i=i+1&65535,d=e.mem_read(i)},S[31]=function(){var t=c.S,b=c.Z,P=c.P;r=ke(r),c.S=t,c.Z=b,c.P=P},S[32]=function(){ze(!c.Z)},S[33]=function(){i=i+1&65535,a=e.mem_read(i),i=i+1&65535,u=e.mem_read(i)},S[34]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,e.mem_write(t,a),e.mem_write(t+1&65535,u)},S[35]=function(){var t=a|u<<8;t+=1,a=t&255,u=(t&65280)>>>8},S[36]=function(){u=w(u)},S[37]=function(){u=N(u)},S[38]=function(){i=i+1&65535,u=e.mem_read(i)},S[39]=function(){var t=r;c.N?((c.H||(r&15)>9)&&(t-=6),(c.C||r>153)&&(t-=96)):((c.H||(r&15)>9)&&(t+=6),(c.C||r>153)&&(t+=96)),c.S=t&128?1:0,c.Z=t&255?0:1,c.H=r&16^t&16?1:0,c.P=me(t&255),c.C=c.C||r>153?1:0,r=t&255,Q(r)},S[40]=function(){ze(!!c.Z)},S[41]=function(){_e(a|u<<8)},S[42]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,a=e.mem_read(t),u=e.mem_read(t+1&65535)},S[43]=function(){var t=a|u<<8;t-=1,a=t&255,u=(t&65280)>>>8},S[44]=function(){a=w(a)},S[45]=function(){a=N(a)},S[46]=function(){i=i+1&65535,a=e.mem_read(i)},S[47]=function(){r=~r&255,c.N=1,c.H=1,Q(r)},S[48]=function(){ze(!c.C)},S[49]=function(){z=e.mem_read(i+1&65535)|e.mem_read(i+2&65535)<<8,i=i+2&65535},S[50]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,e.mem_write(t,r)},S[51]=function(){z=z+1&65535},S[52]=function(){var t=a|u<<8;e.mem_write(t,w(e.mem_read(t)))},S[53]=function(){var t=a|u<<8;e.mem_write(t,N(e.mem_read(t)))},S[54]=function(){i=i+1&65535,e.mem_write(a|u<<8,e.mem_read(i))},S[55]=function(){c.N=0,c.H=0,c.C=1,Q(r)},S[56]=function(){ze(!!c.C)},S[57]=function(){_e(z)},S[58]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,r=e.mem_read(t)},S[59]=function(){z=z-1&65535},S[60]=function(){r=w(r)},S[61]=function(){r=N(r)},S[62]=function(){r=e.mem_read(i+1&65535),i=i+1&65535},S[63]=function(){c.N=0,c.H=c.C,c.C=c.C?0:1,Q(r)},S[192]=function(){He(!c.Z)},S[193]=function(){var t=be();l=t&255,f=(t&65280)>>>8},S[194]=function(){ye(!c.Z)},S[195]=function(){i=e.mem_read(i+1&65535)|e.mem_read(i+2&65535)<<8,i=i-1&65535},S[196]=function(){Ne(!c.Z)},S[197]=function(){we(l|f<<8)},S[198]=function(){i=i+1&65535,ce(e.mem_read(i))},S[199]=function(){pe(0)},S[200]=function(){He(!!c.Z)},S[201]=function(){i=be()-1&65535},S[202]=function(){ye(!!c.Z)},S[203]=function(){U=U&128|(U&127)+1&127,i=i+1&65535;var t=e.mem_read(i),b=(t&56)>>>3,P=t&7;if(t<64){var Le=[xe,de,Me,ke,Ke,X,je,Qe];P===0?f=Le[b](f):P===1?l=Le[b](l):P===2?x=Le[b](x):P===3?d=Le[b](d):P===4?u=Le[b](u):P===5?a=Le[b](a):P===6?e.mem_write(a|u<<8,Le[b](e.mem_read(a|u<<8))):P===7&&(r=Le[b](r))}else t<128?(P===0?c.Z=f&1<<b?0:1:P===1?c.Z=l&1<<b?0:1:P===2?c.Z=x&1<<b?0:1:P===3?c.Z=d&1<<b?0:1:P===4?c.Z=u&1<<b?0:1:P===5?c.Z=a&1<<b?0:1:P===6?c.Z=e.mem_read(a|u<<8)&1<<b?0:1:P===7&&(c.Z=r&1<<b?0:1),c.N=0,c.H=1,c.P=c.Z,c.S=b===7&&!c.Z?1:0,c.Y=b===5&&!c.Z?1:0,c.X=b===3&&!c.Z?1:0):t<192?P===0?f&=255&~(1<<b):P===1?l&=255&~(1<<b):P===2?x&=255&~(1<<b):P===3?d&=255&~(1<<b):P===4?u&=255&~(1<<b):P===5?a&=255&~(1<<b):P===6?e.mem_write(a|u<<8,e.mem_read(a|u<<8)&~(1<<b)):P===7&&(r&=255&~(1<<b)):P===0?f|=1<<b:P===1?l|=1<<b:P===2?x|=1<<b:P===3?d|=1<<b:P===4?u|=1<<b:P===5?a|=1<<b:P===6?e.mem_write(a|u<<8,e.mem_read(a|u<<8)|1<<b):P===7&&(r|=1<<b);te+=g[t]},S[204]=function(){Ne(!!c.Z)},S[205]=function(){we(i+3&65535),i=e.mem_read(i+1&65535)|e.mem_read(i+2&65535)<<8,i=i-1&65535},S[206]=function(){i=i+1&65535,ie(e.mem_read(i))},S[207]=function(){pe(8)},S[208]=function(){He(!c.C)},S[209]=function(){var t=be();d=t&255,x=(t&65280)>>>8},S[210]=function(){ye(!c.C)},S[211]=function(){i=i+1&65535,e.io_write(r<<8|e.mem_read(i),r)},S[212]=function(){Ne(!c.C)},S[213]=function(){we(d|x<<8)},S[214]=function(){i=i+1&65535,M(e.mem_read(i))},S[215]=function(){pe(16)},S[216]=function(){He(!!c.C)},S[217]=function(){var t=f;f=L,L=t,t=l,l=p,p=t,t=x,x=I,I=t,t=d,d=k,k=t,t=u,u=G,G=t,t=a,a=oe,oe=t},S[218]=function(){ye(!!c.C)},S[219]=function(){i=i+1&65535,r=e.io_read(r<<8|e.mem_read(i))},S[220]=function(){Ne(!!c.C)},S[221]=function(){U=U&128|(U&127)+1&127,i=i+1&65535;var t=e.mem_read(i),b=B[t];b?(b(),te+=s[t]):(i=i-1&65535,te+=o[0])},S[222]=function(){i=i+1&65535,D(e.mem_read(i))},S[223]=function(){pe(24)},S[224]=function(){He(!c.P)},S[225]=function(){var t=be();a=t&255,u=(t&65280)>>>8},S[226]=function(){ye(!c.P)},S[227]=function(){var t=e.mem_read(z);e.mem_write(z,a),a=t,t=e.mem_read(z+1&65535),e.mem_write(z+1&65535,u),u=t},S[228]=function(){Ne(!c.P)},S[229]=function(){we(a|u<<8)},S[230]=function(){i=i+1&65535,fe(e.mem_read(i))},S[231]=function(){pe(32)},S[232]=function(){He(!!c.P)},S[233]=function(){i=a|u<<8,i=i-1&65535},S[234]=function(){ye(!!c.P)},S[235]=function(){var t=x;x=u,u=t,t=d,d=a,a=t},S[236]=function(){Ne(!!c.P)},S[237]=function(){U=U&128|(U&127)+1&127,i=i+1&65535;var t=e.mem_read(i),b=y[t];b?(b(),te+=n[t]):te+=o[0]},S[238]=function(){i=i+1&65535,ne(e.mem_read(i))},S[239]=function(){pe(40)},S[240]=function(){He(!c.S)},S[241]=function(){var t=be();Ue(t&255),r=(t&65280)>>>8},S[242]=function(){ye(!c.S)},S[243]=function(){C=!0},S[244]=function(){Ne(!c.S)},S[245]=function(){we(Xe()|r<<8)},S[246]=function(){i=i+1&65535,T(e.mem_read(i))},S[247]=function(){pe(48)},S[248]=function(){He(!!c.S)},S[249]=function(){z=a|u<<8},S[250]=function(){ye(!!c.S)},S[251]=function(){Ze=!0},S[252]=function(){Ne(!!c.S)},S[253]=function(){U=U&128|(U&127)+1&127,i=i+1&65535;var t=e.mem_read(i),b=B[t];if(b){var P=A;A=R,b(),R=A,A=P,te+=s[t]}else i=i-1&65535,te+=o[0]},S[254]=function(){i=i+1&65535,F(e.mem_read(i))},S[255]=function(){pe(56)};let y=[];y[64]=function(){f=ve(f<<8|l)},y[65]=function(){e.io_write(f<<8|l,f)},y[66]=function(){re(l|f<<8)},y[67]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,e.mem_write(t,l),e.mem_write(t+1&65535,f)},y[68]=function(){$()},y[69]=function(){i=be()-1&65535,W=Be},y[70]=function(){Fe=0},y[71]=function(){E=r},y[72]=function(){l=ve(f<<8|l)},y[73]=function(){e.io_write(f<<8|l,l)},y[74]=function(){Y(l|f<<8)},y[75]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,l=e.mem_read(t),f=e.mem_read(t+1&65535)},y[76]=function(){$()},y[77]=function(){i=be()-1&65535},y[78]=function(){Fe=0},y[79]=function(){U=r},y[80]=function(){x=ve(f<<8|l)},y[81]=function(){e.io_write(f<<8|l,x)},y[82]=function(){re(d|x<<8)},y[83]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,e.mem_write(t,d),e.mem_write(t+1&65535,x)},y[84]=function(){$()},y[85]=function(){i=be()-1&65535,W=Be},y[86]=function(){Fe=1},y[87]=function(){r=E,c.S=r&128?1:0,c.Z=r?0:1,c.H=0,c.P=Be,c.N=0,Q(r)},y[88]=function(){d=ve(f<<8|l)},y[89]=function(){e.io_write(f<<8|l,d)},y[90]=function(){Y(d|x<<8)},y[91]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,d=e.mem_read(t),x=e.mem_read(t+1&65535)},y[92]=function(){$()},y[93]=function(){i=be()-1&65535,W=Be},y[94]=function(){Fe=2},y[95]=function(){r=U,c.S=r&128?1:0,c.Z=r?0:1,c.H=0,c.P=Be,c.N=0,Q(r)},y[96]=function(){u=ve(f<<8|l)},y[97]=function(){e.io_write(f<<8|l,u)},y[98]=function(){re(a|u<<8)},y[99]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,e.mem_write(t,a),e.mem_write(t+1&65535,u)},y[100]=function(){$()},y[101]=function(){i=be()-1&65535,W=Be},y[102]=function(){Fe=0},y[103]=function(){var t=e.mem_read(a|u<<8),b=t&15,P=r&15;t=(t&240)>>>4|P<<4,r=r&240|b,e.mem_write(a|u<<8,t),c.S=r&128?1:0,c.Z=r?0:1,c.H=0,c.P=me(r)?1:0,c.N=0,Q(r)},y[104]=function(){a=ve(f<<8|l)},y[105]=function(){e.io_write(f<<8|l,a)},y[106]=function(){Y(a|u<<8)},y[107]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,a=e.mem_read(t),u=e.mem_read(t+1&65535)},y[108]=function(){$()},y[109]=function(){i=be()-1&65535,W=Be},y[110]=function(){Fe=0},y[111]=function(){var t=e.mem_read(a|u<<8),b=t&240,P=r&15;t=(t&15)<<4|P,r=r&240|b>>>4,e.mem_write(a|u<<8,t),c.S=r&128?1:0,c.Z=r?0:1,c.H=0,c.P=me(r)?1:0,c.N=0,Q(r)},y[112]=function(){ve(f<<8|l)},y[113]=function(){e.io_write(f<<8|l,0)},y[114]=function(){re(z)},y[115]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,e.mem_write(t,z&255),e.mem_write(t+1&65535,z>>>8&255)},y[116]=function(){$()},y[117]=function(){i=be()-1&65535,W=Be},y[118]=function(){Fe=1},y[120]=function(){r=ve(f<<8|l)},y[121]=function(){e.io_write(f<<8|l,r)},y[122]=function(){Y(z)},y[123]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,z=e.mem_read(t),z|=e.mem_read(t+1&65535)<<8},y[124]=function(){$()},y[125]=function(){i=be()-1&65535,W=Be},y[126]=function(){Fe=2},y[160]=function(){le()},y[161]=function(){Ie()},y[162]=function(){Z()},y[163]=function(){ee()},y[168]=function(){se()},y[169]=function(){Pe()},y[170]=function(){Re()},y[171]=function(){Ye()},y[176]=function(){le(),(f||l)&&(te+=5,i=i-2&65535)},y[177]=function(){Ie(),!c.Z&&(f||l)&&(te+=5,i=i-2&65535)},y[178]=function(){Z(),f&&(te+=5,i=i-2&65535)},y[179]=function(){ee(),f&&(te+=5,i=i-2&65535)},y[184]=function(){se(),(f||l)&&(te+=5,i=i-2&65535)},y[185]=function(){Pe(),!c.Z&&(f||l)&&(te+=5,i=i-2&65535)},y[186]=function(){Re(),f&&(te+=5,i=i-2&65535)},y[187]=function(){Ye(),f&&(te+=5,i=i-2&65535)};let B=[];B[9]=function(){t0(l|f<<8)},B[25]=function(){t0(d|x<<8)},B[33]=function(){i=i+1&65535,A=e.mem_read(i),i=i+1&65535,A|=e.mem_read(i)<<8},B[34]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,e.mem_write(t,A&255),e.mem_write(t+1&65535,A>>>8&255)},B[35]=function(){A=A+1&65535},B[36]=function(){A=w(A>>>8)<<8|A&255},B[37]=function(){A=N(A>>>8)<<8|A&255},B[38]=function(){i=i+1&65535,A=e.mem_read(i)<<8|A&255},B[41]=function(){t0(A)},B[42]=function(){i=i+1&65535;var t=e.mem_read(i);i=i+1&65535,t|=e.mem_read(i)<<8,A=e.mem_read(t),A|=e.mem_read(t+1&65535)<<8},B[43]=function(){A=A-1&65535},B[44]=function(){A=w(A&255)|A&65280},B[45]=function(){A=N(A&255)|A&65280},B[46]=function(){i=i+1&65535,A=e.mem_read(i)&255|A&65280},B[52]=function(){i=i+1&65535;var t=O(e.mem_read(i)),b=e.mem_read(t+A&65535);e.mem_write(t+A&65535,w(b))},B[53]=function(){i=i+1&65535;var t=O(e.mem_read(i)),b=e.mem_read(t+A&65535);e.mem_write(t+A&65535,N(b))},B[54]=function(){i=i+1&65535;var t=O(e.mem_read(i));i=i+1&65535,e.mem_write(A+t&65535,e.mem_read(i))},B[57]=function(){t0(z)},B[68]=function(){f=A>>>8&255},B[69]=function(){f=A&255},B[70]=function(){i=i+1&65535;var t=O(e.mem_read(i));f=e.mem_read(A+t&65535)},B[76]=function(){l=A>>>8&255},B[77]=function(){l=A&255},B[78]=function(){i=i+1&65535;var t=O(e.mem_read(i));l=e.mem_read(A+t&65535)},B[84]=function(){x=A>>>8&255},B[85]=function(){x=A&255},B[86]=function(){i=i+1&65535;var t=O(e.mem_read(i));x=e.mem_read(A+t&65535)},B[92]=function(){d=A>>>8&255},B[93]=function(){d=A&255},B[94]=function(){i=i+1&65535;var t=O(e.mem_read(i));d=e.mem_read(A+t&65535)},B[96]=function(){A=A&255|f<<8},B[97]=function(){A=A&255|l<<8},B[98]=function(){A=A&255|x<<8},B[99]=function(){A=A&255|d<<8},B[100]=function(){},B[101]=function(){A=A&255|(A&255)<<8},B[102]=function(){i=i+1&65535;var t=O(e.mem_read(i));u=e.mem_read(A+t&65535)},B[103]=function(){A=A&255|r<<8},B[104]=function(){A=A&65280|f},B[105]=function(){A=A&65280|l},B[106]=function(){A=A&65280|x},B[107]=function(){A=A&65280|d},B[108]=function(){A=A&65280|A>>>8},B[109]=function(){},B[110]=function(){i=i+1&65535;var t=O(e.mem_read(i));a=e.mem_read(A+t&65535)},B[111]=function(){A=A&65280|r},B[112]=function(){i=i+1&65535;var t=O(e.mem_read(i));e.mem_write(A+t&65535,f)},B[113]=function(){i=i+1&65535;var t=O(e.mem_read(i));e.mem_write(A+t&65535,l)},B[114]=function(){i=i+1&65535;var t=O(e.mem_read(i));e.mem_write(A+t&65535,x)},B[115]=function(){i=i+1&65535;var t=O(e.mem_read(i));e.mem_write(A+t&65535,d)},B[116]=function(){i=i+1&65535;var t=O(e.mem_read(i));e.mem_write(A+t&65535,u)},B[117]=function(){i=i+1&65535;var t=O(e.mem_read(i));e.mem_write(A+t&65535,a)},B[119]=function(){i=i+1&65535;var t=O(e.mem_read(i));e.mem_write(A+t&65535,r)},B[124]=function(){r=A>>>8&255},B[125]=function(){r=A&255},B[126]=function(){i=i+1&65535;var t=O(e.mem_read(i));r=e.mem_read(A+t&65535)},B[132]=function(){ce(A>>>8&255)},B[133]=function(){ce(A&255)},B[134]=function(){i=i+1&65535;var t=O(e.mem_read(i));ce(e.mem_read(A+t&65535))},B[140]=function(){ie(A>>>8&255)},B[141]=function(){ie(A&255)},B[142]=function(){i=i+1&65535;var t=O(e.mem_read(i));ie(e.mem_read(A+t&65535))},B[148]=function(){M(A>>>8&255)},B[149]=function(){M(A&255)},B[150]=function(){i=i+1&65535;var t=O(e.mem_read(i));M(e.mem_read(A+t&65535))},B[156]=function(){D(A>>>8&255)},B[157]=function(){D(A&255)},B[158]=function(){i=i+1&65535;var t=O(e.mem_read(i));D(e.mem_read(A+t&65535))},B[164]=function(){fe(A>>>8&255)},B[165]=function(){fe(A&255)},B[166]=function(){i=i+1&65535;var t=O(e.mem_read(i));fe(e.mem_read(A+t&65535))},B[172]=function(){ne(A>>>8&255)},B[173]=function(){ne(A&255)},B[174]=function(){i=i+1&65535;var t=O(e.mem_read(i));ne(e.mem_read(A+t&65535))},B[180]=function(){T(A>>>8&255)},B[181]=function(){T(A&255)},B[182]=function(){i=i+1&65535;var t=O(e.mem_read(i));T(e.mem_read(A+t&65535))},B[188]=function(){F(A>>>8&255)},B[189]=function(){F(A&255)},B[190]=function(){i=i+1&65535;var t=O(e.mem_read(i));F(e.mem_read(A+t&65535))},B[203]=function(){i=i+1&65535;var t=O(e.mem_read(i));i=i+1&65535;var b=e.mem_read(i),P;if(b<64){var Le=[xe,de,Me,ke,Ke,X,je,Qe],Je=Le[(b&56)>>>3],P=Je(e.mem_read(A+t&65535));e.mem_write(A+t&65535,P)}else{var Oe=(b&56)>>>3;b<128?(c.N=0,c.H=1,c.Z=e.mem_read(A+t&65535)&1<<Oe?0:1,c.P=c.Z,c.S=Oe===7&&!c.Z?1:0):b<192?(P=e.mem_read(A+t&65535)&~(1<<Oe)&255,e.mem_write(A+t&65535,P)):(P=e.mem_read(A+t&65535)|1<<Oe,e.mem_write(A+t&65535,P))}P!==void 0&&((b&7)==0?f=P:(b&7)==1?l=P:(b&7)==2?x=P:(b&7)==3?d=P:(b&7)==4?u=P:(b&7)==5?a=P:(b&7)==7&&(r=P)),te+=g[b]+8},B[225]=function(){A=be()},B[227]=function(){var t=A;A=e.mem_read(z),A|=e.mem_read(z+1&65535)<<8,e.mem_write(z,t&255),e.mem_write(z+1&65535,t>>>8&255)},B[229]=function(){we(A)},B[233]=function(){i=A-1&65535},B[249]=function(){z=A};let o=[4,10,7,6,4,4,7,4,4,11,7,6,4,4,7,4,8,10,7,6,4,4,7,4,12,11,7,6,4,4,7,4,7,10,16,6,4,4,7,4,7,11,16,6,4,4,7,4,7,10,13,6,11,11,10,4,7,11,13,6,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,7,7,7,7,7,7,4,7,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,4,4,4,4,4,4,7,4,5,10,10,10,10,11,7,11,5,10,10,0,10,17,7,11,5,10,10,11,10,11,7,11,5,4,10,11,10,0,7,11,5,10,10,19,10,11,7,11,5,4,10,4,10,0,7,11,5,10,10,4,10,11,7,11,5,6,10,4,10,0,7,11],n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,12,12,15,20,8,14,8,9,12,12,15,20,8,14,8,9,12,12,15,20,8,14,8,9,12,12,15,20,8,14,8,9,12,12,15,20,8,14,8,18,12,12,15,20,8,14,8,18,12,12,15,20,8,14,8,0,12,12,15,20,8,14,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16,16,16,16,0,0,0,0,16,16,16,16,0,0,0,0,16,16,16,16,0,0,0,0,16,16,16,16,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=[8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,12,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8,8,8,8,8,8,8,15,8],s=[0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,14,20,10,8,8,11,0,0,15,20,10,8,8,11,0,0,0,0,0,23,23,19,0,0,15,0,0,0,0,0,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,8,8,8,8,8,8,19,8,8,8,8,8,8,8,19,8,19,19,19,19,19,19,0,19,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,8,8,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,14,0,23,0,15,0,0,0,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,10,0,0,0,0,0,0];this.saveState=q,this.loadState=We,this.reset=K,this.advanceInsn=H,this.interrupt=Ae,this.getPC=()=>i,this.getSP=()=>z,this.getHalted=()=>_}var it=class{constructor(){this.retryInterrupts=!1;this.retryData=-1}buildCPU(){this.memBus&&this.ioBus&&(this.cpu=new un({mem_read:this.memBus.read.bind(this.memBus),mem_write:this.memBus.write.bind(this.memBus),io_read:this.ioBus.read.bind(this.ioBus),io_write:this.ioBus.write.bind(this.ioBus)}))}connectMemoryBus(e){this.memBus=e,this.buildCPU()}connectIOBus(e){this.ioBus=e,this.buildCPU()}advanceInsn(){return this.retryInterrupts&&this.retryData>=0&&this.cpu.interrupt(!1,this.retryData)&&(this.retryData=-1),this.cpu.advanceInsn()}reset(){this.cpu.reset()}interrupt(e){!this.cpu.interrupt(!1,e)&&this.retryInterrupts&&(this.retryData=e)}NMI(){this.cpu.interrupt(!0,0)}getSP(){return this.cpu.getSP()}getPC(){return this.cpu.getPC()}isHalted(){return this.cpu.getHalted()}saveState(){return this.cpu.saveState()}loadState(e){this.cpu.loadState(e)}isStable(){return!0}};var gt=class{constructor(){this.master=new MasterChannel}start(){this.looper||(this.looper=new AudioLooper(512),this.looper.setChannel(this.master),this.looper.activate())}stop(){this.looper&&(this.looper.setChannel(null),this.looper=null)}},on=class{constructor(e){this.psg=new PsgDeviceChannel;this.curreg=0;this.master=e,this.psg.setMode(PsgDeviceChannel.MODE_SIGNED),this.psg.setDevice(PsgDeviceChannel.DEVICE_AY_3_8910),e.master.addChannel(this.psg)}reset(){for(var e=15;e>=0;e--)this.selectRegister(e),this.setData(0)}selectRegister(e){this.curreg=e&15}setData(e){this.psg.writeRegisterAY(this.curreg,e&255)}readData(){return this.psg.readRegister(this.curreg)}currentRegister(){return this.curreg}},ln=class{constructor(e){this.psg=new PsgDeviceChannel;this.master=e,this.psg.setMode(PsgDeviceChannel.MODE_SIGNED),this.psg.setDevice(PsgDeviceChannel.DEVICE_SN76489),e.master.addChannel(this.psg)}reset(){}setData(e){this.psg.writeRegisterSN(0,e&255)}};function Fn(h){for(var e=new gt,r=1;r<=h;r++){var f=new mn;e["pokey"+r]=f,e.master.addChannel(f)}return e}function L0(h,e){for(var r=new Uint8Array(h.length*e.length),f=0,l=0;l<r.length;l++)r[l]=e[f%e.length],h[l%h.length]&&f++;return r}function W0(h){var e=new Uint8Array(h*2);return e.fill(1,0,h),e}var mn=function(){for(var h=128,e=64,r=32,f=16,l=15,x=128,d=64,u=32,a=16,V=8,L=4,p=2,I=1,k=28,G=114,oe=15,A=31,R=511,E=131071,U=0,z=1,i=2,c=3,ge=0,Fe=4,W=8,Be=12,_=127,C=1789790,Ze=1787520,te=new Uint8Array([1]),q=new Uint8Array([0,1]),We=new Uint8Array([1,1,0,1,1,1,0,0,0,0,1,0,1,0,0]),K=new Uint8Array([0,0,1,1,0,0,0,1,1,1,1,0,0,1,0,1,0,1,1,0,1,1,1,0,1,0,0,0,0,0,1]),H=new Uint8Array([0,0,1,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0,1,1,1,0,0,1,0,1,0,0,1,1,1,1,1,0,0,1,1,0,1,1,0,1,0,1,1,1,0,1,1,0,0,1,0,0,1,1,1,1,0,1,0,0,0,0,1,1,0,1,1,0,0,0,1,0,0,0,1,1,1,1,0,1,0,1,1,0,1,0,1,0,0,0,0,1,1,0,1,0,1,0,0,0,1,0,1,0,0,0,1,1,1,0,0,1,1,0,1,1,0,0,1,1,1,1,1,0,0,1,1,0,0,0,1,1,0,1,0,0,0,1,1,0,0,1,1,1,1,0,0,1,0,0,0,1,1,1,0,0,1,1,0,1,0,1,1,0,1,1,0,1,0,0,1,0,0,1,1,1,1,1,1,0,1,1,1,1,0,1,1,0,0,0,0,1,1,1,1,1,0,0,0,1,0,0,0,0,1,0,0,0,1,0,1,0,1,1,0,0,0,0,1,0,1,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,1,0,1,1,1,0,1,0,0,0,0,0,0,0,0,1,0,1,0,0,1,0,0,0,0,1,1,1,0,0,0,1,1,1,0,0,1,1,0,0,1,0,0,1,0,1,1,0,0,0,0,1,0,0,0,1,0,0,0,1,0,1,1,1,1,0,0,0,1,1,1,0,0,0,1,0,0,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,0,1,0,1,1,1,1,0,0,1,0,1,0,1,1,1,0,0,0,0,0,1,1,0,1,1,0,0,0,1,0,1,0,1,0,0,0,0,1,0,1,1,1,0,0,0,0,1,0,0,1,0,1,0,0,0,1,0,1,1,1,0,0,1,1,1,1,1,1,1,0,0,0,0,0,1,0,0,1,1,0,1,0,0,1,0,0,0,1,0,0,1,0,1,0,0,0,1,1,0,1,0,0,0,0,0,1,1,1,1,0,0,1,0,0,1,0,1,1,1,1,1,1,1,0,1,0,0,1,0,0,0,1,1,0,1,1,1,0,0,0,1,0,1,0,0,1,0,1,0,1,0,1,1,1,0,0,1,0,1,1,0,0,1,1,1,1,1,0,0,0,1,1,0]),Ae=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]),ue=new Uint8Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0]),O=new Uint8Array(1<<14),Xe=0;Xe<O.length;Xe++)O[Xe]=Math.random()>.5?1:0;var Ve=L0(O,K),Ue=L0(K,We),De=[Ve,K,Ue,K,O,q,We,q],Q=W0(2),me=W0(6),we=W0(31),be=W0(93),ye=L0(Ae,We),ze=L0(K,Q),Ne=L0(K,me),He=[te,We,ye,Ue,Q,Q,we,ze,H,K,we,te,me,me,be,Ne],pe=new Uint8Array(16),ce=new Float32Array(4),ie=new Float32Array(4),M=new Float32Array(4),D=new Uint8Array(4),F=[te,te,te,te],fe,T,ne,w,N=!0;this.setBufferLength=function(Y){fe=new Int32Array(Y)},this.getBuffer=function(){return fe},this.setSampleRate=function(Y){T=Y,w=C/Y/1.2};function _e(Y){var re=pe[8],ve=re&I?G:k,$,le=Y&4,Ie=le>>1,Z=le>>2;re&a>>Z?(re&d>>Z?$=pe[le+2]*256+pe[le+0]+7:$=(pe[le+2]*256+pe[le+0]+1)*ve,ie[Ie+1]=w/$,ie[Ie+0]=0):(re&d>>Z?$=pe[le+0]+4:$=(pe[le+0]+1)*ve,ie[Ie+0]=w/$,$=(pe[le+2]+1)*ve,ie[Ie+1]=w/$)}this.setRegister=function(Y,re){if(Y&=15,re&=255,pe[Y]!=re)switch(pe[Y]=re,Y){case 0:case 2:case 4:case 6:case 8:N=!0;break;case 1:case 3:case 5:case 7:M[Y>>1]=re&15,F[Y>>1]=De[re>>5];break}},this.getRegister=function(Y){return Y&=15,pe[Y]},this.setTIARegister=function(Y,re){switch(Y){case 23:case 24:pe[(Y&1)*4]=re&31,N=!0;break;case 21:case 22:F[(Y&1)*2]=He[re&15];break;case 25:case 26:M[(Y&1)*2]=re&15;break}},this.generate=function(Y){N&&(_e(0),_e(4),N=!1);for(var re=0;re<Y;re+=2){for(var ve=0,$=0;$<4;$++){var le=ie[$],Ie=M[$];if(le>0&&le<1&&Ie>0){var Z=F[$],ee=ce[$]+=le;ee>Z.length&&(ee=ce[$]=ee-Math.floor(ee/Z.length)*Z.length);var se=Z[Math.floor(ee)];se&&(ve+=Ie)}}ve*=64,fe[re]=ve,fe[re+1]=ve}}},Un=function(h){var e,r,f=[],l=0;h.onmessage=function(x){x&&x.data&&x.data.samples&&r&&(f.push(x.data.samples),l+=x.data.samples.length)},this.setBufferLength=function(x){r=new Int16Array(x),l=0},this.getBuffer=function(){return r},this.setSampleRate=function(x){e=x,h.postMessage({sampleRate:x})},this.generate=function(x){if(l<x*3){r.fill(0);return}for(var d=0;d<r.length&&f.length!=0;){var u=f.shift();l-=u.length;var a=r.length-d;u.length<a?r.set(u,d):(r.set(u.slice(0,a),d),f.unshift(u.slice(a)),l+=u.length-a),d+=u.length}}},bn=function(h){var e=this,r,f,l,x,d,u,a,V,L=4;function p(G){var oe=G.outputBuffer.length,A=G.outputBuffer.getChannelData(0),R=this.module;if(R||(R=G.srcElement.module),!!R)if(R.callback){R.callback(A);return}else{for(var E=u[a],U=0;U<A.length;U++)A[U]=E[U];a=(a+1)%u.length}}function I(){if(u)for(var G of u)G.fill(0)}function k(){var G=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(!G){console.log("no web audio context");return}var oe=new G;e.context=oe,e.sr=e.context.sampleRate,e.bufferlen=2048,e.filterNode=e.context.createBiquadFilter(),e.filterNode.type="lowshelf",e.filterNode.frequency.value=100,e.filterNode.gain.value=-6,typeof e.context.createScriptProcessor=="function"?e.mixerNode=e.context.createScriptProcessor(e.bufferlen,1,1):e.mixerNode=e.context.createJavaScriptNode(e.bufferlen,1,1),e.mixerNode.module=e,e.mixerNode.onaudioprocess=p,e.compressorNode=e.context.createDynamicsCompressor(),e.mixerNode.connect(e.filterNode),e.filterNode.connect(e.compressorNode),e.compressorNode.connect(e.context.destination)}this.start=function(){if(this.context){this.context.state=="suspended"&&this.context.resume();return}if(k(),!!this.context){f=this.sr*1/h,r=0,l=0,d=0,u=[],a=1,V=0;for(var G=0;G<L;G++){var oe=new ArrayBuffer(e.bufferlen*4);u[G]=new Float32Array(oe)}x=u[0]}},this.stop=function(){this.context&&this.context.suspend&&this.context.suspend(),I()},this.close=function(){this.context&&(this.context.close(),this.context=null)},this.addSingleSample=function(G){if(!!x&&(x[d++]=G,d>=x.length)){d=0,u[V]=x;var oe=(V+1)%u.length;oe==a?V=Math.floor(a+L/2)%u.length:V=oe,x=u[V]}},this.feedSample=function(G,oe){if(l+=G*oe,r+=f*oe,r>=1){for(l/=r;r>=1;)this.addSingleSample(l*f),r-=1;l*=r}}},ft=class{constructor(e){this.sa=new bn(e)}feedSample(e,r){this.sa.feedSample(e,r)}start(){this.sa.start()}stop(){this.sa.stop()}},dn=class{constructor(e,r,f){this.audioGain=1/8192;this.bufferLength=r*2,this.channels=e.generate?[e]:e,this.channels.forEach(l=>{l.setBufferLength(this.bufferLength),l.setSampleRate(f)})}generate(e){var r=this.bufferLength,f=this.channels.map(x=>x.getBuffer());this.channels.forEach(x=>{x.generate(r)});for(let x=0;x<r;x+=2){var l=0;f.forEach(d=>l+=d[x]),e.feedSample(l*this.audioGain,1)}}};var Ee;(function(E){E[E.CLOCKS=0]="CLOCKS",E[E.EXECUTE=16777216]="EXECUTE",E[E.INTERRUPT=134217728]="INTERRUPT",E[E.ILLEGAL=150994944]="ILLEGAL",E[E.SP_PUSH=167772160]="SP_PUSH",E[E.SP_POP=184549376]="SP_POP",E[E.HAS_VALUE=268435456]="HAS_VALUE",E[E.MEM_READ=301989888]="MEM_READ",E[E.MEM_WRITE=318767104]="MEM_WRITE",E[E.IO_READ=335544320]="IO_READ",E[E.IO_WRITE=352321536]="IO_WRITE",E[E.VRAM_READ=369098752]="VRAM_READ",E[E.VRAM_WRITE=385875968]="VRAM_WRITE",E[E.DMA_READ=402653184]="DMA_READ",E[E.DMA_WRITE=419430400]="DMA_WRITE",E[E.WAIT=520093696]="WAIT",E[E.SCANLINE=2113929216]="SCANLINE",E[E.FRAME=2130706432]="FRAME"})(Ee||(Ee={}));var ct=class{constructor(e,r){this.idx=0;this.sl=0;this.cur_sp=-1;this.singleFrame=!0;this.m=e,this.reset(r||1048576)}start(){this.m.connectProbe(this)}stop(){this.m.connectProbe(null)}reset(e){e&&(this.buf=new Uint32Array(e)),this.sl=0,this.cur_sp=-1,this.clear()}clear(){this.idx=0}logData(e){this.log(e)}log(e){this.idx>=this.buf.length||(this.buf[this.idx++]=e)}relog(e){this.buf[this.idx-1]=e}lastOp(){return this.idx>0?this.buf[this.idx-1]&4278190080:-1}lastAddr(){return this.idx>0?this.buf[this.idx-1]&16777215:-1}addLogBuffer(e){this.idx+e.length>this.buf.length&&(e=e.slice(0,this.buf.length-this.idx)),this.buf.set(e,this.idx),this.idx+=e.length}logClocks(e){e|=0,e>0&&(this.lastOp()==0?this.relog(this.lastAddr()+e|0):this.log(e|0))}logNewScanline(){this.log(2113929216),this.sl++}logNewFrame(){this.log(2130706432),this.sl=0,this.singleFrame&&this.clear()}logExecute(e,r){this.cur_sp!==r&&(r<this.cur_sp&&this.log(167772160|r),r>this.cur_sp&&this.log(184549376|r),this.cur_sp=r),this.log(e|16777216)}logInterrupt(e){this.log(e|134217728)}logValue(e,r,f){this.log(e&65535|(r&255)<<16|f)}logRead(e,r){this.logValue(e,r,301989888)}logWrite(e,r){this.logValue(e,r,318767104)}logIORead(e,r){this.logValue(e,r,335544320)}logIOWrite(e,r){this.logValue(e,r,352321536)}logVRAMRead(e,r){this.logValue(e,r,369098752)}logVRAMWrite(e,r){this.logValue(e,r,385875968)}logIllegal(e){this.log(e|150994944)}logWait(e){this.log(e|520093696)}logDMARead(e,r){this.logValue(e,r,402653184)}logDMAWrite(e,r){this.logValue(e,r,419430400)}countEvents(e){for(var r=0,f=0;f<this.idx;f++)(this.buf[f]&4278190080)==e&&r++;return r}countClocks(){for(var e=0,r=0;r<this.idx;r++)(this.buf[r]&4278190080)==0&&(e+=this.buf[r]&65535);return e}};var Z0=class{logClocks(){}logNewScanline(){}logNewFrame(){}logExecute(){}logInterrupt(){}logRead(){}logWrite(){}logIORead(){}logIOWrite(){}logVRAMRead(){}logVRAMWrite(){}logIllegal(){}logWait(){}logDMARead(){}logDMAWrite(){}logData(){}addLogBuffer(e){}},pt=class{constructor(){this.inputs=new Uint8Array(32);this.nullProbe=new Z0;this.probe=this.nullProbe}setKeyInput(e,r,f){this.handler&&this.handler(e,r,f)}connectProbe(e){this.probe=e||this.nullProbe}reset(){this.cpu.reset()}loadROM(e,r){this.rom||(this.rom=new Uint8Array(this.defaultROMSize)),this.rom.set(e)}loadState(e){this.cpu.loadState(e.c),this.ram.set(e.ram),this.inputs.set(e.inputs)}saveState(){return{c:this.cpu.saveState(),ram:this.ram.slice(0),inputs:this.inputs.slice(0)}}loadControlsState(e){this.inputs.set(e.inputs)}saveControlsState(){return{inputs:this.inputs.slice(0)}}advanceCPU(){var e=this.cpu,r=1;return this.cpu.isStable()&&this.probe.logExecute(this.cpu.getPC(),this.cpu.getSP()),e.advanceClock?e.advanceClock():e.advanceInsn&&(r=e.advanceInsn(1)),this.probe.logClocks(r),r}probeMemoryBus(e){return{read:r=>{let f=e.read(r);return this.probe.logRead(r,f),f},write:(r,f)=>{this.probe.logWrite(r,f),e.write(r,f)}}}connectCPUMemoryBus(e){this.cpu.connectMemoryBus(this.probeMemoryBus(e))}probeIOBus(e){return{read:r=>{let f=e.read(r);return this.probe.logIORead(r,f),f},write:(r,f)=>{this.probe.logIOWrite(r,f),e.write(r,f)}}}probeDMABus(e){return{read:r=>{let f=e.read(r);return this.probe.logDMARead(r,f),f},write:(r,f)=>{this.probe.logDMAWrite(r,f),e.write(r,f)}}}connectCPUIOBus(e){this.cpu.connectIOBus(this.probeIOBus(e))}},_t=class extends pt{constructor(){super(...arguments);this.overscan=!1;this.rotate=0}getAudioParams(){return{sampleRate:this.sampleRate,stereo:!1}}connectAudio(e){this.audio=e}getVideoParams(){return{width:this.canvasWidth,height:this.numVisibleScanlines,aspect:this.aspectRatio,overscan:this.overscan,rotate:this.rotate}}connectVideo(e){this.pixels=e}},hn=class extends _t{advanceFrame(e){this.preFrame();var r=0,f=0;this.probe.logNewFrame(),this.frameCycles=0;for(var l=0;l<this.numTotalScanlines;l++){for(r+=this.cpuCyclesPerLine,this.scanline=l,this.startScanline();this.frameCycles<r;){if(e&&e()){l=999;break}this.frameCycles+=this.advanceCPU(),f++}this.drawScanline(),this.probe.logNewScanline(),this.probe.logClocks(Math.floor(this.frameCycles-r))}return this.postFrame(),f}preFrame(){}postFrame(){}getRasterY(){return this.scanline}getRasterX(){return this.frameCycles%this.cpuCyclesPerLine}};var Pt=["nop","ld bc,xx","ld (bc),a","inc bc","inc b","dec b","ld b,x","rlca","ex af,af'","add hl,bc","ld a,(bc)","dec bc","inc c","dec c","ld c,x","rrca","djnz x","ld de,xx","ld (de),a","inc de","inc d","dec d","ld d,x","rla","jr x","add hl,de","ld a,(de)","dec de","inc e","dec e","ld e,x","rra","jr nz,x","ld hl,xx","ld (xx),hl","inc hl","inc h","dec h","ld h,x","daa","jr z,x","add hl,hl","ld hl,(xx)","dec hl","inc l","dec l","ld l,x","cpl","jr nc,x","ld sp,xx","ld (xx),a","inc sp","inc (hl)","dec (hl)","ld (hl),x","scf","jr c,x","add hl,sp","ld a,(xx)","dec sp","inc a","dec a","ld a,x","ccf","ld b,b","ld b,c","ld b,d","ld b,e","ld b,h","ld b,l","ld b,(hl)","ld b,a","ld c,b","ld c,c","ld c,d","ld c,e","ld c,h","ld c,l","ld c,(hl)","ld c,a","ld d,b","ld d,c","ld d,d","ld d,e","ld d,h","ld d,l","ld d,(hl)","ld d,a","ld e,b","ld e,c","ld e,d","ld e,e","ld e,h","ld e,l","ld e,(hl)","ld e,a","ld h,b","ld h,c","ld h,d","ld h,e","ld h,h","ld h,l","ld h,(hl)","ld h,a","ld l,b","ld l,c","ld l,d","ld l,e","ld l,h","ld l,l","ld l,(hl)","ld l,a","ld (hl),b","ld (hl),c","ld (hl),d","ld (hl),e","ld (hl),h","ld (hl),l","halt","ld (hl),a","ld a,b","ld a,c","ld a,d","ld a,e","ld a,h","ld a,l","ld a,(hl)","ld a,a","add a,b","add a,c","add a,d","add a,e","add a,h","add a,l","add a,(hl)","add a,a","adc a,b","adc a,c","adc a,d","adc a,e","adc a,h","adc a,l","adc a,(hl)","adc a,a","sub b","sub c","sub d","sub e","sub h","sub l","sub (hl)","sub a","sbc a,b","sbc a,c","sbc a,d","sbc a,e","sbc a,h","sbc a,l","sbc a,(hl)","sbc a,a","and b","and c","and d","and e","and h","and l","and (hl)","and a","xor b","xor c","xor d","xor e","xor h","xor l","xor (hl)","xor a","or b","or c","or d","or e","or h","or l","or (hl)","or a","cp b","cp c","cp d","cp e","cp h","cp l","cp (hl)","cp a","ret nz","pop bc","jp nz,xx","jp xx","call nz,xx","push bc","add a,x","rst 00h","ret z","ret","jp z,xx","xxBITxx","call z,xx","call xx","adc a,x","rst 08h","ret nc","pop de","jp nc,xx","out (x),a","call nc,xx","push de","sub x","rst 10h","ret c","exx","jp c,xx","in a,(x)","call c,xx","xxIXxx","sbc a,x","rst 18h","ret po","pop hl","jp po,xx","ex (sp),hl","call po,xx","push hl","and x","rst 20h","ret pe","jp (hl)","jp pe,xx","ex de,hl","call pe,xx","xx80xx","xor x","rst 28h","ret p","pop af","jp p,xx","di","call p,xx","push af","or x","rst 30h","ret m","ld sp,hl","jp m,xx","ei","call m,xx","xxIYxx","cp x","rst 38h"],kt=["in b,(c)","out (c),b","sbc hl,bc","ld (xx),bc","neg","retn","im 0","ld i,a","in c,(c)","out (c),c","adc hl,bc","ld bc,(xx)","neg","reti","","ld r,a","in d,(c)","out (c),d","sbc hl,de","ld (xx),de","neg","retn","im 1","ld a,i","in e,(c)","out (c),e","adc hl,de","ld de,(xx)","neg","retn","im 2","ld a,r","in h,(c)","out (c),h","sbc hl,hl","ld (xx),hl","neg","retn","","rrd","in l,(c)","out (c),l","adc hl,hl","ld hl,(xx)","neg","retn","","rld","in f,(c)","out (c),f","sbc hl,sp","ld (xx),sp","neg","retn","","","in a,(c)","out (c),a","adc hl,sp","ld sp,(xx)","neg","reti","","","ldi","cpi","ini","outi","","","","","ldd","cpd","ind","outd","","","","","ldir","cpir","inir","otir","","","","","lddr","cpdr","indr","otdr","","","",""],Dt=["rlc b","rlc c","rlc d","rlc e","rlc h","rlc l","rlc (hl)","rlc a","rrc b","rrc c","rrc d","rrc e","rrc h","rrc l","rrc (hl)","rrc a","rl b","rl c","rl d","rl e","rl h","rl l","rl (hl)","rl a","rr b","rr c","rr d","rr e","rr h","rr l","rr (hl)","rr a","sla b","sla c","sla d","sla e","sla h","sla l","sla (hl)","sla a","sra b","sra c","sra d","sra e","sra h","sra l","sra (hl)","sra a","sll b","sll c","sll d","sll e","sll h","sll l","sll (hl)","sll a","srl b","srl c","srl d","srl e","srl h","srl l","srl (hl)","srl a","bit 0,b","bit 0,c","bit 0,d","bit 0,e","bit 0,h","bit 0,l","bit 0,(hl)","bit 0,a","bit 1,b","bit 1,c","bit 1,d","bit 1,e","bit 1,h","bit 1,l","bit 1,(hl)","bit 1,a","bit 2,b","bit 2,c","bit 2,d","bit 2,e","bit 2,h","bit 2,l","bit 2,(hl)","bit 2,a","bit 3,b","bit 3,c","bit 3,d","bit 3,e","bit 3,h","bit 3,l","bit 3,(hl)","bit 3,a","bit 4,b","bit 4,c","bit 4,d","bit 4,e","bit 4,h","bit 4,l","bit 4,(hl)","bit 4,a","bit 5,b","bit 5,c","bit 5,d","bit 5,e","bit 5,h","bit 5,l","bit 5,(hl)","bit 5,a","bit 6,b","bit 6,c","bit 6,d","bit 6,e","bit 6,h","bit 6,l","bit 6,(hl)","bit 6,a","bit 7,b","bit 7,c","bit 7,d","bit 7,e","bit 7,h","bit 7,l","bit 7,(hl)","bit 7,a","res 0,b","res 0,c","res 0,d","res 0,e","res 0,h","res 0,l","res 0,(hl)","res 0,a","res 1,b","res 1,c","res 1,d","res 1,e","res 1,h","res 1,l","res 1,(hl)","res 1,a","res 2,b","res 2,c","res 2,d","res 2,e","res 2,h","res 2,l","res 2,(hl)","res 2,a","res 3,b","res 3,c","res 3,d","res 3,e","res 3,h","res 3,l","res 3,(hl)","res 3,a","res 4,b","res 4,c","res 4,d","res 4,e","res 4,h","res 4,l","res 4,(hl)","res 4,a","res 5,b","res 5,c","res 5,d","res 5,e","res 5,h","res 5,l","res 5,(hl)","res 5,a","res 6,b","res 6,c","res 6,d","res 6,e","res 6,h","res 6,l","res 6,(hl)","res 6,a","res 7,b","res 7,c","res 7,d","res 7,e","res 7,h","res 7,l","res 7,(hl)","res 7,a","set 0,b","set 0,c","set 0,d","set 0,e","set 0,h","set 0,l","set 0,(hl)","set 0,a","set 1,b","set 1,c","set 1,d","set 1,e","set 1,h","set 1,l","set 1,(hl)","set 1,a","set 2,b","set 2,c","set 2,d","set 2,e","set 2,h","set 2,l","set 2,(hl)","set 2,a","set 3,b","set 3,c","set 3,d","set 3,e","set 3,h","set 3,l","set 3,(hl)","set 3,a","set 4,b","set 4,c","set 4,d","set 4,e","set 4,h","set 4,l","set 4,(hl)","set 4,a","set 5,b","set 5,c","set 5,d","set 5,e","set 5,h","set 5,l","set 5,(hl)","set 5,a","set 6,b","set 6,c","set 6,d","set 6,e","set 6,h","set 6,l","set 6,(hl)","set 6,a","set 7,b","set 7,c","set 7,d","set 7,e","set 7,h","set 7,l","set 7,(hl)","set 7,a"];function st(h,e,r,f,l){var x,d,u,a=[e,r,f,l],V=!1;switch(d=1,e){case 203:u=Dt[r],d++;break;case 237:r>=64&&r<=127&&(u=kt[r-64]),r>=160&&r<=191&&(u=kt[r-160+64]),d++;break;case 221:case 253:var L=e==221?"ix":"iy";r==203?(u=Dt[l],a[2]=l,a[3]=f,d++):u=Pt[r],u=u.replace(/[(]hl[)]/,"("+L+"+x)"),u=u.replace(/\bhl\b/,L),d++;break;default:u=Pt[e];break}if((!u||!u.length)&&(u="??"),/\bxx\b/.test(u))u=u.replace(/\bxx\b/,"$"+ae(a[d]+(a[d+1]<<8),4)),d+=2,V=!0;else if(/\bx\b/.test(u)){if(u.startsWith("j")){var p=r<128?h+2+r:h+2-(256-r);p&=65535,u=u.replace(/\bx\b/,"$"+ae(p,4)),V=!0}else u=u.replace(/\bx\b/,"$"+ae(a[d],2));d+=1}return{line:u.toUpperCase(),nbytes:d,isaddr:V}}var O0=class{constructor(e){this.maxROMSize=262144;this.videoOffsetBytes=0;this.prefix=e;var r=this;this.cpu={getPC:r.getPC.bind(r),getSP:r.getSP.bind(r),isStable:r.isStable.bind(r),reset:r.reset.bind(r),saveState:()=>r.getCPUState(),loadState:()=>{console.log("loadState not implemented")},connectMemoryBus(){console.log("connectMemoryBus not implemented")}}}getImports(e){return{}}async fetchWASM(){var e=await fetch("res/"+this.prefix+".wasm");if(e.status==200||e.size){var r=await e.arrayBuffer(),f=await WebAssembly.compile(r),l=await WebAssembly.instantiate(f,this.getImports(f));this.instance=l,this.exports=l.exports}else throw new Error("could not load WASM file")}async fetchBIOS(){var e=await fetch("res/"+this.prefix+".bios");if(e.status==200||e.size){var r=await e.arrayBuffer();this.biosptr=this.exports.malloc(r.byteLength),this.biosarr=new Uint8Array(this.exports.memory.buffer,this.biosptr,r.byteLength),this.loadBIOS(new Uint8Array(r))}else throw new Error("could not load BIOS file")}async initWASM(){this.sys=this.exports.machine_init(this.biosptr);let e=this.exports.machine_get_state_size();this.stateptr=this.exports.malloc(e);let r=this.exports.machine_get_controls_state_size();this.ctrlstateptr=this.exports.malloc(r);let f=this.exports.machine_get_cpu_state_size();this.cpustateptr=this.exports.malloc(f),this.romptr=this.exports.malloc(this.maxROMSize),this.statearr=new Uint8Array(this.exports.memory.buffer,this.stateptr,e),this.ctrlstatearr=new Uint8Array(this.exports.memory.buffer,this.ctrlstateptr,r),this.cpustatearr=new Uint8Array(this.exports.memory.buffer,this.cpustateptr,f);let l=4096*4;this.audioarr=new Float32Array(this.exports.memory.buffer,this.exports.machine_get_sample_buffer(),l),this.romarr=new Uint8Array(this.exports.memory.buffer,this.romptr,this.maxROMSize),console.log("machine_init",this.sys,e,r,f,l)}async loadWASM(){await this.fetchWASM(),this.exports.memory.grow(96),await this.fetchBIOS(),await this.initWASM()}getPC(){return this.exports.machine_cpu_get_pc(this.sys)}getSP(){return this.exports.machine_cpu_get_sp(this.sys)}isStable(){return this.exports.machine_cpu_is_stable(this.sys)}loadROM(e){if(e.length>this.maxROMSize)throw new vt(`Rom size too big: ${e.length} bytes`);this.romarr.set(e),this.romlen=e.length,console.log("load rom",e.length,"bytes"),this.reset()}loadBIOS(e){this.biosarr.set(e)}reset(){this.exports.machine_reset(this.sys)}read(e){return this.exports.machine_mem_read(this.sys,e&65535)}readConst(e){return this.exports.machine_mem_read(this.sys,e&65535)}write(e,r){this.exports.machine_mem_write(this.sys,e&65535,r&255)}getAudioParams(){return{sampleRate:44100,stereo:!1}}connectVideo(e){this.pixel_dest=e;var r=this.exports.machine_get_pixel_buffer(this.sys);console.log("connectVideo",r,e.length),this.pixel_src=new Uint32Array(this.exports.memory.buffer,r+this.videoOffsetBytes,e.length)}syncVideo(){this.exports.machine_update_video&&this.exports.machine_update_video(this.sys),this.pixel_dest!=null&&this.pixel_dest.set(this.pixel_src)}saveControlsState(){return this.exports.machine_save_controls_state(this.sys,this.ctrlstateptr),{controls:this.ctrlstatearr.slice(0)}}loadControlsState(e){this.ctrlstatearr.set(e.controls),this.exports.machine_load_controls_state(this.sys,this.ctrlstateptr)}connectAudio(e){this.audio=e}syncAudio(){if(this.audio!=null)for(var e=this.exports.machine_get_sample_count(),r=0;r<e;r++)this.audio.feedSample(this.audioarr[r],1)}advanceFrameClock(e,r){var f;if(e)for(f=0;f<r&&!e();f++)this.exports.machine_tick(this.sys);else this.exports.machine_exec(this.sys,r),f=r;return this.syncVideo(),this.syncAudio(),f}copyProbeData(){if(this.probe&&!(this.probe instanceof Z0)){var e=this.exports.machine_get_probe_buffer_size(),r=this.exports.machine_get_probe_buffer_address(),f=new Uint32Array(this.exports.memory.buffer,r,e);this.probe.logNewFrame(),this.probe.addLogBuffer(f)}}connectProbe(e){this.probe=e}getDebugTree(){return this.saveState()}},e0=function(){return console.log(arguments),0},An=class extends O0{constructor(e){super(e)}getImports(e){var r=this.wasiInstance.getImports(e);return r.env={system:e0,__sys_mkdir:e0,__sys_chmod:e0,__sys_stat64:e0,__sys_unlink:e0,__sys_rename:e0,__sys_getdents64:e0,__sys_getcwd:e0,__sys_rmdir:e0,emscripten_thread_sleep:e0},r}stdoutWrite(e){return console.log(">>>",e.toString()),e.length}async loadWASM(){let e=await import("./index.esm-5YCYWKYY.js"),r=await import("./index.esm-IVCZ4JDS.js");this.wasmFs=new r.WasmFs;let f=e.WASI.defaultBindings;f.fs=this.wasmFs.fs,f.fs.mkdirSync("/tmp"),f.path=f.path.default,this.wasiInstance=new e.WASI({preopenDirectories:{"/tmp":"/tmp"},env:{},args:[],bindings:f}),this.wasmFs.volume.fds[1].write=this.stdoutWrite.bind(this),this.wasmFs.volume.fds[2].write=this.stdoutWrite.bind(this),await this.fetchWASM(),this.wasiInstance.start(this.instance),await this.initWASM()}};"use strict";function V0(){var h,e,r,f,l,x,d,u,a,V,L=1,p=2,I=4,k=8,G=16,oe=32,A=64,R=128,E=65534,U=65532,z=65530,i=65528,c=65526,ge=65524,Fe=65522,W=0,Be,_,C,Ze=[6,0,0,6,6,0,6,6,6,6,6,0,6,6,3,6,0,0,2,4,0,0,5,9,0,2,3,0,3,2,8,6,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,5,5,5,5,0,5,3,6,9,11,0,19,2,0,0,2,2,0,2,2,2,2,2,0,2,2,0,2,2,0,0,2,2,0,2,2,2,2,2,0,2,2,0,2,6,0,0,6,6,0,6,6,6,6,6,0,6,6,3,6,7,0,0,7,7,0,7,7,7,7,7,0,7,7,4,7,2,2,2,4,2,2,2,0,2,2,2,2,4,7,3,0,4,4,4,6,4,4,4,4,4,4,4,4,6,7,5,5,4,4,4,6,4,4,4,4,4,4,4,4,6,7,5,5,5,5,5,7,5,5,5,5,5,5,5,5,7,8,6,6,2,2,2,4,2,2,2,0,2,2,2,2,3,0,3,0,4,4,4,6,4,4,4,4,4,4,4,4,5,5,5,5,4,4,4,6,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,7,5,5,5,5,5,5,5,5,6,6,6,6],te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,0,0,0,0,0,5,0,4,0,0,0,0,7,0,0,0,0,0,0,0,0,7,0,6,6,0,0,0,7,0,0,0,0,0,0,0,0,7,0,6,6,0,0,0,8,0,0,0,0,0,0,0,0,8,0,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7],q=[4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],We=function(o,n,g){a|=((o^n^g^g>>1)&128)>>6},K=function(o,n,g){a|=((o^n^g^g>>1)&32768)>>14},H=function(){return(e<<8)+r},Ae=function(o){e=o>>8&255,r=o&255},ue=function(o){_(--d,o&255)},O=function(o){_(--d,o&255),_(--d,o>>8&255)},Xe=function(o){_(--x,o&255)},Ve=function(o){_(--x,o&255),_(--x,o>>8&255)},Ue=function(){return C(d++)},De=function(){return C(d++)*256+C(d++)},Q=function(){return C(x++)},me=function(){return C(x++)*256+C(x++)},we=function(o){var n=0;o&128&&(O(u),n+=2),o&64&&(O(x),n+=2),o&32&&(O(l),n+=2),o&16&&(O(f),n+=2),o&8&&(ue(V),n++),o&4&&(ue(r),n++),o&2&&(ue(e),n++),o&1&&(ue(a),n++),W+=n},be=function(o){var n=0;o&128&&(Ve(u),n+=2),o&64&&(Ve(d),n+=2),o&32&&(Ve(l),n+=2),o&16&&(Ve(f),n+=2),o&8&&(Xe(V),n++),o&4&&(Xe(r),n++),o&2&&(Xe(e),n++),o&1&&(Xe(a),n++),W+=n},ye=function(o){var n=0;o&1&&(a=Ue(),n++),o&2&&(e=Ue(),n++),o&4&&(r=Ue(),n++),o&8&&(V=Ue(),n++),o&16&&(f=De(),n+=2),o&32&&(l=De(),n+=2),o&64&&(x=De(),n+=2),o&128&&(u=De(),n+=2),W+=n},ze=function(o){var n=0;o&1&&(a=Q(),n++),o&2&&(e=Q(),n++),o&4&&(r=Q(),n++),o&8&&(V=Q(),n++),o&16&&(f=me(),n+=2),o&32&&(l=me(),n+=2),o&64&&(d=me(),n+=2),o&128&&(u=me(),n+=2),W+=n},Ne=function(o){switch(o&15){case 0:return H();case 1:return f;case 2:return l;case 3:return x;case 4:return d;case 5:return u;case 8:return e;case 9:return r;case 10:return a;case 11:return V;default:return null}},He=function(o,n){switch(o&15){case 0:Ae(n);return;case 1:f=n;return;case 2:l=n;return;case 3:x=n;return;case 4:d=n;return;case 5:u=n;return;case 8:e=n;return;case 9:r=n;return;case 10:a=n;return;case 11:V=n;return;default:return}},pe=function(o,n){var g=o&136;(g==128||g==8)&&(g=0),n?(g=Ne(o>>4),He(o>>4,Ne(o)),He(o,g)):He(o,Ne(o>>4))},ce=function(o){return o>127?o-256:o},ie=function(o){return o>32767?o-65536:o},M=function(){var o=C(u++);return u&=65535,o},D=function(){var o=C(u++);u&=65535;var n=C(u++);return u&=65535,o*256+n},F=function(o){var n=C(o++);o&=65535;var g=C(o++);return o&=65535,n*256+g},fe=function(o,n){_(o++,n>>8&255),o&=65535,_(o,n&255)},T=function(){var o=M(),n;switch(o&96){case 0:n=f;break;case 32:n=l;break;case 64:n=x;break;case 96:n=d;break}var g=null,s=null,t;if(o&128){switch(o&15){case 0:s=n,g=n+1,W+=2;break;case 1:s=n,g=n+2,W+=3;break;case 2:g=n-1,s=g,W+=2;break;case 3:g=n-2,s=g,W+=3;break;case 4:s=n;break;case 5:s=n+ce(r),W+=1;break;case 6:s=n+ce(e),W+=1;break;case 7:s=0;break;case 8:s=n+ce(M()),W+=1;break;case 9:s=n+ie(D()),W+=4;break;case 10:s=0;break;case 11:W+=4,s=n+H();break;case 12:t=ce(M()),s=u+t,W+=1;break;case 13:t=ie(D()),s=u+t,W+=5;break;case 14:s=0;break;case 15:W+=5,s=D();break}s&=65535,o&16&&(s=C(s)*256+C(s+1&65535),W+=3)}else{var b=o&31;b>15&&(b-=32),s=n+b,W+=1}if(g!==null)switch(o&96){case 0:f=g;break;case 32:l=g;break;case 64:x=g;break;case 96:d=g;break}return s&65535},ne=function(o){a&=~(I|k),o===0&&(a|=I),o&32768&&(a|=k)},w=function(o){return o++,o&=255,a&=~(I|p|k),a|=q[o],(o===0||o==128)&&(a|=p),o},N=function(o){return o--,o&=255,a&=~(I|p|k),a|=q[o],(o===127||o==255)&&(a|=p),o},_e=function(o,n){var g=o-n;return a&=~(L|I|p|k),a|=q[g&255],g&256&&(a|=L),We(o,n,g),g&255},Y=function(o,n){var g=o-n;return a&=~(L|I|p|k),(g&65535)==0&&(a|=I),g&32768&&(a|=k),g&65536&&(a|=L),K(o,n,g),g&65535},re=function(o,n){var g=o+n;return a&=~(oe|L|I|p|k),a|=q[g&255],g&256&&(a|=L),We(o,n,g),(g^o^n)&16&&(a|=oe),g&255},ve=function(o,n){var g=o+n;return a&=~(L|I|p|k),(g&65535)==0&&(a|=I),g&32768&&(a|=k),g&65536&&(a|=L),K(o,n,g),g&65535},$=function(o,n){var g=o+n+(a&L);return a&=~(oe|L|I|p|k),a|=q[g&255],g&256&&(a|=L),We(o,n,g),(g^o^n)&16&&(a|=oe),g&255},le=function(o,n){var g=o-n-(a&L);return a&=~(L|I|p|k),a|=q[g&255],g&256&&(a|=L),We(o,n,g),g&255},Ie=function(o,n){var g=o-n;a&=~(L|I|p|k),a|=q[g&255],g&256&&(a|=L),We(o,n,g)},Z=function(o,n){var g=o-n;a&=~(L|I|p|k),(g&65535)==0&&(a|=I),g&32768&&(a|=k),g&65536&&(a|=L),K(o,n,g)},ee=function(o){return a&=~(L|I|p|k),o==128&&(a|=p),o=(~o&255)+1,o===0&&(a|=I),o&128&&(a|=k|L),o},se=function(o){return a&=~(I|L|k),o&1&&(a|=L),o>>=1,o===0&&(a|=I),o&255},Pe=function(o){return a&=~(I|L|k),o&1&&(a|=L),o=o&128|o>>1,a|=q[o],o},Re=function(o){var n=o;return a&=~(I|L|k|p),o&128&&(a|=L),o<<=1,a|=q[o],(o^n)&128&&(a|=p),o},Ye=function(o){var n=o,g=a&L;return a&=~(I|L|k|p),o&128&&(a|=L),o=o<<1|g,a|=q[o],(o^n)&128&&(a|=p),o},xe=function(o){var n=a&L;return a&=~(I|L|k),o&1&&(a|=L),o=o>>1|n<<7,a|=q[o],o},de=function(o,n){return a&=~(I|k|p),o^=n,a|=q[o],o},Me=function(o,n){return a&=~(I|k|p),o|=n,a|=q[o],o},ke=function(o,n){return a&=~(I|k|p),o&=n,a|=q[o],o},Ke=function(o){return a&=~(I|k|p),o^=255,a|=q[o],a|=L,o},X=function(){return V*256+M()},je=function(){var o=W,n=null,g=null,s=u,t=M();switch(W+=Ze[t],t){case 0:n=X(),_(n,ee(C(n)));break;case 3:n=X(),_(n,Ke(C(n)));break;case 4:n=X(),_(n,se(C(n)));break;case 6:n=X(),_(n,xe(C(n)));break;case 7:n=X(),_(n,Pe(C(n)));break;case 8:n=X(),_(n,Re(C(n)));break;case 9:n=X(),_(n,Ye(C(n)));break;case 10:n=X(),_(n,N(C(n)));break;case 12:n=X(),_(n,w(C(n)));break;case 13:n=X(),g=C(n),a&=~(I|k|p),a|=q[g];break;case 14:n=X(),u=n;break;case 15:n=X(),_(n,0),a&=~(L|k|p),a|=I;break;case 18:break;case 19:break;case 22:n=ie(D()),u+=n;break;case 23:n=ie(D()),O(u),u+=n;break;case 25:var b=0,P=e&240,Le=e&15;(Le>9||a&32)&&(b|=6),P>128&&Le>9&&(b|=96),(P>144||a&1)&&(b|=96),n=b+e,a&=~(L|k|I|p),n&256&&(a|=L),e=n&255,a|=q[e];break;case 26:a|=M();break;case 28:a&=M();break;case 29:e=r&128?255:0,ne(H()),a&=~p;break;case 30:g=M(),pe(g,!0);break;case 31:g=M(),pe(g,!1);break;case 32:n=ce(M()),u+=n;break;case 33:n=ce(M());break;case 34:n=ce(M()),a&(L|I)||(u+=n);break;case 35:n=ce(M()),a&(L|I)&&(u+=n);break;case 36:n=ce(M()),a&L||(u+=n);break;case 37:n=ce(M()),a&L&&(u+=n);break;case 38:n=ce(M()),a&I||(u+=n);break;case 39:n=ce(M()),a&I&&(u+=n);break;case 40:n=ce(M()),a&p||(u+=n);break;case 41:n=ce(M()),a&p&&(u+=n);break;case 42:n=ce(M()),a&k||(u+=n);break;case 43:n=ce(M()),a&k&&(u+=n);break;case 44:n=ce(M()),a&k^(a&p)<<2||(u+=n);break;case 45:n=ce(M()),a&k^(a&p)<<2&&(u+=n);break;case 46:n=ce(M()),a&k^(a&p)<<2||a&I||(u+=n);break;case 47:n=ce(M()),(a&k^(a&p)<<2||a&I)&&(u+=n);break;case 48:f=T(),f===0?a|=I:a&=~I;break;case 49:l=T(),l===0?a|=I:a&=~I;break;case 50:d=T();break;case 51:x=T();break;case 52:we(M());break;case 53:ye(M());break;case 54:be(M());break;case 55:ze(M());break;case 57:u=De();break;case 58:f+=r;break;case 59:a=Ue(),a&R&&(W+=9,e=Ue(),r=Ue(),V=Ue(),f=De(),l=De(),x=De()),u=De();break;case 60:a&=M();break;case 61:n=e*r,n===0?a|=I:a&=~I,n&128?a|=L:a&=~L,Ae(n);break;case 63:a|=R,O(u),O(x),O(l),O(f),ue(V),ue(r),ue(e),ue(a),a|=G|A,u=F(z);break;case 64:e=ee(e);break;case 67:e=Ke(e);break;case 68:e=se(e);break;case 70:e=xe(e);break;case 71:e=Pe(e);break;case 72:e=Re(e);break;case 73:e=Ye(e);break;case 74:e=N(e);break;case 76:e=w(e);break;case 77:a&=~(I|k|p),a|=q[e];break;case 79:e=0,a&=~(k|p|L),a|=I;break;case 80:r=ee(r);break;case 83:r=Ke(r);break;case 84:r=se(r);break;case 86:r=xe(r);break;case 87:r=Pe(r);break;case 88:r=Re(r);break;case 89:r=Ye(r);break;case 90:r=N(r);break;case 92:r=w(r);break;case 93:a&=~(I|k|p),a|=q[r];break;case 95:r=0,a&=~(k|p|L),a|=I;break;case 96:n=T(),_(n,ee(C(n)));break;case 99:n=T(),_(n,Ke(C(n)));break;case 100:n=T(),_(n,se(C(n)));break;case 102:n=T(),_(n,xe(C(n)));break;case 103:n=T(),_(n,Pe(C(n)));break;case 104:n=T(),_(n,Re(C(n)));break;case 105:n=T(),_(n,Ye(C(n)));break;case 106:n=T(),_(n,N(C(n)));break;case 108:n=T(),_(n,w(C(n)));break;case 109:n=T(),g=C(n),a&=~(I|k|p),a|=q[g];break;case 110:n=T(),u=n;break;case 111:n=T(),_(n,0),a&=~(L|k|p),a|=I;break;case 112:n=D(),_(n,ee(C(n)));break;case 115:n=D(),_(n,Ke(C(n)));break;case 116:n=D(),_(n,se(C(n)));break;case 118:n=D(),_(n,xe(C(n)));break;case 119:n=D(),_(n,Pe(C(n)));break;case 120:n=D(),_(n,Re(C(n)));break;case 121:n=D(),_(n,Ye(C(n)));break;case 122:n=D(),_(n,N(C(n)));break;case 124:n=D(),_(n,w(C(n)));break;case 125:n=D(),g=C(n),a&=~(I|k|p),a|=q[g];break;case 126:n=D(),u=n;break;case 127:n=D(),_(n,0),a&=~(L|k|p),a|=I;break;case 128:e=_e(e,M());break;case 129:Ie(e,M());break;case 130:e=le(e,M());break;case 131:Ae(Y(H(),D()));break;case 132:e=ke(e,M());break;case 133:ke(e,M());break;case 134:e=M(),a&=~(I|k|p),a|=q[e];break;case 136:e=de(e,M());break;case 137:e=$(e,M());break;case 138:e=Me(e,M());break;case 139:e=re(e,M());break;case 140:Z(f,D());break;case 141:n=ce(M()),O(u),u+=n;break;case 142:f=D(),ne(f),a&=~p;break;case 144:n=X(),e=_e(e,C(n));break;case 145:n=X(),Ie(e,C(n));break;case 146:n=X(),e=le(e,C(n));break;case 147:n=X(),Ae(Y(H(),F(n)));break;case 148:n=X(),e=ke(e,C(n));break;case 149:n=X(),ke(e,C(n));break;case 150:n=X(),e=C(n),a&=~(I|k|p),a|=q[e];break;case 151:n=X(),_(n,e),a&=~(I|k|p),a|=q[e];break;case 152:n=X(),e=de(e,C(n));break;case 153:n=X(),e=$(e,C(n));break;case 154:n=X(),e=Me(e,C(n));break;case 155:n=X(),e=re(e,C(n));break;case 156:n=X(),Z(f,F(n));break;case 157:n=X(),O(u),u=n;break;case 158:n=X(),f=F(n),ne(f),a&=~p;break;case 159:n=X(),fe(n,f),ne(f),a&=~p;break;case 160:n=T(),e=_e(e,C(n));break;case 161:n=T(),Ie(e,C(n));break;case 162:n=T(),e=le(e,C(n));break;case 163:n=T(),Ae(Y(H(),F(n)));break;case 164:n=T(),e=ke(e,C(n));break;case 165:n=T(),ke(e,C(n));break;case 166:n=T(),e=C(n),a&=~(I|k|p),a|=q[e];break;case 167:n=T(),_(n,e),a&=~(I|k|p),a|=q[e];break;case 168:n=T(),e=de(e,C(n));break;case 169:n=T(),e=$(e,C(n));break;case 170:n=T(),e=Me(e,C(n));break;case 171:n=T(),e=re(e,C(n));break;case 172:n=T(),Z(f,F(n));break;case 173:n=T(),O(u),u=n;break;case 174:n=T(),f=F(n),ne(f),a&=~p;break;case 175:n=T(),fe(n,f),ne(f),a&=~p;break;case 176:n=D(),e=_e(e,C(n));break;case 177:n=D(),Ie(e,C(n));break;case 178:n=D(),e=le(e,C(n));break;case 179:n=D(),Ae(Y(H(),F(n)));break;case 180:n=D(),e=ke(e,C(n));break;case 181:n=D(),ke(e,C(n));break;case 182:n=D(),e=C(n),a&=~(I|k|p),a|=q[e];break;case 183:n=D(),_(n,e),a&=~(I|k|p),a|=q[e];break;case 184:n=D(),e=de(e,C(n));break;case 185:n=D(),e=$(e,C(n));break;case 186:n=D(),e=Me(e,C(n));break;case 187:n=D(),e=re(e,C(n));break;case 188:n=D(),Z(f,F(n));break;case 189:n=D(),O(u),u=n;break;case 190:n=D(),f=F(n),ne(f),a&=~p;break;case 191:n=D(),fe(n,f),ne(f),a&=~p;break;case 192:r=_e(r,M());break;case 193:Ie(r,M());break;case 194:r=le(r,M());break;case 195:Ae(ve(H(),D()));break;case 196:r=ke(r,M());break;case 197:ke(r,M());break;case 198:r=M(),a&=~(I|k|p),a|=q[r];break;case 200:r=de(r,M());break;case 201:r=$(r,M());break;case 202:r=Me(r,M());break;case 203:r=re(r,M());break;case 204:n=D(),Ae(n),ne(n),a&=~p;break;case 206:x=D(),ne(x),a&=~p;break;case 208:n=X(),r=_e(r,C(n));break;case 209:n=X(),Ie(r,C(n));break;case 210:n=X(),r=le(r,C(n));break;case 211:n=X(),Ae(ve(H(),F(n)));break;case 212:n=X(),r=ke(r,C(n));break;case 213:n=X(),ke(r,C(n));break;case 214:n=X(),r=C(n),a&=~(I|k|p),a|=q[r];break;case 215:n=X(),_(n,r),a&=~(I|k|p),a|=q[r];break;case 216:n=X(),r=de(r,C(n));break;case 217:n=X(),r=$(r,C(n));break;case 218:n=X(),r=Me(r,C(n));break;case 219:n=X(),r=re(r,C(n));break;case 220:n=X(),g=F(n),Ae(g),ne(g),a&=~p;break;case 221:n=X(),fe(n,H()),a&=~p;break;case 222:n=X(),x=F(n),ne(x),a&=~p;break;case 223:n=X(),fe(n,x),ne(x),a&=~p;break;case 224:n=T(),r=_e(r,C(n));break;case 225:n=T(),Ie(r,C(n));break;case 226:n=T(),r=le(r,C(n));break;case 227:n=T(),Ae(ve(H(),F(n)));break;case 228:n=T(),r=ke(r,C(n));break;case 229:n=T(),ke(r,C(n));break;case 230:n=T(),r=C(n),a&=~(I|k|p),a|=q[r];break;case 231:n=T(),_(n,r),a&=~(I|k|p),a|=q[r];break;case 232:n=T(),r=de(r,C(n));break;case 233:n=T(),r=$(r,C(n));break;case 234:n=T(),r=Me(r,C(n));break;case 235:n=T(),r=re(r,C(n));break;case 236:n=T(),g=F(n),Ae(g),ne(g),a&=~p;break;case 237:n=T(),fe(n,H()),a&=~p;break;case 238:n=T(),x=F(n),ne(x),a&=~p;break;case 239:n=T(),fe(n,x),ne(x),a&=~p;break;case 240:n=D(),r=_e(r,C(n));break;case 241:n=D(),Ie(r,C(n));break;case 242:n=D(),r=le(r,C(n));break;case 243:n=D(),Ae(ve(H(),F(n)));break;case 244:n=D(),r=ke(r,C(n));break;case 245:n=D(),ke(r,C(n));break;case 246:n=D(),r=C(n),a&=~(I|k|p),a|=q[r];break;case 247:n=D(),_(n,r),a&=~(I|k|p),a|=q[r];break;case 248:n=D(),r=de(r,C(n));break;case 249:n=D(),r=$(r,C(n));break;case 250:n=D(),r=Me(r,C(n));break;case 251:n=D(),r=re(r,C(n));break;case 252:n=D(),g=F(n),Ae(g),ne(g),a&=~p;break;case 253:n=D(),fe(n,H()),a&=~p;break;case 254:n=D(),x=F(n),ne(x),a&=~p;break;case 255:n=D(),fe(n,x),ne(x),a&=~p;break;case 16:switch(t=M(),W+=te[t],t){case 33:n=ie(D());break;case 34:n=ie(D()),a&(L|I)||(u+=n);break;case 35:n=ie(D()),a&(L|I)&&(u+=n);break;case 36:n=ie(D()),a&L||(u+=n);break;case 37:n=ie(D()),a&L&&(u+=n);break;case 38:n=ie(D()),a&I||(u+=n);break;case 39:n=ie(D()),a&I&&(u+=n);break;case 40:n=ie(D()),a&p||(u+=n);break;case 41:n=ie(D()),a&p&&(u+=n);break;case 42:n=ie(D()),a&k||(u+=n);break;case 43:n=ie(D()),a&k&&(u+=n);break;case 44:n=ie(D()),a&k^(a&p)<<2||(u+=n);break;case 45:n=ie(D()),a&k^(a&p)<<2&&(u+=n);break;case 46:n=ie(D()),a&k^(a&p)<<2||a&I||(u+=n);break;case 47:n=ie(D()),(a&k^(a&p)<<2||a&I)&&(u+=n);break;case 63:a|=R,O(u),O(x),O(l),O(f),ue(V),ue(r),ue(e),ue(a),a|=G|A,u=F(ge);break;case 131:Z(H(),D());break;case 140:Z(l,D());break;case 142:l=D(),ne(l),a&=~p;break;case 147:n=X(),Z(H(),F(n));break;case 156:n=X(),Z(l,F(n));break;case 158:n=X(),l=F(n),ne(l),a&=~p;break;case 159:n=X(),fe(n,l),ne(l),a&=~p;break;case 163:n=T(),Z(H(),F(n));break;case 172:n=T(),Z(l,F(n));break;case 174:n=T(),l=F(n),ne(l),a&=~p;break;case 175:n=T(),fe(n,l),ne(l),a&=~p;break;case 179:n=D(),Z(H(),F(n));break;case 188:n=D(),Z(l,F(n));break;case 190:n=D(),l=F(n),ne(l),a&=~p;break;case 191:n=D(),fe(n,l),ne(l),a&=~p;break;case 206:d=D(),ne(d),a&=~p;break;case 222:n=X(),d=F(n),ne(d),a&=~p;break;case 223:n=X(),fe(n,d),ne(d),a&=~p;break;case 238:n=T(),d=F(n),ne(d),a&=~p;break;case 239:n=T(),fe(n,d),ne(d),a&=~p;break;case 254:n=D(),d=F(n),ne(d),a&=~p;break;case 255:n=D(),fe(n,d),ne(d),a&=~p;break}break;case 17:switch(t=M(),W+=te[t],t){case 63:a|=R,O(u),O(x),O(l),O(f),ue(V),ue(r),ue(e),ue(a),a|=G|A,u=F(Fe);break;case 131:Z(x,D());break;case 140:Z(d,D());break;case 147:n=X(),Z(x,F(n));break;case 156:n=X(),Z(d,F(n));break;case 163:n=T(),Z(x,F(n));break;case 172:n=T(),Z(d,F(n));break;case 179:n=D(),Z(x,F(n));break;case 188:n=D(),Z(d,F(n));break}break}return e&=255,r&=255,a&=255,V&=255,f&=65535,l&=65535,x&=65535,d&=65535,u&=65535,W-o},Qe=function(){u=F(E),V=0,a|=A|G,W=0,e=r=V=f=l=x=d=0},t0=[[2,1,"NEG"],[1,0,"???"],[1,0,"???"],[2,1,"COM"],[2,1,"LSR"],[1,0,"???"],[2,1,"ROR"],[2,1,"ASR"],[2,1,"LSL"],[2,1,"ROL"],[2,1,"DEC"],[1,0,"???"],[2,1,"INC"],[2,1,"TST"],[2,1,"JMP"],[2,1,"CLR"],[1,0,"Prefix"],[1,0,"Prefix"],[1,2,"NOP"],[1,2,"SYNC"],[1,0,"???"],[1,0,"???"],[3,3,"LBRA"],[3,3,"LBSR"],[1,0,"???"],[1,2,"DAA"],[2,4,"ORCC"],[1,0,"???"],[2,4,"ANDCC"],[1,2,"SEX"],[2,20,"EXG"],[2,20,"TFR"],[2,5,"BRA"],[2,5,"BRN"],[2,5,"BHI"],[2,5,"BLS"],[2,5,"BCC"],[2,5,"BCS"],[2,5,"BNE"],[2,5,"BEQ"],[2,5,"BVC"],[2,5,"BVS"],[2,5,"BPL"],[2,5,"BMI"],[2,5,"BGE"],[2,5,"BLT"],[2,5,"BGT"],[2,5,"BLE"],[2,6,"LEAX"],[2,6,"LEAY"],[2,6,"LEAS"],[2,6,"LEAU"],[2,10,"PSHS"],[2,10,"PULS"],[2,11,"PSHU"],[2,11,"PULU"],[1,0,"???"],[1,2,"RTS"],[1,2,"ABX"],[1,2,"RTI"],[2,2,"CWAI"],[1,2,"MUL"],[1,2,"RESET"],[1,2,"SWI1"],[1,2,"NEGA"],[1,0,"???"],[1,0,"???"],[1,2,"COMA"],[1,2,"LSRA"],[1,0,"???"],[1,2,"RORA"],[1,2,"ASRA"],[1,2,"ASLA"],[1,2,"ROLA"],[1,2,"DECA"],[1,0,"???"],[1,2,"INCA"],[1,2,"TSTA"],[1,0,"???"],[1,2,"CLRA"],[1,2,"NEGB"],[1,0,"???"],[1,0,"???"],[1,2,"COMB"],[1,2,"LSRB"],[1,0,"???"],[1,2,"RORB"],[1,2,"ASRB"],[1,2,"ASLB"],[1,2,"ROLB"],[1,2,"DECB"],[1,0,"???"],[1,2,"INCB"],[1,2,"TSTB"],[1,0,"???"],[1,2,"CLRB"],[2,6,"NEG"],[1,0,"???"],[1,0,"???"],[2,6,"COM"],[2,6,"LSR"],[1,0,"???"],[2,6,"ROR"],[2,6,"ASR"],[2,6,"LSL"],[2,6,"ROL"],[2,6,"DEC"],[1,0,"???"],[2,6,"INC"],[2,6,"TST"],[2,6,"JMP"],[2,6,"CLR"],[3,7,"NEG"],[1,0,"???"],[1,0,"???"],[3,7,"COM"],[3,7,"LSR"],[1,0,"???"],[3,7,"ROR"],[3,7,"ASR"],[3,7,"LSL"],[3,7,"ROL"],[3,7,"DEC"],[1,0,"???"],[3,7,"INC"],[3,7,"TST"],[3,7,"JMP"],[3,7,"CLR"],[2,4,"SUBA"],[2,4,"CMPA"],[2,4,"SBCA"],[3,8,"SUBD"],[2,4,"ANDA"],[2,4,"BITA"],[2,4,"LDA"],[1,0,"???"],[2,4,"EORA"],[2,4,"ADCA"],[2,4,"ORA"],[2,4,"ADDA"],[3,8,"CMPX"],[2,5,"BSR"],[3,8,"LDX"],[1,0,"???"],[2,1,"SUBA"],[2,1,"CMPA"],[2,1,"SBCA"],[2,1,"SUBd"],[2,1,"ANDA"],[2,1,"BITA"],[2,1,"LDA"],[2,1,"STA"],[2,1,"EORA"],[2,1,"ADCA"],[2,1,"ORA"],[2,1,"ADDA"],[2,1,"CMPX"],[2,1,"JSR"],[2,1,"LDX"],[2,1,"STX"],[2,6,"SUBA"],[2,6,"CMPA"],[2,6,"SBCA"],[2,6,"SUBD"],[2,6,"ANDA"],[2,6,"BITA"],[2,6,"LDA"],[2,6,"STA"],[2,6,"EORA"],[2,6,"ADCA"],[2,6,"ORA"],[2,6,"ADDA"],[2,6,"CMPX"],[2,6,"JSR"],[2,6,"LDX"],[2,6,"STX"],[3,7,"SUBA"],[3,7,"CMPA"],[3,7,"SBCA"],[3,7,"SUBD"],[3,7,"ANDA"],[3,7,"BITA"],[3,7,"LDA"],[3,7,"STA"],[3,7,"EORA"],[3,7,"ADCA"],[3,7,"ORA"],[3,7,"ADDA"],[3,7,"CMPX"],[3,7,"JSR"],[3,7,"LDX"],[3,7,"STX"],[2,4,"SUBB"],[2,4,"CMPB"],[2,4,"SBCB"],[3,8,"ADDD"],[2,4,"ANDB"],[2,4,"BITB"],[2,4,"LDB"],[1,0,"???"],[2,4,"EORB"],[2,4,"ADCB"],[2,4,"ORB"],[2,4,"ADDB"],[3,8,"LDD"],[1,0,"???"],[3,8,"LDU"],[1,0,"???"],[2,1,"SUBB"],[2,1,"CMPB"],[2,1,"SBCB"],[2,1,"ADDD"],[2,1,"ANDB"],[2,1,"BITB"],[2,1,"LDB"],[2,1,"STB"],[2,1,"EORB"],[2,1,"ADCB"],[2,1,"ORB "],[2,1,"ADDB"],[2,1,"LDD "],[2,1,"STD "],[2,1,"LDU "],[2,1,"STU "],[2,6,"SUBB"],[2,6,"CMPB"],[2,6,"SBCB"],[2,6,"ADDD"],[2,6,"ANDB"],[2,6,"BITB"],[2,6,"LDB"],[2,6,"STB"],[2,6,"EORB"],[2,6,"ADCB"],[2,6,"ORB"],[2,6,"ADDB"],[2,6,"LDD"],[2,6,"STD"],[2,6,"LDU"],[2,6,"STU"],[3,7,"SUBB"],[3,7,"CMPB"],[3,7,"SBCB"],[3,7,"ADDD"],[3,7,"ANDB"],[3,7,"BITB"],[3,7,"LDB"],[3,7,"STB"],[3,7,"EORB"],[3,7,"ADCB"],[3,7,"ORB"],[3,7,"ADDB"],[3,7,"LDD"],[3,7,"STD"],[3,7,"LDU"],[3,7,"STU"]],S={63:[2,2,"SWI3"],131:[4,8,"CMPU"],140:[4,8,"CMPS"],147:[3,1,"CMPU"],156:[3,1,"CMPS"],163:[3,6,"CMPU"],172:[3,6,"CMPS"],179:[4,7,"CMPU"],188:[4,7,"CMPS"]},y={33:[5,3,"LBRN"],34:[5,3,"LBHI"],35:[5,3,"LBLS"],36:[5,3,"LBCC"],37:[5,3,"LBCS"],38:[5,3,"LBNE"],39:[5,3,"LBEQ"],40:[5,3,"LBVC"],41:[5,3,"LBVS"],42:[5,3,"LBPL"],43:[5,3,"LBMI"],44:[5,3,"LBGE"],45:[5,3,"LBLT"],46:[5,3,"LBGT"],47:[5,3,"LBLE"],63:[2,2,"SWI2"],131:[4,8,"CMPD"],140:[4,8,"CMPY"],142:[4,8,"LDY"],147:[3,1,"CMPD"],156:[3,1,"CMPY"],158:[3,1,"LDY"],159:[3,1,"STY"],163:[3,6,"CMPD"],172:[3,6,"CMPY"],174:[3,6,"LDY"],175:[3,6,"STY"],179:[4,7,"CMPD"],188:[4,7,"CMPY"],190:[4,7,"LDY"],191:[4,7,"STY"],206:[4,8,"LDS"],222:[3,1,"LDS"],223:[3,1,"STS"],238:[3,6,"LDS"],239:[3,6,"STS"],254:[4,7,"LDS"],255:[4,7,"STS"]},B=function(o,n,g,s,t,b){var P=function(b0,G0){for(var D0=b0.toString(16);D0.length<G0;)D0="0"+D0;return D0.toUpperCase()},Le=function(b0){return P(b0&255,2)},Je=function(b0){return P(b0,4)},Oe,a0,qe,n0=t0[o];if(o===16){if(n0=y[n],n0===void 0)return["???",2];o=n,n=g,g=s,s=t}if(o===17){if(n0=S[n],n0===void 0)return["???",2];o=n,n=g,g=s,s=t}var $e=n0[0],$0=n0[1],J=n0[2];switch($0){case 0:break;case 1:J+="	$"+Le(n);break;case 2:break;case 3:J+="	#$"+Je(n*256+g<32768?n*256+g+b:n*256+g+b-65536);break;case 4:J+="	#$"+Le(n);break;case 5:J+="	#$"+Je(n<128?n+b+2:n+b-254);break;case 6:J+="	";var m0=n,Te=["X","Y","U","S"][(m0&96)>>5];if(!(m0&128)){var _0=m0&31;_0>15&&(_0=_0-32),J+=_0+","+Te;break}var J0=m0&16,w0=m0&15,P0=g>127?g-256:g,k0=g*256+s>32767?g*256+s-65536:g*256+s;if(J0)switch(w0){case 0:J+="???";break;case 1:J+="[,"+Te+"++]";break;case 2:J+="???";break;case 3:J+="[,--"+Te+"]";break;case 4:J+="[,"+Te+"]";break;case 5:J+="[B,"+Te+"]";break;case 6:J+="[A,"+Te+"]";break;case 7:J+="???";break;case 8:J+="["+P0+","+Te+"]",$e++;break;case 9:J+="["+k0+","+Te+"]",$e+=2;break;case 10:J+="???";break;case 11:J+="[D,"+Te+"]";break;case 12:J+="["+P0+",PC]",$e++;break;case 13:J+="["+k0+",PC]",$e+=2;break;case 14:J+="???";break;case 15:J+="[$"+Je(g*256+s)+"]",$e+=2;break}else switch(w0){case 0:J+=","+Te+"+";break;case 1:J+=","+Te+"++";break;case 2:J+=",-"+Te;break;case 3:J+=",--"+Te;break;case 4:J+=","+Te;break;case 5:J+="B,"+Te;break;case 6:J+="A,"+Te;break;case 7:J+="???";break;case 8:J+=P0+","+Te,$e++;break;case 9:J+=k0+","+Te,$e+=2;break;case 10:J+="???";break;case 11:J+="D,"+Te;break;case 12:J+=P0+",PC",$e++;break;case 13:J+=k0+",PC",$e+=2;break;case 14:J+="???";break;case 15:J+="$"+Je(g*256+s),$e+=2;break}break;case 7:J+="	$"+Je(n*256+g);break;case 8:J+="	#$"+Je(n*256+g);break;case 10:for(Oe=["PC","U","Y","X","DP","B","A","CC"],a0=[],qe=0;qe<8;qe++)(n&1)!=0&&a0.push(Oe[7-qe]),n>>=1;J+="	"+a0.join(",");break;case 11:for(Oe=["PC","S","Y","X","DP","B","A","CC"],a0=[],qe=0;qe<8;qe++)(n&1)!=0&&a0.push(Oe[7-qe]),n>>=1;J+="	"+a0.join(",");break;case 20:Oe=["D","X","Y","U","S","PC","?","?","A","B","CC","DP","?","?","?","?"],J+="	"+Oe[n>>4]+","+Oe[n&15];break}return{line:J,nbytes:$e}};return{steps:function(o){for(;o>0;)o-=je()},runFrame:function(o){for(;W<o;)je()},advanceInsn:function(){return je()},T:function(){return W},getTstates:function(){return W},setTstates:function(o){W=o},reset:Qe,init:function(o,n,g){_=o,C=n,h=g,Qe()},getPC:function(){return u},getSP:function(){return d},saveState:function(){return{PC:u,SP:d,U:x,A:e,B:r,X:f,Y:l,DP:V,CC:a,T:W}},loadState:function(o){u=o.PC,d=o.SP,x=o.U,e=o.A,r=o.B,f=o.X,l=o.Y,V=o.DP,a=o.CC,W=o.T},firq:function(){a&A||(O(u),a&=~R,ue(a),a|=G|A,u=F(c),W+=9)},interrupt:function(){a&G||(O(u),O(x),O(l),O(f),ue(V),ue(r),ue(e),a|=R,ue(a),a|=G,u=F(i),W+=18)},nmi:function(){O(u),O(x),O(l),O(f),ue(V),ue(r),ue(e),a|=R,ue(a),a|=G|A,u=F(U),W+=18},set:function(o,n){switch(o.toUpperCase()){case"PC":u=n;return;case"A":e=n;return;case"B":r=n;return;case"X":f=n;return;case"Y":l=n;return;case"SP":d=n;return;case"U":x=n;return;case"FLAGS":a=n;return}},flagsToString:function(){for(var o="",n="EFHINZVC",g=0;g<8;g++){var s=a&128>>g;s===0?o+=n[g].toLowerCase():o+=n[g]}return o},disasm:B,isStable:function(){return!0}}}var xt=function(){var h=this;this.powerOn=function(){this.reset()},this.powerOff=function(){},this.clockPulse=function(){!r||(G++,A[G]())},this.connectBus=function(m){e=m},this.setRDY=function(m){r=m},this.isRDY=function(){return r},this.reset=function(){p=1,G=-1,A=[K],f=e.read(W)|e.read(W+1)<<8,this.setRDY(!0)};var e,r=!1,f=0,l=0,x=0,d=0,u=0,a=0,V=0,L=0,p=0,I=0,k=0,G=-1,oe=-1,A,R=0,E=0,U=0,z=!1,i=0,c=0,ge=0;let Fe=65530,W=65532,Be=65534,_=0,C=1,Ze=7,te=6,q=1,We=0;this.debug=!1,this.trace=!1;var K=function(){oe=e.read(f),A=t[oe],G=0,f++},H=K,Ae=function(){e.read(f)},ue=function(){c=e.read(f),f++},O=function(){E=e.read(f),f++},Xe=function(){E|=e.read(f)<<8,f++},Ve=function(){E=e.read(U)},Ue=function(){E|=e.read(U)<<8},De=function(){U=e.read(f),f++},Q=function(){U|=e.read(f)<<8,f++},me=function(){U=e.read(i)},we=function(){U|=e.read(i)<<8},be=function(){var m=(U&255)+d;z=m>255,U=U&65280|m&255},ye=function(){var m=(U&255)+u;z=m>255,U=U&65280|m&255},ze=function(){var m=(U&255)+1;z=m>255,U=U&65280|m&255},Ne=function(){z&&(U=U+256&65535)},He=function(){i=e.read(f),f++},pe=function(){i|=e.read(f)<<8,f++},ce=function(){var m=(i&255)+1;i=i&65280|m&255},ie=function(){R=e.read(f),f++},M=function(){R=e.read(E)},D=function(){R=e.read(U)},F=function(){e.write(E,R)},fe=function(){e.write(U,R)},T=function(){var m=f&255,v=m+c&255;c>127?ge=v>m?-256:0:ge=v<m?256:0,f=f&65280|v},ne=function(){f=f+ge&65535},w=function(m){I=m===0?1:0},N=function(m){a=m&128?1:0},_e=function(m){V=m?1:0},Y=function(m){k=m?1:0},re=function(){return l=l+1&255,e.read(256+l)},ve=function(){return e.read(256+l)},$=function(m){e.write(256+l,m),l=l-1&255},le=function(){return a<<7|V<<6|48|L<<3|p<<2|I<<1|k},Ie=function(m){a=m>>>7,V=m>>>6&1,L=m>>>3&1,p=m>>>2&1,I=m>>>1&1,k=m&1},Z=function(m){h.debug&&h.breakpoint("Illegal Opcode: "+m)},ee=function(m){return[K,Ae,function(){m(),H()}]},se=function(m){return[K,ie,function(){m(),H()}]},Pe=function(m){return[K,O,M,function(){m(),H()}]},Re=function(m){return[K,O,Xe,M,function(){m(),H()}]},Ye=function(m){return[K,De,D,function(){be(),Ve()},function(){ze(),Ue()},M,function(){m(),H()}]},xe=function(m){var v=m===_?be:ye;return function(j){return[K,De,Q,function(){v(),D(),Ne()},function(){z?D():(j(),H())},function(){j(),H()}]}},de=function(m){var v=m===_?be:ye;return function(j){return[K,De,D,function(){v(),D()},function(){j(),H()}]}},Me=function(m){return[K,He,me,function(){ce(),we()},function(){ye(),D(),Ne()},function(){z?D():(m(),H())},function(){m(),H()}]},ke=function(m){return[K,O,function(){m(),F()},H]},Ke=function(m){return[K,O,Xe,function(){m(),F()},H]},X=function(m){return[K,De,D,function(){be(),Ve()},function(){ze(),Ue()},function(){m(),F()},H]},je=function(m){var v=m===_?be:ye;return function(j){return[K,De,Q,function(){v(),D(),Ne()},function(){j(),fe()},H]}},Qe=function(m){var v=m===_?be:ye;return function(j){return[K,De,D,function(){v(),j(),fe()},H]}},t0=function(m){return[K,He,me,function(){ce(),we()},function(){ye(),D(),Ne()},function(){m(),fe()},H]},S=function(m){return[K,O,M,F,function(){m(),F()},H]},y=function(m){return[K,O,Xe,M,F,function(){m(),F()},H]},B=function(m){var v=m===_?be:ye;return function(j){return[K,De,D,function(){v(),D()},fe,function(){j(),fe()},H]}},o=function(m){var v=m===_?be:ye;return function(j){return[K,De,Q,function(){v(),D(),Ne()},D,fe,function(){j(),fe()},H]}},n=function(m){return[K,De,D,function(){be(),Ve()},function(){ze(),Ue()},M,F,function(){m(),F()},H]},g=function(m){return[K,He,me,function(){ce(),we()},function(){ye(),D(),Ne()},D,fe,function(){m(),fe()},H]},s=new Array(256),t=new Array(256);s[0]="BRK",t[0]=qt(),s[1]="ORA",t[1]=u0(Ye),s[2]="uKIL",t[2]=Ge(),s[3]="uSLO",t[3]=C0(n),s[4]="uNOP",t[4]=Ce(Pe),s[5]="ORA",t[5]=u0(Pe),s[6]="ASL",t[6]=M0(S),s[7]="uSLO",t[7]=C0(S),s[8]="PHP",t[8]=$t(),s[9]="ORA",t[9]=u0(se),s[10]="ASL",t[10]=b(),s[11]="uANC",t[11]=lt(se),s[12]="uNOP",t[12]=Ce(Re),s[13]="ORA",t[13]=u0(Re),s[14]="ASL",t[14]=M0(y),s[15]="uSLO",t[15]=C0(y),s[16]="BPL",t[16]=o0(Ze,0),s[17]="ORA",t[17]=u0(Me),s[18]="uKIL",t[18]=Ge(),s[19]="uSLO",t[19]=C0(g),s[20]="uNOP",t[20]=Ce(de(_)),s[21]="ORA",t[21]=u0(de(_)),s[22]="ASL",t[22]=M0(B(_)),s[23]="uSLO",t[23]=C0(B(_)),s[24]="CLC",t[24]=P(),s[25]="ORA",t[25]=u0(xe(C)),s[26]="uNOP",t[26]=Ce(ee),s[27]="uSLO",t[27]=C0(o(C)),s[28]="uNOP",t[28]=Ce(xe(_)),s[29]="ORA",t[29]=u0(xe(_)),s[30]="ASL",t[30]=M0(o(_)),s[31]="uSLO",t[31]=C0(o(_)),s[32]="JSR",t[32]=Qt(),s[33]="AND",t[33]=f0(Ye),s[34]="uKIL",t[34]=Ge(),s[35]="uRLA",t[35]=v0(n),s[36]="BIT",t[36]=ot(Pe),s[37]="AND",t[37]=f0(Pe),s[38]="ROL",t[38]=H0(S),s[39]="uRLA",t[39]=v0(S),s[40]="PLP",t[40]=Gt(),s[41]="AND",t[41]=f0(se),s[42]="ROL",t[42]=m0(),s[43]="uANC",t[43]=lt(se),s[44]="BIT",t[44]=ot(Re),s[45]="AND",t[45]=f0(Re),s[46]="ROL",t[46]=H0(y),s[47]="uRLA",t[47]=v0(y),s[48]="BMI",t[48]=o0(Ze,1),s[49]="AND",t[49]=f0(Me),s[50]="uKIL",t[50]=Ge(),s[51]="uRLA",t[51]=v0(g),s[52]="uNOP",t[52]=Ce(de(_)),s[53]="AND",t[53]=f0(de(_)),s[54]="ROL",t[54]=H0(B(_)),s[55]="uRLA",t[55]=v0(B(_)),s[56]="SEC",t[56]=_0(),s[57]="AND",t[57]=f0(xe(C)),s[58]="uNOP",t[58]=Ce(ee),s[59]="uRLA",t[59]=v0(o(C)),s[60]="uNOP",t[60]=Ce(xe(_)),s[61]="AND",t[61]=f0(xe(_)),s[62]="ROL",t[62]=H0(o(_)),s[63]="uRLA",t[63]=v0(o(_)),s[64]="RTI",t[64]=nn(),s[65]="EOR",t[65]=s0(Ye),s[66]="uKIL",t[66]=Ge(),s[67]="uSRE",t[67]=g0(n),s[68]="uNOP",t[68]=Ce(Pe),s[69]="EOR",t[69]=s0(Pe),s[70]="LSR",t[70]=U0(S),s[71]="uSRE",t[71]=g0(S),s[72]="PHA",t[72]=jt(),s[73]="EOR",t[73]=s0(se),s[74]="LSR",t[74]=$0(),s[75]="uASR",t[75]=Xt(se),s[76]="JMP",t[76]=an(),s[77]="EOR",t[77]=s0(Re),s[78]="LSR",t[78]=U0(y),s[79]="uSRE",t[79]=g0(y),s[80]="BVC",t[80]=o0(te,0),s[81]="EOR",t[81]=s0(Me),s[82]="uKIL",t[82]=Ge(),s[83]="uSRE",t[83]=g0(g),s[84]="uNOP",t[84]=Ce(de(_)),s[85]="EOR",t[85]=s0(de(_)),s[86]="LSR",t[86]=U0(B(_)),s[87]="uSRE",t[87]=g0(B(_)),s[88]="CLI",t[88]=Je(),s[89]="EOR",t[89]=s0(xe(C)),s[90]="uNOP",t[90]=Ce(ee),s[91]="uSRE",t[91]=g0(o(C)),s[92]="uNOP",t[92]=Ce(xe(_)),s[93]="EOR",t[93]=s0(xe(_)),s[94]="LSR",t[94]=U0(o(_)),s[95]="uSRE",t[95]=g0(o(_)),s[96]="RTS",t[96]=rn(),s[97]="ADC",t[97]=i0(Ye),s[98]="uKIL",t[98]=Ge(),s[99]="uRRA",t[99]=S0(n),s[100]="uNOP",t[100]=Ce(Pe),s[101]="ADC",t[101]=i0(Pe),s[102]="ROR",t[102]=X0(S),s[103]="uRRA",t[103]=S0(S),s[104]="PLA",t[104]=Jt(),s[105]="ADC",t[105]=i0(se),s[106]="ROR",t[106]=Te(),s[107]="uARR",t[107]=Ht(se),s[108]="JMP",t[108]=fn(),s[109]="ADC",t[109]=i0(Re),s[110]="ROR",t[110]=X0(y),s[111]="uRRA",t[111]=S0(y),s[112]="BVS",t[112]=o0(te,1),s[113]="ADC",t[113]=i0(Me),s[114]="uKIL",t[114]=Ge(),s[115]="uRRA",t[115]=S0(g),s[116]="uNOP",t[116]=Ce(de(_)),s[117]="ADC",t[117]=i0(de(_)),s[118]="ROR",t[118]=X0(B(_)),s[119]="uRRA",t[119]=S0(B(_)),s[120]="SEI",t[120]=w0(),s[121]="ADC",t[121]=i0(xe(C)),s[122]="uNOP",t[122]=Ce(ee),s[123]="uRRA",t[123]=S0(o(C)),s[124]="uNOP",t[124]=Ce(xe(_)),s[125]="ADC",t[125]=i0(xe(_)),s[126]="ROR",t[126]=X0(o(_)),s[127]="uRRA",t[127]=S0(o(_)),s[128]="uNOP",t[128]=Ce(se),s[129]="STA",t[129]=d0(X),s[130]="uNOP",t[130]=Ce(se),s[131]="uSAX",t[131]=N0(X),s[132]="STY",t[132]=tt(ke),s[133]="STA",t[133]=d0(ke),s[134]="STX",t[134]=et(ke),s[135]="uSAX",t[135]=N0(ke),s[136]="DEY",t[136]=qe(),s[137]="uNOP",t[137]=Ce(se),s[138]="TXA",t[138]=G0(),s[139]="uANE",t[139]=Ut(se),s[140]="STY",t[140]=tt(Ke),s[141]="STA",t[141]=d0(Ke),s[142]="STX",t[142]=et(Ke),s[143]="uSAX",t[143]=N0(Ke),s[144]="BCC",t[144]=o0(We,0),s[145]="STA",t[145]=d0(t0),s[146]="uKIL",t[146]=Ge(),s[147]="uSHA",t[147]=mt(t0),s[148]="STY",t[148]=tt(Qe(_)),s[149]="STA",t[149]=d0(Qe(_)),s[150]="STX",t[150]=et(Qe(C)),s[151]="uSAX",t[151]=N0(Qe(C)),s[152]="TYA",t[152]=Ft(),s[153]="STA",t[153]=d0(je(C)),s[154]="TXS",t[154]=D0(),s[155]="uSHS",t[155]=Vt(je(C)),s[156]="uSHY",t[156]=Kt(je(_)),s[157]="STA",t[157]=d0(je(_)),s[158]="uSHX",t[158]=zt(je(C)),s[159]="uSHA",t[159]=mt(je(C)),s[160]="LDY",t[160]=I0(se),s[161]="LDA",t[161]=x0(Ye),s[162]="LDX",t[162]=y0(se),s[163]="uLAX",t[163]=B0(Ye),s[164]="LDY",t[164]=I0(Pe),s[165]="LDA",t[165]=x0(Pe),s[166]="LDX",t[166]=y0(Pe),s[167]="uLAX",t[167]=B0(Pe),s[168]="TAY",t[168]=k0(),s[169]="LDA",t[169]=x0(se),s[170]="TAX",t[170]=P0(),s[171]="uLXA",t[171]=Wt(se),s[172]="LDY",t[172]=I0(Re),s[173]="LDA",t[173]=x0(Re),s[174]="LDX",t[174]=y0(Re),s[175]="uLAX",t[175]=B0(Re),s[176]="BCS",t[176]=o0(We,1),s[177]="LDA",t[177]=x0(Me),s[178]="uKIL",t[178]=Ge(),s[179]="uLAX",t[179]=B0(Me),s[180]="LDY",t[180]=I0(de(_)),s[181]="LDA",t[181]=x0(de(_)),s[182]="LDX",t[182]=y0(de(C)),s[183]="uLAX",t[183]=B0(de(C)),s[184]="CLV",t[184]=Oe(),s[185]="LDA",t[185]=x0(xe(C)),s[186]="TSX",t[186]=b0(),s[187]="uLAS",t[187]=Yt(xe(C)),s[188]="LDY",t[188]=I0(xe(_)),s[189]="LDA",t[189]=x0(xe(_)),s[190]="LDX",t[190]=y0(xe(C)),s[191]="uLAX",t[191]=B0(xe(C)),s[192]="CPY",t[192]=q0(se),s[193]="CMP",t[193]=c0(Ye),s[194]="uNOP",t[194]=Ce(se),s[195]="uDCP",t[195]=h0(n),s[196]="CPY",t[196]=q0(Pe),s[197]="CMP",t[197]=c0(Pe),s[198]="DEC",t[198]=T0(S),s[199]="uDCP",t[199]=h0(S),s[200]="INY",t[200]=$e(),s[201]="CMP",t[201]=c0(se),s[202]="DEX",t[202]=a0(),s[203]="uSBX",t[203]=Zt(se),s[204]="CPY",t[204]=q0(Re),s[205]="CMP",t[205]=c0(Re),s[206]="DEC",t[206]=T0(y),s[207]="uDCP",t[207]=h0(y),s[208]="BNE",t[208]=o0(q,0),s[209]="CMP",t[209]=c0(Me),s[210]="uKIL",t[210]=Ge(),s[211]="uDCP",t[211]=h0(g),s[212]="uNOP",t[212]=Ce(de(_)),s[213]="CMP",t[213]=c0(de(_)),s[214]="DEC",t[214]=T0(B(_)),s[215]="uDCP",t[215]=h0(B(_)),s[216]="CLD",t[216]=Le(),s[217]="CMP",t[217]=c0(xe(C)),s[218]="uNOP",t[218]=Ce(ee),s[219]="uDCP",t[219]=h0(o(C)),s[220]="uNOP",t[220]=Ce(xe(_)),s[221]="CMP",t[221]=c0(xe(_)),s[222]="DEC",t[222]=T0(o(_)),s[223]="uDCP",t[223]=h0(o(_)),s[224]="CPX",t[224]=Q0(se),s[225]="SBC",t[225]=r0(Ye),s[226]="uNOP",t[226]=Ce(se),s[227]="uISB",t[227]=A0(n),s[228]="CPX",t[228]=Q0(Pe),s[229]="SBC",t[229]=r0(Pe),s[230]="INC",t[230]=F0(S),s[231]="uISB",t[231]=A0(S),s[232]="INX",t[232]=n0(),s[233]="SBC",t[233]=r0(se),s[234]="NOP",t[234]=J(),s[235]="SBC",t[235]=r0(se),s[236]="CPX",t[236]=Q0(Re),s[237]="SBC",t[237]=r0(Re),s[238]="INC",t[238]=F0(y),s[239]="uISB",t[239]=A0(y),s[240]="BEQ",t[240]=o0(q,1),s[241]="SBC",t[241]=r0(Me),s[242]="uKIL",t[242]=Ge(),s[243]="uISB",t[243]=A0(g),s[244]="uNOP",t[244]=Ce(de(_)),s[245]="SBC",t[245]=r0(de(_)),s[246]="INC",t[246]=F0(B(_)),s[247]="uISB",t[247]=A0(B(_)),s[248]="SED",t[248]=J0(),s[249]="SBC",t[249]=r0(xe(C)),s[250]="uNOP",t[250]=Ce(ee),s[251]="uISB",t[251]=A0(o(C)),s[252]="uNOP",t[252]=Ce(xe(_)),s[253]="SBC",t[253]=r0(xe(_)),s[254]="INC",t[254]=F0(o(_)),s[255]="uISB",t[255]=A0(o(_));function b(){return ee(function(){Y(x>127),x=x<<1&255,w(x),N(x)})}function P(){return ee(function(){k=0})}function Le(){return ee(function(){L=0})}function Je(){return ee(function(){p=0})}function Oe(){return ee(function(){V=0})}function a0(){return ee(function(){d=d-1&255,w(d),N(d)})}function qe(){return ee(function(){u=u-1&255,w(u),N(u)})}function n0(){return ee(function(){d=d+1&255,w(d),N(d)})}function $e(){return ee(function(){u=u+1&255,w(u),N(u)})}function $0(){return ee(function(){k=x&1,x>>>=1,w(x),a=0})}function J(){return ee(function(){})}function m0(){return ee(function(){var m=x>127;x=(x<<1|k)&255,Y(m),w(x),N(x)})}function Te(){return ee(function(){var m=x&1;x=x>>>1|k<<7,Y(m),w(x),N(x)})}function _0(){return ee(function(){k=1})}function J0(){return ee(function(){L=1})}function w0(){return ee(function(){p=1})}function P0(){return ee(function(){d=x,w(d),N(d)})}function k0(){return ee(function(){u=x,w(u),N(u)})}function b0(){return ee(function(){d=l,w(d),N(d)})}function G0(){return ee(function(){x=d,w(x),N(x)})}function D0(){return ee(function(){l=d})}function Ft(){return ee(function(){x=u,w(x),N(x)})}function Ge(){return[K,function(){Z("KIL/HLT/JAM")},function(){G--}]}function Ce(m){return m(function(){Z("NOP/DOP")})}function i0(m){return m(function(){if(L){var v=R,j=(x&15)+(v&15)+k;j>9&&(j+=6);var Se=(x>>4)+(v>>4)+(j>15?1:0)<<4;w(x+v+k&255),N(Se),_e((x^Se)&~(x^v)&128),Se>159&&(Se+=96),Y(Se>255),x=(Se|j&15)&255}else{var he=x+R+k;Y(he>255),_e((x^he)&(R^he)&128),x=he&255,w(x),N(x)}})}function f0(m){return m(function(){x&=R,w(x),N(x)})}function ot(m){return m(function(){var v=R;w(x&v),_e(v&64),N(v)})}function c0(m){return m(function(){var v=x-R&255;Y(x>=R),w(v),N(v)})}function Q0(m){return m(function(){var v=d-R&255;Y(d>=R),w(v),N(v)})}function q0(m){return m(function(){var v=u-R&255;Y(u>=R),w(v),N(v)})}function s0(m){return m(function(){x^=R,w(x),N(x)})}function x0(m){return m(function(){x=R,w(x),N(x)})}function y0(m){return m(function(){d=R,w(d),N(d)})}function I0(m){return m(function(){u=R,w(u),N(u)})}function u0(m){return m(function(){x|=R,w(x),N(x)})}function r0(m){return m(function(){if(L){var v=R,j=(x&15)-(v&15)-(1-k),Se=(x>>4)-(v>>4)-(j<0?1:0);j<0&&(j-=6),Se<0&&(Se-=6);var he=x-v-(1-k);Y(~he&256),_e((x^v)&(x^he)&128),w(he&255),N(he),x=(Se<<4|j&15)&255}else v=~R&255,he=x+v+k,Y(he>255),_e((x^he)&(v^he)&128),x=he&255,w(x),N(x)})}function lt(m){return m(function(){Z("ANC"),x&=R,w(x),a=k=x&128?1:0})}function Ut(m){return m(function(){Z("ANE")})}function Ht(m){return m(function(){Z("ARR");var v=x&R,j=k?128:0;v=v>>>1|j,x=v,w(v),N(v);var Se=x&96;Se==96?(k=1,V=0):Se==0?(k=0,V=0):Se==32?(k=0,V=1):Se==64&&(k=1,V=1)})}function Xt(m){return m(function(){Z("ASR");var v=x&R;k=v&1,v=v>>>1,x=v,w(v),a=0})}function Yt(m){return m(function(){Z("LAS");var v=l&R;x=v,d=v,l=v,w(v),N(v)})}function B0(m){return m(function(){Z("LAX");var v=R;x=v,d=v,w(v),N(v)})}function Wt(m){return m(function(){Z("LXA");var v=x&R;x=v,d=v,w(v),N(v)})}function Zt(m){return m(function(){Z("SBX");var v=x&d,j=R,Se=v-j&255;d=Se,Y(v>=j),w(Se),N(Se)})}function d0(m){return m(function(){R=x})}function et(m){return m(function(){R=d})}function tt(m){return m(function(){R=u})}function N0(m){return m(function(){Z("SAX"),R=x&d})}function mt(m){return m(function(){Z("SHA"),R=x&d&(U>>>8)+1&255})}function Vt(m){return m(function(){Z("SHS");var v=x&d;l=v,R=v&(U>>>8)+1&255})}function zt(m){return m(function(){Z("SHX"),R=d&(U>>>8)+1&255})}function Kt(m){return m(function(){Z("SHY"),R=u&(U>>>8)+1&255})}function M0(m){return m(function(){Y(R>127);var v=R<<1&255;R=v,w(v),N(v)})}function T0(m){return m(function(){var v=R-1&255;R=v,w(v),N(v)})}function F0(m){return m(function(){var v=R+1&255;R=v,w(v),N(v)})}function U0(m){return m(function(){k=R&1,R>>>=1,w(R),a=0})}function H0(m){return m(function(){var v=R>127,j=(R<<1|k)&255;R=j,Y(v),w(j),N(j)})}function X0(m){return m(function(){var v=R&1,j=R>>>1|k<<7;R=j,Y(v),w(j),N(j)})}function h0(m){return m(function(){Z("DCP");var v=R-1&255;R=v,v=x-v,Y(v>=0),w(v),N(v)})}function A0(m){return m(function(){if(Z("ISB"),R=R+1&255,L){var v=R,j=(x&15)-(v&15)-(1-k),Se=(x>>4)-(v>>4)-(j<0?1:0);j<0&&(j-=6),Se<0&&(Se-=6);var he=x-v-(1-k);Y(~he&256),_e((x^v)&(x^he)&128),w(he&255),N(he),x=(Se<<4|j&15)&255}else v=~R&255,he=x+v+k,Y(he>255),_e((x^he)&(v^he)&128),x=he&255,w(x),N(x)})}function v0(m){return m(function(){Z("RLA");var v=R,j=k;Y(v&128),v=(v<<1|j)&255,R=v,x&=v,w(v),N(v)})}function S0(m){return m(function(){Z("RRA");var v=R,j=k?128:0;if(Y(v&1),v=v>>>1|j,R=v,L){var Se=R,he=(x&15)+(Se&15)+k;he>9&&(he+=6);var R0=(x>>4)+(Se>>4)+(he>15?1:0)<<4;w(x+Se+k&255),N(R0),_e((x^R0)&~(x^Se)&128),R0>159&&(R0+=96),Y(R0>255),x=(R0|he&15)&255}else{var Y0=x+R+k;Y(Y0>255),_e((x^Y0)&(R^Y0)&128),x=Y0&255,w(x),N(x)}})}function C0(m){return m(function(){Z("SLO");var v=R;Y(v&128),v=v<<1&255,R=v,v=x|v,x=v,w(v),N(v)})}function g0(m){return m(function(){Z("SRE");var v=R;Y(v&1),v=v>>>1,R=v,v=(x^v)&255,x=v,w(v),N(v)})}function jt(){return[K,Ae,function(){$(x)},H]}function $t(){return[K,Ae,function(){$(le())},H]}function Jt(){return[K,Ae,ve,function(){x=re(),w(x),N(x)},H]}function Gt(){return[K,Ae,ve,function(){Ie(re())},H]}function Qt(){return[K,O,ve,function(){$(f>>>8&255)},function(){$(f&255)},Xe,function(){f=E,H()}]}function qt(){return[K,ie,function(){h.debug&&h.breakpoint("BRK "+R),$(f>>>8&255)},function(){$(f&255)},function(){$(le())},function(){E=e.read(Be)},function(){E|=e.read(Be+1)<<8},function(){f=E,p=1,H()}]}function en(){return[K,ie,function(){h.debug&&h.breakpoint("IRQ "+R),$(f>>>8&255)},function(){$(f&255)},function(){$(le()&~16)},function(){E=e.read(Be)},function(){E|=e.read(Be+1)<<8},function(){f=E,H()}]}function tn(){return[K,ie,function(){h.debug&&h.breakpoint("NMI "+R),$(f>>>8&255)},function(){$(f&255)},function(){$(le()&~16)},function(){E=e.read(Fe)},function(){E|=e.read(Fe+1)<<8},function(){f=E,H()}]}function nn(){return[K,Ae,ve,function(){Ie(re())},function(){E=re()},function(){E|=re()<<8},function(){f=E,H()}]}function rn(){return[K,Ae,ve,function(){E=re()},function(){E|=re()<<8},function(){f=E,ie()},H]}function an(){return[K,O,Xe,function(){f=E,H()}]}function fn(){return[K,He,pe,me,function(){ce(),we()},function(){f=U,H()}]}function o0(m,v){var j;return m===q?j=function(){return I===v}:m===Ze?j=function(){return a===v}:m===We?j=function(){return k===v}:j=function(){return V===v},[K,ue,function(){j()?(Ae(),T()):H()},function(){ge?(Ae(),ne()):H()},H]}this.saveState=function(){return{PC:f-1&65535,A:x,X:d,Y:u,SP:l,N:a,V,D:L,I:p,Z:I,C:k,T:G,o:oe,R:r?1:0,d:R,AD:E,BA:U,BC:z?1:0,IA:i,bo:c,boa:ge}},this.loadState=function(m){f=m.PC+1&65535,x=m.A,d=m.X,u=m.Y,l=m.SP,a=m.N,V=m.V,L=m.D,p=m.I,I=m.Z,k=m.C,G=m.T,oe=m.o,r=!!m.R,R=m.d,E=m.AD,U=m.BA,z=!!m.BC,i=m.IA,c=m.bo,ge=m.boa,A=oe<0?[K]:t[oe]},this.toString=function(){return"CPU  PC: "+f.toString(16)+"  op: "+oe.toString()+"  T: "+G+"  data: "+R+`
 A: `+x.toString(16)+"  X: "+d.toString(16)+"  Y: "+u.toString(16)+"  SP: "+l.toString(16)+"     N"+a+"  V"+V+"  D"+L+"  I"+p+"  Z"+I+"  C"+k+"  "},this.breakpoint=function(m){if(this.trace)var v="CPU Breakpoint!  "+(m?"("+m+")":"")+`

`+this.toString()};var bt=[7,6,0,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,0,6,0,6,3,3,3,3,2,0,2,0,4,4,4,4,2,6,0,0,4,4,4,4,2,5,2,0,0,5,0,0,2,6,2,6,3,3,3,3,2,2,2,0,4,4,4,4,2,5,0,5,4,4,4,4,2,4,2,0,4,4,4,4,2,6,0,8,3,3,5,5,2,2,2,2,4,4,3,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,2,6,0,8,3,3,5,5,2,2,2,0,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7],cn=[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1],sn=[1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,3,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,0,2,0,2,2,2,2,2,1,0,1,0,3,3,3,3,2,2,0,0,2,2,2,3,1,3,1,0,0,3,0,0,2,2,2,2,2,2,2,2,1,2,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,3,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,2,2,0,2,2,2,2,2,1,2,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3],wn=[1,2,0,0,0,2,2,0,1,2,1,0,0,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,3,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,1,2,0,0,0,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,1,2,0,0,0,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,0,2,0,0,2,2,2,0,1,0,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,3,1,0,0,3,0,0,2,2,2,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,3,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,2,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0];this.getOpcodeMetadata=function(m,v){return{opcode:m,mnenomic:s[m],minCycles:bt[m],maxCycles:bt[m]+cn[m],insnlength:sn[m]}},this.setNMI=function(){A=tn(),G=1,f=f-1&65535},this.setIRQ=function(){p||(A=en(),G=1,f=f-1&65535)},this.getSP=function(){return l},this.getPC=function(){return f-1&65535},this.getT=function(){return G},this.isHalted=function(){return s[oe]=="uKIL"},this.isPCStable=function(){return G==0}},l0;(function(f){f[f.None=0]="None",f[f.NMI=1]="NMI",f[f.IRQ=2]="IRQ"})(l0||(l0={}));var vn=class{constructor(){this.cpu=new xt;this.interruptType=0}connectMemoryBus(e){this.cpu.connectBus(e)}advanceClock(){if(this.interruptType&&this.isStable()){switch(this.interruptType){case 1:this.cpu.setNMI();break;case 2:this.cpu.setIRQ();break}this.interruptType=0}this.cpu.clockPulse()}advanceInsn(){do this.advanceClock();while(!this.isStable())}reset(){this.cpu.reset(),this.interruptType=0}interrupt(e){this.interruptType!=1&&(this.interruptType=e)}NMI(){this.interrupt(1)}IRQ(){this.interrupt(2)}getSP(){return this.cpu.getSP()}getPC(){return this.cpu.getPC()}isHalted(){return this.cpu.isHalted()}saveState(){var e=this.cpu.saveState();return e.it=this.interruptType,e}loadState(e){this.cpu.loadState(e),this.interruptType=e.it}isStable(){return this.cpu.isPCStable()}};var Sn=class{constructor(e,r){this.symbolmap=e,this.debuginfo=r,this.addr2symbol=dt(e),this.addr2symbol[0]||(this.addr2symbol[0]="$00"),this.addr2symbol[65536]="__END__"}};function p0(h){return h&&typeof h.getDebugCategories=="function"}var Bt=class{constructor(){this.id2bp={}}getDebugCondition(){return Object.keys(this.id2bp).length==0?null:()=>{var e=!1;for(var r in this.id2bp)this.id2bp[r].cond()&&(e=!0);return e}}},Rt=class{constructor(){this.recorder=null;this.internalFiles={}}setRecorder(e){this.recorder=e}updateRecorder(){this.recorder&&this.isRunning()&&this.recorder.frameRequested()&&this.recorder.recordFrame(this.saveState())}inspect(e){return Cn(this,e)}getDebugTree(){var r;var e={};return e.state=this.saveState(),((r=this.debugSymbols)==null?void 0:r.debuginfo)&&(e.debuginfo=this.debugSymbols.debuginfo),e}readFile(e){return this.internalFiles[e]}writeFile(e,r){return this.internalFiles[e]=r,!0}},z0=class extends Rt{constructor(){super(...arguments);this.debugSavedState=null;this.debugBreakState=null;this.debugTargetClock=0;this.debugClock=0;this.breakpoints=new Bt;this.frameCount=0}setBreakpoint(e,r){r?(this.breakpoints.id2bp[e]={cond:r},this.restartDebugging()):this.clearBreakpoint(e)}clearBreakpoint(e){delete this.breakpoints.id2bp[e]}hasBreakpoint(e){return this.breakpoints.id2bp[e]!=null}getDebugCallback(){return this.breakpoints.getDebugCondition()}setupDebug(e){this.onBreakpointHit=e}clearDebug(){this.debugSavedState=null,this.debugBreakState=null,this.debugTargetClock=-1,this.debugClock=0,this.onBreakpointHit=null,this.clearBreakpoint("debug"),this.frameCount=0}setDebugCondition(e){this.setBreakpoint("debug",e)}resetDebugging(){this.debugSavedState?this.loadState(this.debugSavedState):this.debugSavedState=this.saveState(),this.debugClock=0,this.debugCallback=this.getDebugCallback(),this.debugBreakState=null}restartDebugging(){this.resetDebugging(),this.resume()}preFrame(){this.debugCallback&&!this.debugBreakState&&(this.debugSavedState=this.saveState(),this.debugTargetClock-=this.debugClock,this.debugClock=0)}postFrame(){this.debugCallback&&this.debugBreakState&&this.loadState(this.debugBreakState),this.frameCount++}pollControls(){}nextFrame(e){this.pollControls(),this.updateRecorder(),this.preFrame();var r=this.advance(e);return this.postFrame(),r}evalDebugCondition(){this.debugCallback&&!this.debugBreakState&&this.debugCallback()}wasBreakpointHit(){return this.debugBreakState!=null}breakpointHit(e,r){console.log(this.debugTargetClock,e,this.debugClock,this.isStable()),this.debugTargetClock=e,this.debugBreakState=this.saveState(),console.log("Breakpoint at clk",this.debugClock,"PC",this.debugBreakState.c.PC.toString(16)),this.pause(),this.onBreakpointHit&&this.onBreakpointHit(this.debugBreakState,r)}haltAndCatchFire(e){this.breakpointHit(this.debugClock,e)}runEval(e){this.setDebugCondition(()=>{if(++this.debugClock>=this.debugTargetClock&&this.isStable()){var r=this.getCPUState();return e(r)?(this.breakpointHit(this.debugClock),!0):!1}})}runToPC(e){this.debugTargetClock++,this.runEval(r=>r.PC==e)}runUntilReturn(){var e=this.getSP();this.runEval(r=>r.SP>e)}runToFrameClock(e){this.restartDebugging(),this.debugTargetClock=e,this.runEval(()=>!0)}step(){this.runToFrameClock(this.debugClock+1)}stepBack(){var e,r,f=this.debugTargetClock;this.restartDebugging(),this.debugTargetClock=f-25,this.runEval(l=>this.debugClock<f?(e=this.saveState(),r=this.debugClock,!1):(e&&(this.loadState(e),this.debugClock=r),!0))}runToVsync(){this.restartDebugging();var e=this.frameCount;this.runEval(()=>this.frameCount>e)}};function Cn(h,e){if(!!h.debugSymbols){var r=h.debugSymbols.symbolmap,f=h.debugSymbols.addr2symbol;if(!r||!h.readAddress)return null;var l=r["_"+e]||r[e];if(typeof l!="number")return null;var x=h.readAddress(l);if(f&&f[l+1]!=null)return"$"+ae(l,4)+" = $"+ae(x,2)+" ("+x+" decimal)";{let d=h.readAddress(l+1),u=x|d<<8;return"$"+ae(l,4)+" = $"+ae(x,2)+" $"+ae(d,2)+" ("+(u<<16>>16)+" decimal)"}}}function yt(h){return h.endsWith(".pla")?"plasm":h.endsWith(".c")||h.endsWith(".h")?"cc65":h.endsWith(".s")||h.endsWith(".ca65")?"ca65":h.endsWith(".dasm")?"dasm":h.endsWith(".acme")?"acme":h.endsWith(".wiz")?"wiz":h.endsWith(".ecs")?"ecs":"dasm"}var gn=class extends z0{constructor(){super(...arguments);this.debugPCDelta=-1;this.getToolForFilename=yt}fixPC(e){return e.PC=e.PC+this.debugPCDelta&65535,e}unfixPC(e){return e.PC=e.PC-this.debugPCDelta&65535,e}getSP(){return this.getCPUState().SP}getPC(){return this.getCPUState().PC}isStable(){return!this.getCPUState().T}newCPU(e){var r=new xt;return r.connectBus(e),r}getOpcodeMetadata(e,r){return Lt(e,r)}getOriginPC(){return(this.readAddress(65532)|this.readAddress(65533)<<8)&65535}disassemble(e,r){return at(e,r(e),r(e+1),r(e+2))}getDefaultExtension(){return".a"}getDebugCategories(){return["CPU","ZPRAM","Stack"]}getDebugInfo(e,r){switch(e){case"CPU":return It(r.c);case"ZPRAM":return rt(r.b||r.ram,0,256);case"Stack":return E0(this,r.b||r.ram,256,511,256+r.c.SP,32)}}};function It(h){function e(r){var f="";return f+=r.N?" N":" -",f+=r.V?" V":" -",f+=r.D?" D":" -",f+=r.Z?" Z":" -",f+=r.C?" C":" -",f+=r.I?" I":" -",f}return"PC "+ae(h.PC,4)+"  "+e(h)+`
 A `+ae(h.A)+"     "+(h.R?"":"BUSY")+`
 X `+ae(h.X)+`
 Y `+ae(h.Y)+"     SP "+ae(h.SP)+`
`}var K0={cycletime:[7,6,0,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,0,6,0,6,3,3,3,3,2,0,2,0,4,4,4,4,2,6,0,0,4,4,4,4,2,5,2,0,0,5,0,0,2,6,2,6,3,3,3,3,2,2,2,0,4,4,4,4,2,5,0,5,4,4,4,4,2,4,2,0,4,4,4,4,2,6,0,8,3,3,5,5,2,2,2,2,4,4,3,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,2,6,0,8,3,3,5,5,2,2,2,0,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7],extracycles:[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1],insnlengths:[1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,3,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,0,2,0,2,2,2,2,2,1,0,1,0,3,3,3,3,2,2,0,0,2,2,2,3,1,3,1,0,0,3,0,0,2,2,2,2,2,2,2,2,1,2,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,3,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,2,2,0,2,2,2,2,2,1,2,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3],validinsns:[1,2,0,0,0,2,2,0,1,2,1,0,0,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,3,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,1,2,0,0,0,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,1,2,0,0,0,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,0,2,0,0,2,2,2,0,1,0,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,3,1,0,0,3,0,0,2,2,2,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,3,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,2,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0]};function Lt(h,e){return{opcode:h,minCycles:K0.cycletime[h],maxCycles:K0.cycletime[h]+K0.extracycles[h],insnlength:K0.insnlengths[h]}}function Ot(h){function e(r){return nt(r,["S","Z",,"H",,"V","N","C"],!0)}return"PC "+ae(h.PC,4)+"  "+e(h.AF)+" "+(h.iff1?"I":"-")+(h.iff2?"I":"-")+`
SP `+ae(h.SP,4)+"  IR "+ae(h.IR,4)+`
IX `+ae(h.IX,4)+"  IY "+ae(h.IY,4)+`
AF `+ae(h.AF,4)+"  BC "+ae(h.BC,4)+`
DE `+ae(h.DE,4)+"  HL "+ae(h.HL,4)+`
`}var Et=class extends z0{constructor(){super(...arguments);this.waitCycles=0;this.getToolForFilename=wt}newCPU(e,r){return this._cpu=new it,this._cpu.connectMemoryBus(e),this._cpu.connectIOBus(r),this._cpu}getPC(){return this._cpu.getPC()}getSP(){return this._cpu.getSP()}isStable(){return!0}runCPU(e,r){if(this._cpu=e,this.waitCycles=0,this.wasBreakpointHit())return 0;var f=this.getDebugCallback(),l=0;for(this.waitCycles+=r;this.waitCycles>0;){if(f&&f()){f=null;break}var x=e.advanceInsn();l+=x,this.waitCycles-=x}return l}getDefaultExtension(){return".c"}getDebugCategories(){return["CPU","Stack"]}getDebugInfo(e,r){switch(e){case"CPU":return Ot(r.c);case"Stack":{var f=r.c.SP-1&65535,l=f&65280,x=l+255;return f==0&&(f=65536),console.log(f,l,x),E0(this,[],l,x,f,205)}}}disassemble(e,r){return st(e,r(e),r(e+1),r(e+2),r(e+3))}};function wt(h){return h.endsWith(".c")||h.endsWith(".h")?"sdcc":h.endsWith(".s")?"sdasz80":h.endsWith(".ns")?"naken":h.endsWith(".scc")?"sccz80":h.endsWith(".z")?"zmac":h.endsWith(".wiz")?"wiz":"zmac"}function ut(h){function e(r){return nt(r,["E","F","H","I","N","Z","V","C"],!0)}return"PC "+ae(h.PC,4)+"  "+e(h.CC)+`
SP `+ae(h.SP,4)+`
DP `+ae(h.DP,2)+`
 A `+ae(h.A,2)+`
 B `+ae(h.B,2)+`
 X `+ae(h.X,4)+`
 Y `+ae(h.Y,4)+`
 U `+ae(h.U,4)+`
`}function Nt(h){return h.endsWith(".c")||h.endsWith(".h")?"cmoc":h.endsWith(".xasm")?"xasm6809":"lwasm"}var pn=class extends Et{constructor(){super(...arguments);this.getToolForFilename=Nt}newCPU(e){var r=Object.create(V0());return r.init(e.write,e.read,0),r}cpuStateToLongString(e){return ut(e)}disassemble(e,r){return Object.create(V0()).disasm(r(e),r(e+1),r(e+2),r(e+3),r(e+4),e)}getDefaultExtension(){return".asm"}getDebugCategories(){return["CPU","Stack"]}getDebugInfo(e,r){switch(e){case"CPU":return ut(r.c);default:return super.getDebugInfo(e,r)}}};function E0(h,e,r,f,l,x,d){var u="",a=0;function V(k){return k<e.length?e[k]:h.readAddress(k)}for(;l<f;){l++;var L=V(l)+V(l+1)*256;d&&(L=(L&255)<<8|(L&65280)>>8);var p=x==32?-2:-3,I=V(L+p);I==x?(u+=`
$`+ae(l)+": ",u+=ae(L,4)+" "+_n(h,L,!0),l++,a=0):(a==0&&(u+=`
$`+ae(l)+": "),u+=ae(V(l))+" ",++a==8&&(a=0))}return u+`
`}function _n(h,e,r){for(var f=e,l=h.debugSymbols&&h.debugSymbols.addr2symbol;l&&e>=0;){var x=l[e];if(x){var x=l[e];return r?x+" + $"+ae(f-e):x}if(!r)break;e--}return""}function Pn(h){return typeof h.connectVideo=="function"}function kn(h){return typeof h.connectAudio=="function"}function Dn(h){return typeof h.setKeyInput=="function"}function Mt(h){return typeof h.setPaddleInput=="function"}function Bn(h){return typeof h.getRasterY=="function"}function Rn(h){return typeof h.connectProbe=="function"}function yn(h){return typeof h.loadBIOS=="function"}function In(h){return typeof h.connectSerialIO=="function"}var j0=class extends z0{constructor(e){super();this.mainElement=e}reset(){this.machine.reset(),this.serialVisualizer!=null&&this.serialVisualizer.reset()}loadState(e){this.machine.loadState(e)}saveState(){return this.machine.saveState()}getSP(){return this.machine.cpu.getSP()}getPC(){return this.machine.cpu.getPC()}isStable(){return this.machine.cpu.isStable()}getCPUState(){return this.machine.cpu.saveState()}loadControlsState(e){this.machine.loadControlsState(e)}saveControlsState(){return this.machine.saveControlsState()}async start(){this.machine=this.newMachine();let e=this.machine;e instanceof O0&&await e.loadWASM();var r;if(Pn(e)){var f=e.getVideoParams();this.video=new At(this.mainElement,f.width,f.height,{overscan:!!f.overscan,rotate:f.rotate|0,aspect:f.aspect}),this.video.create(),e.connectVideo(this.video.getFrameData()),Dn(e)&&(this.video.setKeyboardEvents(e.setKeyInput.bind(e)),this.poller=new Ct(e.setKeyInput.bind(e))),r=f.videoFrequency}if(this.timer=new St(r||60,this.nextFrame.bind(this)),kn(e)){var l=e.getAudioParams();this.audio=new ft(l.sampleRate),this.audio.start(),e.connectAudio(this.audio)}Mt(e)&&this.video.setupMouseEvents(),Rn(e)&&(this.probeRecorder=new ct(e),this.startProbing=()=>(e.connectProbe(this.probeRecorder),this.probeRecorder),this.stopProbing=()=>{e.connectProbe(null)}),yn(e)&&(this.loadBIOS=(x,d)=>{e.loadBIOS(d,x)}),In(e)&&(this.serialIOInterface==null?this.serialVisualizer=new Tt(this.mainElement,e):e.connectSerialIO(this.serialIOInterface))}loadROM(e,r){this.machine.loadROM(r,e),this.reset()}pollControls(){this.poller&&this.poller.poll(),Mt(this.machine)&&(this.machine.setPaddleInput(0,this.video.paddle_x),this.machine.setPaddleInput(1,this.video.paddle_y)),this.machine.pollControls&&this.machine.pollControls()}advance(e){let r=this.getDebugCallback();var f=this.machine.advanceFrame(r);return!e&&this.video&&this.video.updateFrame(),!e&&this.serialVisualizer&&this.serialVisualizer.refresh(),f}advanceFrameClock(e,r){if(r>0)return this.machine instanceof O0?this.machine.advanceFrameClock(e,r):this.machine.advanceFrame(()=>--r<=0)}isRunning(){return this.timer&&this.timer.isRunning()}resume(){this.timer.start(),this.audio&&this.audio.start()}pause(){this.timer.stop(),this.audio&&this.audio.stop()}runToVsync(){this.restartDebugging();var e=!1;this.runEval(()=>{if(this.getRasterScanline()>0)e=!0;else return e})}getRasterScanline(){return Bn(this.machine)&&this.machine.getRasterY()}readAddress(e){return this.machine.read(e)}getDebugCategories(){if(p0(this.machine))return this.machine.getDebugCategories()}getDebugInfo(e,r){return p0(this.machine)&&this.machine.getDebugInfo(e,r)}},Ln=class extends j0{constructor(){super(...arguments);this.getOpcodeMetadata=Lt;this.getToolForFilename=yt}disassemble(e,r){return at(e,r(e),r(e+1),r(e+2))}getDebugCategories(){return p0(this.machine)?this.machine.getDebugCategories():["CPU","ZPRAM","Stack"]}getDebugInfo(e,r){switch(e){case"CPU":return It(r.c);case"ZPRAM":return rt(r.b||r.ram,0,256);case"Stack":return E0(this,r.b||r.ram,256,511,256+r.c.SP,32);default:return p0(this.machine)&&this.machine.getDebugInfo(e,r)}}},On=class extends j0{constructor(){super(...arguments);this.getToolForFilename=wt}getDebugCategories(){return p0(this.machine)?this.machine.getDebugCategories():["CPU","Stack"]}getDebugInfo(e,r){switch(e){case"CPU":return Ot(r.c);case"Stack":{var f=r.c.SP-1&65535,l=f&65280,x=l+255;return f==0&&(f=65536),E0(this,[],l,x,f,205)}default:return p0(this.machine)&&this.machine.getDebugInfo(e,r)}}disassemble(e,r){return st(e,r(e),r(e+1),r(e+2),r(e+3))}},En=class extends j0{constructor(){super(...arguments);this.getToolForFilename=Nt}getDebugCategories(){return p0(this.machine)?this.machine.getDebugCategories():["CPU","Stack"]}getDebugInfo(e,r){switch(e){case"CPU":return ut(r.c);case"Stack":{var f=r.c.SP-1&65535,l=f&65280,x=l+255;return f==0&&(f=65536),E0(this,[],l,x,f,23,!0)}default:return super.getDebugInfo(e,r)}}disassemble(e,r){return Object.create(V0()).disasm(r(e),r(e+1),r(e+2),r(e+3),r(e+4),e)}},Tt=class{constructor(e,r){this.lastOutCount=-1;this.lastInCount=-1;this.device=r,this.textarea=document.createElement("textarea"),this.textarea.classList.add("transcript"),this.textarea.classList.add("transcript-style-2"),this.textarea.style.display="none",e.appendChild(this.textarea)}reset(){this.lastOutCount=0,this.lastInCount=0,this.textarea.style.display="none"}refresh(){var e="";if(this.device.serialOut.length!=this.lastOutCount){var r="";for(var f of this.device.serialOut)e!=f.op&&(r!=""&&(r+=`
`),f.op==="read"?r+="<< ":f.op==="write"&&(r+=">> "),e=f.op),f.value==10?(r+="\u21B5",e=""):r+=ht(f.value);this.textarea.value=r,this.lastOutCount=this.device.serialOut.length,this.textarea.style.display="block"}}};export{at as a,st as b,it as c,gt as d,on as e,ln as f,Fn as g,mn as h,Un as i,bn as j,dn as k,Ee as l,ct as m,Z0 as n,pt as o,_t as p,hn as q,O0 as r,An as s,V0 as t,vn as u,Sn as v,p0 as w,Rt as x,Cn as y,yt as z,gn as A,It as B,Lt as C,Ot as D,Et as E,wt as F,pn as G,E0 as H,j0 as I,Ln as J,On as K,En as L};
//# sourceMappingURL=chunk-4YPL6KTM.js.map
