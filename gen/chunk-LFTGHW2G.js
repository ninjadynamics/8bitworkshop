var st=function(){var F=this;this.powerOn=function(){this.reset()},this.powerOff=function(){},this.clockPulse=function(){!E0||(w++,O0[w]())},this.connectBus=function(u){v=u},this.setRDY=function(u){E0=u},this.isRDY=function(){return E0},this.reset=function(){Q=1,w=-1,O0=[d],i=v.read(An)|v.read(An+1)<<8,this.setRDY(!0)};var v,E0=!1,i=0,T=0,r=0,R=0,N=0,W=0,g=0,H=0,Q=0,v0=0,A=0,w=-1,d0=-1,O0,f=0,D=0,L=0,n0=!1,_=0,p0=0,I0=0;let Sn=65530,An=65532,k0=65534,e=0,O=1,tn=7,Rn=6,un=1,xn=0;this.debug=!1,this.trace=!1;var d=function(){d0=v.read(i),O0=n[d0],w=0,i++},S=d,J=function(){v.read(i)},In=function(){p0=v.read(i),i++},t0=function(){D=v.read(i),i++},Y0=function(){D|=v.read(i)<<8,i++},rn=function(){D=v.read(L)},fn=function(){D|=v.read(L)<<8},Z=function(){L=v.read(i),i++},en=function(){L|=v.read(i)<<8,i++},K0=function(){L=v.read(_)},V0=function(){L|=v.read(_)<<8},z=function(){var u=(L&255)+R;n0=u>255,L=L&65280|u&255},U=function(){var u=(L&255)+N;n0=u>255,L=L&65280|u&255},cn=function(){var u=(L&255)+1;n0=u>255,L=L&65280|u&255},l0=function(){n0&&(L=L+256&65535)},W0=function(){_=v.read(i),i++},ln=function(){_|=v.read(i)<<8,i++},H0=function(){var u=(_&255)+1;_=_&65280|u&255},M0=function(){f=v.read(i),i++},N0=function(){f=v.read(D)},m=function(){f=v.read(L)},j=function(){v.write(D,f)},q=function(){v.write(L,f)},Nn=function(){var u=i&255,x=u+p0&255;p0>127?I0=x>u?-256:0:I0=x<u?256:0,i=i&65280|x},hn=function(){i=i+I0&65535},o=function(u){v0=u===0?1:0},a=function(u){W=u&128?1:0},G=function(u){g=u?1:0},h=function(u){A=u?1:0},S0=function(){return T=T+1&255,v.read(256+T)},g0=function(){return v.read(256+T)},M=function(u){v.write(256+T,u),T=T-1&255},F0=function(){return W<<7|g<<6|48|H<<3|Q<<2|v0<<1|A},bn=function(u){W=u>>>7,g=u>>>6&1,H=u>>>3&1,Q=u>>>2&1,v0=u>>>1&1,A=u&1},B=function(u){F.debug&&F.breakpoint("Illegal Opcode: "+u)},C=function(u){return[d,J,function(){u(),S()}]},I=function(u){return[d,M0,function(){u(),S()}]},E=function(u){return[d,t0,N0,function(){u(),S()}]},Y=function(u){return[d,t0,Y0,N0,function(){u(),S()}]},u0=function(u){return[d,Z,m,function(){z(),rn()},function(){cn(),fn()},N0,function(){u(),S()}]},l=function(u){var x=u===e?z:U;return function(c){return[d,Z,en,function(){x(),m(),l0()},function(){n0?m():(c(),S())},function(){c(),S()}]}},p=function(u){var x=u===e?z:U;return function(c){return[d,Z,m,function(){x(),m()},function(){c(),S()}]}},x0=function(u){return[d,W0,K0,function(){H0(),V0()},function(){U(),m(),l0()},function(){n0?m():(u(),S())},function(){u(),S()}]},Q0=function(u){return[d,t0,function(){u(),j()},S]},_0=function(u){return[d,t0,Y0,function(){u(),j()},S]},Cn=function(u){return[d,Z,m,function(){z(),rn()},function(){cn(),fn()},function(){u(),j()},S]},h0=function(u){var x=u===e?z:U;return function(c){return[d,Z,en,function(){x(),m(),l0()},function(){c(),q()},S]}},J0=function(u){var x=u===e?z:U;return function(c){return[d,Z,m,function(){x(),c(),q()},S]}},sn=function(u){return[d,W0,K0,function(){H0(),V0()},function(){U(),m(),l0()},function(){u(),q()},S]},y=function(u){return[d,t0,N0,j,function(){u(),j()},S]},k=function(u){return[d,t0,Y0,N0,j,function(){u(),j()},S]},K=function(u){var x=u===e?z:U;return function(c){return[d,Z,m,function(){x(),m()},q,function(){c(),q()},S]}},X=function(u){var x=u===e?z:U;return function(c){return[d,Z,en,function(){x(),m(),l0()},m,q,function(){c(),q()},S]}},B0=function(u){return[d,Z,m,function(){z(),rn()},function(){cn(),fn()},N0,j,function(){u(),j()},S]},m0=function(u){return[d,W0,K0,function(){H0(),V0()},function(){U(),m(),l0()},m,q,function(){u(),q()},S]},t=new Array(256),n=new Array(256);t[0]="BRK",n[0]=ot(),t[1]="ORA",n[1]=o0(u0),t[2]="uKIL",n[2]=V(),t[3]="uSLO",n[3]=P0(B0),t[4]="uNOP",n[4]=P(E),t[5]="ORA",n[5]=o0(E),t[6]="ASL",n[6]=z0(y),t[7]="uSLO",n[7]=P0(y),t[8]="PHP",n[8]=ft(),t[9]="ORA",n[9]=o0(I),t[10]="ASL",n[10]=Bn(),t[11]="uANC",n[11]=Ln(I),t[12]="uNOP",n[12]=P(Y),t[13]="ORA",n[13]=o0(Y),t[14]="ASL",n[14]=z0(k),t[15]="uSLO",n[15]=P0(k),t[16]="BPL",n[16]=a0(tn,0),t[17]="ORA",n[17]=o0(x0),t[18]="uKIL",n[18]=V(),t[19]="uSLO",n[19]=P0(m0),t[20]="uNOP",n[20]=P(p(e)),t[21]="ORA",n[21]=o0(p(e)),t[22]="ASL",n[22]=z0(K(e)),t[23]="uSLO",n[23]=P0(K(e)),t[24]="CLC",n[24]=mn(),t[25]="ORA",n[25]=o0(l(O)),t[26]="uNOP",n[26]=P(C),t[27]="uSLO",n[27]=P0(X(O)),t[28]="uNOP",n[28]=P(l(e)),t[29]="ORA",n[29]=o0(l(e)),t[30]="ASL",n[30]=z0(X(e)),t[31]="uSLO",n[31]=P0(X(e)),t[32]="JSR",n[32]=ct(),t[33]="AND",n[33]=f0(u0),t[34]="uKIL",n[34]=V(),t[35]="uRLA",n[35]=C0(B0),t[36]="BIT",n[36]=Pn(E),t[37]="AND",n[37]=f0(E),t[38]="ROL",n[38]=G0(y),t[39]="uRLA",n[39]=C0(y),t[40]="PLP",n[40]=it(),t[41]="AND",n[41]=f0(I),t[42]="ROL",n[42]=kn(),t[43]="uANC",n[43]=Ln(I),t[44]="BIT",n[44]=Pn(Y),t[45]="AND",n[45]=f0(Y),t[46]="ROL",n[46]=G0(k),t[47]="uRLA",n[47]=C0(k),t[48]="BMI",n[48]=a0(tn,1),t[49]="AND",n[49]=f0(x0),t[50]="uKIL",n[50]=V(),t[51]="uRLA",n[51]=C0(m0),t[52]="uNOP",n[52]=P(p(e)),t[53]="AND",n[53]=f0(p(e)),t[54]="ROL",n[54]=G0(K(e)),t[55]="uRLA",n[55]=C0(K(e)),t[56]="SEC",n[56]=Vn(),t[57]="AND",n[57]=f0(l(O)),t[58]="uNOP",n[58]=P(C),t[59]="uRLA",n[59]=C0(X(O)),t[60]="uNOP",n[60]=P(l(e)),t[61]="AND",n[61]=f0(l(e)),t[62]="ROL",n[62]=G0(X(e)),t[63]="uRLA",n[63]=C0(X(e)),t[64]="RTI",n[64]=dt(),t[65]="EOR",n[65]=i0(u0),t[66]="uKIL",n[66]=V(),t[67]="uSRE",n[67]=L0(B0),t[68]="uNOP",n[68]=P(E),t[69]="EOR",n[69]=i0(E),t[70]="LSR",n[70]=q0(y),t[71]="uSRE",n[71]=L0(y),t[72]="PHA",n[72]=rt(),t[73]="EOR",n[73]=i0(I),t[74]="LSR",n[74]=wn(),t[75]="uASR",n[75]=qn(I),t[76]="JMP",n[76]=At(),t[77]="EOR",n[77]=i0(Y),t[78]="LSR",n[78]=q0(k),t[79]="uSRE",n[79]=L0(k),t[80]="BVC",n[80]=a0(Rn,0),t[81]="EOR",n[81]=i0(x0),t[82]="uKIL",n[82]=V(),t[83]="uSRE",n[83]=L0(m0),t[84]="uNOP",n[84]=P(p(e)),t[85]="EOR",n[85]=i0(p(e)),t[86]="LSR",n[86]=q0(K(e)),t[87]="uSRE",n[87]=L0(K(e)),t[88]="CLI",n[88]=Tn(),t[89]="EOR",n[89]=i0(l(O)),t[90]="uNOP",n[90]=P(C),t[91]="uSRE",n[91]=L0(X(O)),t[92]="uNOP",n[92]=P(l(e)),t[93]="EOR",n[93]=i0(l(e)),t[94]="LSR",n[94]=q0(X(e)),t[95]="uSRE",n[95]=L0(X(e)),t[96]="RTS",n[96]=St(),t[97]="ADC",n[97]=r0(u0),t[98]="uKIL",n[98]=V(),t[99]="uRRA",n[99]=s0(B0),t[100]="uNOP",n[100]=P(E),t[101]="ADC",n[101]=r0(E),t[102]="ROR",n[102]=$0(y),t[103]="uRRA",n[103]=s0(y),t[104]="PLA",n[104]=et(),t[105]="ADC",n[105]=r0(I),t[106]="ROR",n[106]=Kn(),t[107]="uARR",n[107]=jn(I),t[108]="JMP",n[108]=Rt(),t[109]="ADC",n[109]=r0(Y),t[110]="ROR",n[110]=$0(k),t[111]="uRRA",n[111]=s0(k),t[112]="BVS",n[112]=a0(Rn,1),t[113]="ADC",n[113]=r0(x0),t[114]="uKIL",n[114]=V(),t[115]="uRRA",n[115]=s0(m0),t[116]="uNOP",n[116]=P(p(e)),t[117]="ADC",n[117]=r0(p(e)),t[118]="ROR",n[118]=$0(K(e)),t[119]="uRRA",n[119]=s0(K(e)),t[120]="SEI",n[120]=Hn(),t[121]="ADC",n[121]=r0(l(O)),t[122]="uNOP",n[122]=P(C),t[123]="uRRA",n[123]=s0(X(O)),t[124]="uNOP",n[124]=P(l(e)),t[125]="ADC",n[125]=r0(l(e)),t[126]="ROR",n[126]=$0(X(e)),t[127]="uRRA",n[127]=s0(X(e)),t[128]="uNOP",n[128]=P(I),t[129]="STA",n[129]=A0(Cn),t[130]="uNOP",n[130]=P(I),t[131]="uSAX",n[131]=Z0(Cn),t[132]="STY",n[132]=dn(Q0),t[133]="STA",n[133]=A0(Q0),t[134]="STX",n[134]=vn(Q0),t[135]="uSAX",n[135]=Z0(Q0),t[136]="DEY",n[136]=Yn(),t[137]="uNOP",n[137]=P(I),t[138]="TXA",n[138]=Jn(),t[139]="uANE",n[139]=Un(I),t[140]="STY",n[140]=dn(_0),t[141]="STA",n[141]=A0(_0),t[142]="STX",n[142]=vn(_0),t[143]="uSAX",n[143]=Z0(_0),t[144]="BCC",n[144]=a0(xn,0),t[145]="STA",n[145]=A0(sn),t[146]="uKIL",n[146]=V(),t[147]="uSHA",n[147]=Dn(sn),t[148]="STY",n[148]=dn(J0(e)),t[149]="STA",n[149]=A0(J0(e)),t[150]="STX",n[150]=vn(J0(O)),t[151]="uSAX",n[151]=Z0(J0(O)),t[152]="TYA",n[152]=zn(),t[153]="STA",n[153]=A0(h0(O)),t[154]="TXS",n[154]=Zn(),t[155]="uSHS",n[155]=tt(h0(O)),t[156]="uSHY",n[156]=xt(h0(e)),t[157]="STA",n[157]=A0(h0(e)),t[158]="uSHX",n[158]=ut(h0(O)),t[159]="uSHA",n[159]=Dn(h0(O)),t[160]="LDY",n[160]=y0(I),t[161]="LDA",n[161]=c0(u0),t[162]="LDX",n[162]=w0(I),t[163]="uLAX",n[163]=X0(u0),t[164]="LDY",n[164]=y0(E),t[165]="LDA",n[165]=c0(E),t[166]="LDX",n[166]=w0(E),t[167]="uLAX",n[167]=X0(E),t[168]="TAY",n[168]=Qn(),t[169]="LDA",n[169]=c0(I),t[170]="TAX",n[170]=Fn(),t[171]="uLXA",n[171]=$n(I),t[172]="LDY",n[172]=y0(Y),t[173]="LDA",n[173]=c0(Y),t[174]="LDX",n[174]=w0(Y),t[175]="uLAX",n[175]=X0(Y),t[176]="BCS",n[176]=a0(xn,1),t[177]="LDA",n[177]=c0(x0),t[178]="uKIL",n[178]=V(),t[179]="uLAX",n[179]=X0(x0),t[180]="LDY",n[180]=y0(p(e)),t[181]="LDA",n[181]=c0(p(e)),t[182]="LDX",n[182]=w0(p(O)),t[183]="uLAX",n[183]=X0(p(O)),t[184]="CLV",n[184]=En(),t[185]="LDA",n[185]=c0(l(O)),t[186]="TSX",n[186]=_n(),t[187]="uLAS",n[187]=Gn(l(O)),t[188]="LDY",n[188]=y0(l(e)),t[189]="LDA",n[189]=c0(l(e)),t[190]="LDX",n[190]=w0(l(O)),t[191]="uLAX",n[191]=X0(l(O)),t[192]="CPY",n[192]=an(I),t[193]="CMP",n[193]=e0(u0),t[194]="uNOP",n[194]=P(I),t[195]="uDCP",n[195]=R0(B0),t[196]="CPY",n[196]=an(E),t[197]="CMP",n[197]=e0(E),t[198]="DEC",n[198]=U0(y),t[199]="uDCP",n[199]=R0(y),t[200]="INY",n[200]=gn(),t[201]="CMP",n[201]=e0(I),t[202]="DEX",n[202]=pn(),t[203]="uSBX",n[203]=nt(I),t[204]="CPY",n[204]=an(Y),t[205]="CMP",n[205]=e0(Y),t[206]="DEC",n[206]=U0(k),t[207]="uDCP",n[207]=R0(k),t[208]="BNE",n[208]=a0(un,0),t[209]="CMP",n[209]=e0(x0),t[210]="uKIL",n[210]=V(),t[211]="uDCP",n[211]=R0(m0),t[212]="uNOP",n[212]=P(p(e)),t[213]="CMP",n[213]=e0(p(e)),t[214]="DEC",n[214]=U0(K(e)),t[215]="uDCP",n[215]=R0(K(e)),t[216]="CLD",n[216]=Xn(),t[217]="CMP",n[217]=e0(l(O)),t[218]="uNOP",n[218]=P(C),t[219]="uDCP",n[219]=R0(X(O)),t[220]="uNOP",n[220]=P(l(e)),t[221]="CMP",n[221]=e0(l(e)),t[222]="DEC",n[222]=U0(X(e)),t[223]="uDCP",n[223]=R0(X(e)),t[224]="CPX",n[224]=on(I),t[225]="SBC",n[225]=$(u0),t[226]="uNOP",n[226]=P(I),t[227]="uISB",n[227]=b0(B0),t[228]="CPX",n[228]=on(E),t[229]="SBC",n[229]=$(E),t[230]="INC",n[230]=j0(y),t[231]="uISB",n[231]=b0(y),t[232]="INX",n[232]=Mn(),t[233]="SBC",n[233]=$(I),t[234]="NOP",n[234]=yn(),t[235]="SBC",n[235]=$(I),t[236]="CPX",n[236]=on(Y),t[237]="SBC",n[237]=$(Y),t[238]="INC",n[238]=j0(k),t[239]="uISB",n[239]=b0(k),t[240]="BEQ",n[240]=a0(un,1),t[241]="SBC",n[241]=$(x0),t[242]="uKIL",n[242]=V(),t[243]="uISB",n[243]=b0(m0),t[244]="uNOP",n[244]=P(p(e)),t[245]="SBC",n[245]=$(p(e)),t[246]="INC",n[246]=j0(K(e)),t[247]="uISB",n[247]=b0(K(e)),t[248]="SED",n[248]=Wn(),t[249]="SBC",n[249]=$(l(O)),t[250]="uNOP",n[250]=P(C),t[251]="uISB",n[251]=b0(X(O)),t[252]="uNOP",n[252]=P(l(e)),t[253]="SBC",n[253]=$(l(e)),t[254]="INC",n[254]=j0(X(e)),t[255]="uISB",n[255]=b0(X(e));function Bn(){return C(function(){h(r>127),r=r<<1&255,o(r),a(r)})}function mn(){return C(function(){A=0})}function Xn(){return C(function(){H=0})}function Tn(){return C(function(){Q=0})}function En(){return C(function(){g=0})}function pn(){return C(function(){R=R-1&255,o(R),a(R)})}function Yn(){return C(function(){N=N-1&255,o(N),a(N)})}function Mn(){return C(function(){R=R+1&255,o(R),a(R)})}function gn(){return C(function(){N=N+1&255,o(N),a(N)})}function wn(){return C(function(){A=r&1,r>>>=1,o(r),W=0})}function yn(){return C(function(){})}function kn(){return C(function(){var u=r>127;r=(r<<1|A)&255,h(u),o(r),a(r)})}function Kn(){return C(function(){var u=r&1;r=r>>>1|A<<7,h(u),o(r),a(r)})}function Vn(){return C(function(){A=1})}function Wn(){return C(function(){H=1})}function Hn(){return C(function(){Q=1})}function Fn(){return C(function(){R=r,o(R),a(R)})}function Qn(){return C(function(){N=r,o(N),a(N)})}function _n(){return C(function(){R=T,o(R),a(R)})}function Jn(){return C(function(){r=R,o(r),a(r)})}function Zn(){return C(function(){T=R})}function zn(){return C(function(){r=N,o(r),a(r)})}function V(){return[d,function(){B("KIL/HLT/JAM")},function(){w--}]}function P(u){return u(function(){B("NOP/DOP")})}function r0(u){return u(function(){if(H){var x=f,c=(r&15)+(x&15)+A;c>9&&(c+=6);var s=(r>>4)+(x>>4)+(c>15?1:0)<<4;o(r+x+A&255),a(s),G((r^s)&~(r^x)&128),s>159&&(s+=96),h(s>255),r=(s|c&15)&255}else{var b=r+f+A;h(b>255),G((r^b)&(f^b)&128),r=b&255,o(r),a(r)}})}function f0(u){return u(function(){r&=f,o(r),a(r)})}function Pn(u){return u(function(){var x=f;o(r&x),G(x&64),a(x)})}function e0(u){return u(function(){var x=r-f&255;h(r>=f),o(x),a(x)})}function on(u){return u(function(){var x=R-f&255;h(R>=f),o(x),a(x)})}function an(u){return u(function(){var x=N-f&255;h(N>=f),o(x),a(x)})}function i0(u){return u(function(){r^=f,o(r),a(r)})}function c0(u){return u(function(){r=f,o(r),a(r)})}function w0(u){return u(function(){R=f,o(R),a(R)})}function y0(u){return u(function(){N=f,o(N),a(N)})}function o0(u){return u(function(){r|=f,o(r),a(r)})}function $(u){return u(function(){if(H){var x=f,c=(r&15)-(x&15)-(1-A),s=(r>>4)-(x>>4)-(c<0?1:0);c<0&&(c-=6),s<0&&(s-=6);var b=r-x-(1-A);h(~b&256),G((r^x)&(r^b)&128),o(b&255),a(b),r=(s<<4|c&15)&255}else x=~f&255,b=r+x+A,h(b>255),G((r^b)&(x^b)&128),r=b&255,o(r),a(r)})}function Ln(u){return u(function(){B("ANC"),r&=f,o(r),W=A=r&128?1:0})}function Un(u){return u(function(){B("ANE")})}function jn(u){return u(function(){B("ARR");var x=r&f,c=A?128:0;x=x>>>1|c,r=x,o(x),a(x);var s=r&96;s==96?(A=1,g=0):s==0?(A=0,g=0):s==32?(A=0,g=1):s==64&&(A=1,g=1)})}function qn(u){return u(function(){B("ASR");var x=r&f;A=x&1,x=x>>>1,r=x,o(x),W=0})}function Gn(u){return u(function(){B("LAS");var x=T&f;r=x,R=x,T=x,o(x),a(x)})}function X0(u){return u(function(){B("LAX");var x=f;r=x,R=x,o(x),a(x)})}function $n(u){return u(function(){B("LXA");var x=r&f;r=x,R=x,o(x),a(x)})}function nt(u){return u(function(){B("SBX");var x=r&R,c=f,s=x-c&255;R=s,h(x>=c),o(s),a(s)})}function A0(u){return u(function(){f=r})}function vn(u){return u(function(){f=R})}function dn(u){return u(function(){f=N})}function Z0(u){return u(function(){B("SAX"),f=r&R})}function Dn(u){return u(function(){B("SHA"),f=r&R&(L>>>8)+1&255})}function tt(u){return u(function(){B("SHS");var x=r&R;T=x,f=x&(L>>>8)+1&255})}function ut(u){return u(function(){B("SHX"),f=R&(L>>>8)+1&255})}function xt(u){return u(function(){B("SHY"),f=N&(L>>>8)+1&255})}function z0(u){return u(function(){h(f>127);var x=f<<1&255;f=x,o(x),a(x)})}function U0(u){return u(function(){var x=f-1&255;f=x,o(x),a(x)})}function j0(u){return u(function(){var x=f+1&255;f=x,o(x),a(x)})}function q0(u){return u(function(){A=f&1,f>>>=1,o(f),W=0})}function G0(u){return u(function(){var x=f>127,c=(f<<1|A)&255;f=c,h(x),o(c),a(c)})}function $0(u){return u(function(){var x=f&1,c=f>>>1|A<<7;f=c,h(x),o(c),a(c)})}function R0(u){return u(function(){B("DCP");var x=f-1&255;f=x,x=r-x,h(x>=0),o(x),a(x)})}function b0(u){return u(function(){if(B("ISB"),f=f+1&255,H){var x=f,c=(r&15)-(x&15)-(1-A),s=(r>>4)-(x>>4)-(c<0?1:0);c<0&&(c-=6),s<0&&(s-=6);var b=r-x-(1-A);h(~b&256),G((r^x)&(r^b)&128),o(b&255),a(b),r=(s<<4|c&15)&255}else x=~f&255,b=r+x+A,h(b>255),G((r^b)&(x^b)&128),r=b&255,o(r),a(r)})}function C0(u){return u(function(){B("RLA");var x=f,c=A;h(x&128),x=(x<<1|c)&255,f=x,r&=x,o(x),a(x)})}function s0(u){return u(function(){B("RRA");var x=f,c=A?128:0;if(h(x&1),x=x>>>1|c,f=x,H){var s=f,b=(r&15)+(s&15)+A;b>9&&(b+=6);var T0=(r>>4)+(s>>4)+(b>15?1:0)<<4;o(r+s+A&255),a(T0),G((r^T0)&~(r^s)&128),T0>159&&(T0+=96),h(T0>255),r=(T0|b&15)&255}else{var nn=r+f+A;h(nn>255),G((r^nn)&(f^nn)&128),r=nn&255,o(r),a(r)}})}function P0(u){return u(function(){B("SLO");var x=f;h(x&128),x=x<<1&255,f=x,x=r|x,r=x,o(x),a(x)})}function L0(u){return u(function(){B("SRE");var x=f;h(x&1),x=x>>>1,f=x,x=(r^x)&255,r=x,o(x),a(x)})}function rt(){return[d,J,function(){M(r)},S]}function ft(){return[d,J,function(){M(F0())},S]}function et(){return[d,J,g0,function(){r=S0(),o(r),a(r)},S]}function it(){return[d,J,g0,function(){bn(S0())},S]}function ct(){return[d,t0,g0,function(){M(i>>>8&255)},function(){M(i&255)},Y0,function(){i=D,S()}]}function ot(){return[d,M0,function(){F.debug&&F.breakpoint("BRK "+f),M(i>>>8&255)},function(){M(i&255)},function(){M(F0())},function(){D=v.read(k0)},function(){D|=v.read(k0+1)<<8},function(){i=D,Q=1,S()}]}function at(){return[d,M0,function(){F.debug&&F.breakpoint("IRQ "+f),M(i>>>8&255)},function(){M(i&255)},function(){M(F0())},function(){D=v.read(k0)},function(){D|=v.read(k0+1)<<8},function(){i=D,S()}]}function vt(){return[d,M0,function(){F.debug&&F.breakpoint("NMI "+f),M(i>>>8&255)},function(){M(i&255)},function(){M(F0())},function(){D=v.read(Sn)},function(){D|=v.read(Sn+1)<<8},function(){i=D,S()}]}function dt(){return[d,J,g0,function(){bn(S0())},function(){D=S0()},function(){D|=S0()<<8},function(){i=D,S()}]}function St(){return[d,J,g0,function(){D=S0()},function(){D|=S0()<<8},function(){i=D,M0()},S]}function At(){return[d,t0,Y0,function(){i=D,S()}]}function Rt(){return[d,W0,ln,K0,function(){H0(),V0()},function(){i=L,S()}]}function a0(u,x){var c;return u===un?c=function(){return v0===x}:u===tn?c=function(){return W===x}:u===xn?c=function(){return A===x}:c=function(){return g===x},[d,In,function(){c()?(J(),Nn()):S()},function(){I0?(J(),hn()):S()},S]}this.saveState=function(){return{PC:i-1&65535,A:r,X:R,Y:N,SP:T,N:W,V:g,D:H,I:Q,Z:v0,C:A,T:w,o:d0,R:E0?1:0,d:f,AD:D,BA:L,BC:n0?1:0,IA:_,bo:p0,boa:I0}},this.loadState=function(u){i=u.PC+1&65535,r=u.A,R=u.X,N=u.Y,T=u.SP,W=u.N,g=u.V,H=u.D,Q=u.I,v0=u.Z,A=u.C,w=u.T,d0=u.o,E0=!!u.R,f=u.d,D=u.AD,L=u.BA,n0=!!u.BC,_=u.IA,p0=u.bo,I0=u.boa,O0=d0<0?[d]:n[d0]},this.toString=function(){return"CPU  PC: "+i.toString(16)+"  op: "+d0.toString()+"  T: "+w+"  data: "+f+`
 A: `+r.toString(16)+"  X: "+R.toString(16)+"  Y: "+N.toString(16)+"  SP: "+T.toString(16)+"     N"+W+"  V"+g+"  D"+H+"  I"+Q+"  Z"+v0+"  C"+A+"  "},this.breakpoint=function(u){if(this.trace)var x="CPU Breakpoint!  "+(u?"("+u+")":"")+`

`+this.toString()};var On=[7,6,0,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,6,6,0,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,0,6,0,6,3,3,3,3,2,0,2,0,4,4,4,4,2,6,0,0,4,4,4,4,2,5,2,0,0,5,0,0,2,6,2,6,3,3,3,3,2,2,2,0,4,4,4,4,2,5,0,5,4,4,4,4,2,4,2,0,4,4,4,4,2,6,0,8,3,3,5,5,2,2,2,2,4,4,3,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7,2,6,0,8,3,3,5,5,2,2,2,0,4,4,6,6,2,5,0,8,4,4,6,6,2,4,0,7,4,4,7,7],bt=[0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,0,1,1,1,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,2,1,0,1,0,0,0,1,0,1,0,1,1,1,0,1],Ct=[1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,3,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,1,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,0,2,0,2,2,2,2,2,1,0,1,0,3,3,3,3,2,2,0,0,2,2,2,3,1,3,1,0,0,3,0,0,2,2,2,2,2,2,2,2,1,2,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,3,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,2,1,2,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3,2,2,0,2,2,2,2,2,1,2,1,0,3,3,3,3,2,2,0,2,2,2,2,2,1,3,0,3,3,3,3,3],Lt=[1,2,0,0,0,2,2,0,1,2,1,0,0,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,3,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,1,2,0,0,0,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,1,2,0,0,0,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,0,2,0,0,2,2,2,0,1,0,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,3,1,0,0,3,0,0,2,2,2,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,3,1,0,3,3,3,0,2,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0,2,2,0,0,2,2,2,0,1,2,1,0,3,3,3,0,2,2,0,0,0,2,2,0,1,3,0,0,0,3,3,0];this.getOpcodeMetadata=function(u,x){return{opcode:u,mnenomic:t[u],minCycles:On[u],maxCycles:On[u]+bt[u],insnlength:Ct[u]}},this.setNMI=function(){O0=vt(),w=1,i=i-1&65535},this.setIRQ=function(){O0=at(),w=1,i=i-1&65535},this.getSP=function(){return T},this.getPC=function(){return i-1&65535},this.getT=function(){return w},this.isPCStable=function(){return w==0}},D0;(function(i){i[i.None=0]="None",i[i.NMI=1]="NMI",i[i.IRQ=2]="IRQ"})(D0||(D0={}));var Pt=class{constructor(){this.cpu=new st;this.interruptType=0}connectMemoryBus(v){this.cpu.connectBus(v)}advanceClock(){if(this.interruptType&&this.isStable()){switch(this.interruptType){case 1:this.cpu.setNMI();break;case 2:this.cpu.setIRQ();break}this.interruptType=0}this.cpu.clockPulse()}advanceInsn(){do this.advanceClock();while(!this.isStable())}reset(){this.cpu.reset(),this.interruptType=0}interrupt(v){this.interruptType=v}NMI(){this.interrupt(1)}IRQ(){this.interrupt(2)}getSP(){return this.cpu.getSP()}getPC(){return this.cpu.getPC()}saveState(){var v=this.cpu.saveState();return v.it=this.interruptType,v}loadState(v){this.cpu.loadState(v),this.interruptType=v.it}isStable(){return this.cpu.isPCStable()}};export{Pt as a};
//# sourceMappingURL=chunk-LFTGHW2G.js.map
