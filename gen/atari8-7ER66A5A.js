import{a as W}from"./chunk-PVJ5UPJQ.js";import{A as G,H as A,g as B,k as N,o as U,q as z,s as H,x as j}from"./chunk-OKJZYBWI.js";import"./chunk-HKPUADCX.js";import{$ as m,J as x,O as c,U as _,V as s,W as D,Y as u,a as y,g as l,s as L}from"./chunk-UWX4LVLA.js";import"./chunk-5XVCUSSZ.js";var nt=[s.VK_L,s.VK_J,s.VK_SEMICOLON,s.VK_F1,s.VK_F2,s.VK_K,s.VK_SLASH,s.VK_TILDE,s.VK_O,null,s.VK_P,s.VK_U,s.VK_ENTER,s.VK_I,s.VK_MINUS,s.VK_EQUALS,s.VK_V,s.VK_F8,s.VK_C,s.VK_F3,s.VK_F4,s.VK_B,s.VK_X,s.VK_Z,s.VK_4,null,s.VK_3,s.VK_6,s.VK_ESCAPE,s.VK_5,s.VK_2,s.VK_1,s.VK_COMMA,s.VK_SPACE,s.VK_PERIOD,s.VK_N,null,s.VK_M,s.VK_SLASH,null,s.VK_R,null,s.VK_E,s.VK_Y,s.VK_TAB,s.VK_T,s.VK_W,s.VK_Q,s.VK_9,null,s.VK_0,s.VK_7,s.VK_BACK_SPACE,s.VK_8,s.VK_LEFT,s.VK_RIGHT,s.VK_F,s.VK_H,s.VK_D,null,s.VK_CAPS_LOCK,s.VK_G,s.VK_S,s.VK_A],ht=u([[s.UP,0,1],[s.DOWN,0,2],[s.LEFT,0,4],[s.RIGHT,0,8],[s.VK_SPACE,2,1],[s.START,3,1],[s.SELECT,3,2],[s.VK_OPEN_BRACKET,3,4]]),ct=[999,26,18,10],ot=[999,26+64,18+80,10+96],o=0,lt=1,M=2,P=3;var dt=7,ft=9,p=10,xt=11,mt=12,ut=13,Y=14,pt=15,b=15;var bt=[0,0,8,10,8,16,8,16,8,4,4,2,1,2,1,1],gt=[0,0,2,2,2,2,4,4,8,4,4,4,4,2,2,2],yt=[0,0,0,0,0,1,0,1,0,0,2,1,0,0,0,0],_t=[0,0,1,1,2,2,2,2,8,4,4,2,2,2,2,1],S=class{constructor(t){this.regs=new Uint8Array(16);this.nmiPending=!1;this.dliop=0;this.mode=0;this.jmp=!1;this.lms=!1;this.dlarg_lo=0;this.dlarg_hi=0;this.period=0;this.scanaddr=0;this.startaddr=0;this.pfbyte=0;this.ch=0;this.linesleft=0;this.yofs=0;this.v=0;this.h=0;this.linebuf=new Uint8Array(48);this.dmaclock=0;this.dmaidx=0;this.output=0;this.dramrefresh=!1;this.read=t}reset(){this.regs.fill(0),this.regs[Y]=0,this.regs[b]=127,this.regs[mt]=0,this.regs[ut]=255,this.setReg(o,0),this.h=this.v=0,this.startaddr=this.scanaddr=0,this.dmaclock=0}saveState(){return{regs:this.regs.slice(0),mode:this.mode,period:this.period,scanaddr:this.scanaddr,startaddr:this.startaddr,pfbyte:this.pfbyte,ch:this.ch,linesleft:this.linesleft,yofs:this.yofs,v:this.v,h:this.h,linebuf:this.linebuf.slice(0),dmaidx:this.dmaidx,dmaclock:this.dmaclock,output:this.output,dramrefresh:this.dramrefresh}}loadState(t){this.regs.set(t.regs),this.setReg(o,t.regs[o]),this.mode=t.mode,this.period=t.period,this.scanaddr=t.scanaddr,this.startaddr=t.startaddr,this.pfbyte=t.pfbyte,this.ch=t.ch,this.linesleft=t.linesleft,this.yofs=t.yofs,this.v=t.v,this.h=t.h,this.linebuf.set(t.linebuf),this.dmaidx=t.dmaidx,this.dmaclock=t.dmaclock,this.output=t.output,this.dramrefresh=t.dramrefresh}static stateToLongString(t){let e="";return e+="H: "+y(t.h,3)+" V: "+y(t.v,3)+" Linesleft: "+t.linesleft+`
`,e+="Mode: "+l(t.mode,2)+" Period: "+(t.period+1)+`
`,e+="Addr: "+l(t.scanaddr,4)+`
`,e+=_(t.regs,0,16).replace("$00","Regs"),e}setReg(t,e){switch(this.regs[t]=e,t){case p:this.regs[p]=255;break;case o:this.pfwidth=this.regs[o]&3,this.setLeftRight();break;case pt:this.regs[b]=31;break}}setLeftRight(){this.left=ct[this.pfwidth],this.right=ot[this.pfwidth]}readReg(t){switch(t){case b:return this.regs[t];case xt:return this.v>>1;default:return 255}}processDLIEntry(){this.mode==0?this.linesleft=(this.dliop>>4)+1:(this.linesleft=bt[this.mode],this.period=gt[this.mode],this.jmp?(this.regs[M]=this.dlarg_lo,this.regs[P]=this.dlarg_hi,this.mode=0,this.dliop&64&&(this.linesleft=248-this.v&255)):this.lms&&(this.scanaddr=this.dlarg_lo+(this.dlarg_hi<<8)),this.startaddr=this.scanaddr)}processLine(){this.linesleft>0&&(this.linesleft--,this.yofs++,this.mode>=8&&this.linesleft&&(this.scanaddr=this.startaddr))}triggerNMI(t){this.regs[Y]&t&&(this.nmiPending=!0),this.regs[b]=t|31}nextInsn(){let t=this.regs[M]+(this.regs[P]<<8),e=this.read(t);return t=t+1&1023|t&~1023,this.regs[M]=t&255,this.regs[P]=t>>8,e}nextScreen(){let t=this.read(this.scanaddr);return this.scanaddr=this.scanaddr+1&4095|this.scanaddr&~4095,t}dlDMAEnabled(){return this.regs[o]&32}pmDMAEnabled(){return this.regs[o]&12}isVisibleScanline(){return this.v>=8&&this.v<248}isPlayfieldDMAEnabled(){return this.dlDMAEnabled()&&!this.linesleft}isPlayerDMAEnabled(){return this.regs[o]&8}isMissileDMAEnabled(){return this.regs[o]&4352}clockPulse(){let t=this.regs[p]!=0;if(!this.isVisibleScanline())this.doVBlank();else{switch(this.h){case 0:this.isMissileDMAEnabled()&&(this.doPlayerMissileDMA(3),t=!0);break;case 1:if(this.isPlayfieldDMAEnabled()){let e=this.nextInsn();this.jmp=(e&~64)==1,this.lms=(e&64)!=0&&(e&15)!=0,this.mode=e&15,this.dliop=e,this.yofs=0,t=!0}break;case 2:case 3:case 4:case 5:this.isPlayerDMAEnabled()&&(this.doPlayerMissileDMA(6-this.h),t=!0);break;case 6:case 7:this.yofs==0&&this.isPlayfieldDMAEnabled()&&(this.jmp||this.lms)&&(this.h==6&&(this.dlarg_lo=this.nextInsn()),this.h==7&&(this.dlarg_hi=this.nextInsn()),t=!0);break;case 9:this.yofs==0&&this.processDLIEntry();break;case 8:this.dliop&128&&this.linesleft==1&&this.triggerNMI(128);break;case 111:this.processLine(),++this.v;break}if(this.output=0,this.mode>=2){let e=this.h<106;this.dmaclock<<=1,this.dmaclock&1<<this.period&&(this.dmaclock|=1),this.h==this.left&&(this.dmaclock|=1,this.dmaidx=0),this.h==this.right&&(this.dmaclock&=~1,this.dmaidx++),this.dmaclock&1?(this.mode<8&&this.yofs==0&&(this.linebuf[this.dmaidx]=this.nextScreen(),t=e),this.dmaidx++):this.dmaclock&8&&(this.ch=this.linebuf[this.dmaidx-4/this.period],this.readBitmapData(),t=e),this.output=this.h>=this.left+3&&this.h<=this.right+2?4:0}}return(this.h<19||this.h>102)&&(this.output=2),this.incHorizCounter(),!t&&this.dramrefresh&&(this.dramrefresh=!1,t=!0),t}incHorizCounter(){switch(++this.h,this.h){case 25:case 25+4*1:case 25+4*2:case 25+4*3:case 25+4*4:case 25+4*5:case 25+4*6:case 25+4*7:case 25+4*8:this.dramrefresh=!0;break;case 105:this.regs[p]=0;break;case 114:this.h=0;break}}doVBlank(){this.linesleft=this.mode=0,this.h==111&&this.v++,this.v==248&&this.h==0&&this.triggerNMI(64),this.v==262&&this.h==112&&(this.v=0),this.output=2}doPlayerMissileDMA(t){let e=this.regs[o]&16,i=this.regs[dt]<<8;e?(i&=63488,i|=t<<8,i+=this.v&255):(i&=32256,i|=t<<7,i+=this.v>>1),this.read(i)}readBitmapData(){let t=this.mode;if(t<8){let e=this.ch,i=this.yofs>>yt[this.mode],a=i&7,h=this.regs[ft];(t&14)==6?(e&=63,h&=254):(e&=127,h&=252);let n=(e<<3)+(h<<8);if((t&14)==2){let f=this.regs[lt],F=t==3&&(e&96)==96;f&4?this.pfbyte=this.read(n+(a^7)):this.pfbyte=this.read(n+a),F&&i<2&&(this.pfbyte=0),!F&&i>7&&(this.pfbyte=0),this.ch&128&&(f&1&&(this.pfbyte=0),f&2&&(this.pfbyte^=255))}else this.pfbyte=this.read(n+a)}else this.pfbyte=this.nextScreen()}shiftout(){if(this.output==4)switch(this.mode){case 2:case 3:case 15:{let t=this.pfbyte>>7&1;return this.pfbyte<<=1,t?8:6}case 6:case 7:{let t=this.pfbyte>>7&1;return this.pfbyte<<=1,t?(this.ch>>6)+4:0}case 9:case 11:case 12:{let t=this.pfbyte>>7&1;return this.pfbyte<<=1,t?4:0}case 4:case 5:case 8:case 10:case 13:case 14:{let t=this.pfbyte>>6&3;return this.pfbyte<<=2,[0,4,5,6][t]}}return this.output}},At=0;var Mt=8,Pt=12,q=13,Q=17,St=18,Rt=22,Kt=23,Ct=24;var wt=26;var J=29,It=30;var Ot=0,R=4,kt=8,K=12,Vt=16,C=31,w=class{constructor(){this.regs=new Uint8Array(32);this.shiftregs=new Uint32Array(8);this.count=0;this.an=0;this.rgb=0;this.pmcol=0;this.console_inputs=0}reset(){this.regs.fill(0),this.count=0}saveState(){return{regs:this.regs.slice(0),shiftregs:this.shiftregs.slice(0),count:this.count,console_inputs:this.console_inputs}}loadState(t){this.regs.set(t.regs),this.shiftregs.set(t.shiftregs),this.count=t.count,this.console_inputs=t.console_inputs}setReg(t,e){switch(t){case C:e=e&15^15;break;case It:this.regs[R]=this.regs[K]=this.regs[Ot]=this.regs[kt]=0;break}this.regs[t]=e}readReg(t){return t==C?this.console_inputs&this.regs[C]:this.regs[t]}updateGfx(t,e){switch(t){case 0:this.count=0,this.regs[J]&1&&(this.regs[Q]=e);break;case 2:case 3:case 4:case 5:this.regs[J]&2&&(this.regs[q-2+t]=e);break}}getPlayfieldColor(){let t=0;switch(this.an){case 0:t=this.regs[wt];break;case 2:case 3:t=0;break;case 4:case 5:case 6:case 7:t=this.regs[Rt+this.an-4];break;case 8:t=this.regs[Ct]&240|this.regs[Kt]&15;break}return t}clockPulse1(){let t=-1,e=-1,i=this.an>4,a=this.regs[R],h=this.regs[K];for(let n=0;n<8;n++){let f=this.getPlayerMissileColor(n);f>=0&&(i&&(h|=1<<n),e>0&&(h|=1<<n,h|=1<<e),t=f,e=n)}this.regs[R]=a,this.regs[K]=h,this.pmcol=t,this.count++,this.clockPulse2()}clockPulse2(){let t=this.getPlayfieldColor();this.pmcol>=0&&(t=this.pmcol),this.rgb=$[t]}getPlayerMissileColor(t){let e=this.shiftregs[t]&2147483648;return this.shiftregs[t]<<=1,this.regs[At+t]-7==this.count&&this.triggerObject(t),e?this.regs[St+(t&3)]:-1}triggerObject(t){let e,i;t<4?(e=this.regs[Mt+t]&3,i=this.regs[q+t]):(e=this.regs[Pt]>>(t-4)*2&3,i=this.regs[Q]&1<<t),e&1?i=Z(i):i<<=8,e==3?i=Z(i):i<<=16,this.shiftregs[t]=i}static stateToLongString(t){let e="";return e+=_(t.regs,0,32),e}};function Z(r){return r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,r|r<<1}var g=class extends U{constructor(){super();this.cpuFrequency=1789773;this.numTotalScanlines=262;this.cpuCyclesPerLine=114;this.canvasWidth=352;this.aspectRatio=240/172;this.firstVisibleClock=34*2;this.numVisibleScanlines=250;this.defaultROMSize=32768;this.overscan=!0;this.audioOversample=4;this.sampleRate=this.numTotalScanlines*60*this.audioOversample;this.inputs=new Uint8Array(4);this.linergb=new Uint32Array(this.canvasWidth);this.lastdmabyte=0;this.keycode=0;this.irqstatus=0;this.cpu=new H,this.ram=new Uint8Array(65536),this.bios=new Uint8Array(10240),this.bus=this.newBus(),this.connectCPUMemoryBus(this.bus),this.antic=new S(this.readDMA.bind(this)),this.gtia=new w,this.pokey=B(1),this.audioadapter=new N(this.pokey.pokey1,this.audioOversample,this.sampleRate),this.handler=D(this.inputs,ht,this.getKeyboardFunction(),!0)}newBus(){return{read:m([[0,40959,65535,t=>this.ram[t]],[40960,49151,65535,t=>this.rom?this.rom[t-40960]:this.ram[t]],[53248,53503,31,t=>this.gtia.readReg(t)],[53760,54015,15,t=>this.readPokey(t)],[54016,54271,15,t=>this.readPIA(t)],[54272,54527,15,t=>this.antic.readReg(t)],[55296,65535,65535,t=>this.bios[t-55296]]]),write:m([[0,49151,65535,(t,e)=>{this.ram[t]=e}],[53248,53503,31,(t,e)=>{this.gtia.setReg(t,e)}],[53760,54015,15,(t,e)=>{this.writePokey(t,e)}],[54272,54527,15,(t,e)=>{this.antic.setReg(t,e)}]])}}loadBIOS(t){this.bios.set(t)}reset(){super.reset(),this.antic.reset(),this.gtia.reset(),this.keycode=0,this.irqstatus=0}read(t){return this.bus.read(t)}readDMA(t){let e=this.bus.read(t);return this.probe.logVRAMRead(t,e),this.lastdmabyte=e,e}readConst(t){return t<53248||t>=57344?this.bus.read(t):255}write(t,e){this.bus.write(t,e)}readPokey(t){switch(t){case 9:return this.keycode&255;case 14:return this.irqstatus^255;case 15:return~this.keycode>>6&4|~this.keycode>>3&8|18;default:return 255}}readPIA(t){if(t==0||t==1)return~this.inputs[t]}writePokey(t,e){switch(t){case 13:this.sendIRQ(24);break;case 14:this.irqstatus=0;break}this.pokey.pokey1.setRegister(t,e)}startScanline(){this.gtia.regs[Vt]=~this.inputs[2],this.gtia.console_inputs=this.inputs[3]^7,this.audio&&this.audioadapter.generate(this.audio)}drawScanline(){this.antic.v<this.numVisibleScanlines&&this.pixels.set(this.linergb,this.antic.v*this.canvasWidth)}advanceCPU(){this.antic.clockPulse()?this.probe.logClocks(1):(this.antic.nmiPending&&(this.cpu.NMI(),this.probe.logInterrupt(1),this.antic.nmiPending=!1),super.advanceCPU());let t=()=>{this.gtia.clockPulse1(),this.linergb[i++]=this.gtia.rgb},e=()=>{this.gtia.clockPulse2(),this.linergb[i++]=this.gtia.rgb};this.gtia.updateGfx(this.antic.h-1,this.lastdmabyte);let i=this.antic.h*4-this.firstVisibleClock,a=_t[this.antic.mode];return(a<8||(i&4)==0)&&(this.gtia.an=this.antic.shiftout()),t(),a==1&&(this.gtia.an=this.antic.shiftout()),e(),a<=2&&(this.gtia.an=this.antic.shiftout()),t(),a==1&&(this.gtia.an=this.antic.shiftout()),e(),1}loadState(t){this.cpu.loadState(t.c),this.ram.set(t.ram),this.antic.loadState(t.antic),this.gtia.loadState(t.gtia),this.loadControlsState(t),this.lastdmabyte=t.lastdmabyte,this.keycode=t.keycode,this.irqstatus=t.irqstatus}saveState(){return{c:this.cpu.saveState(),ram:this.ram.slice(0),antic:this.antic.saveState(),gtia:this.gtia.saveState(),inputs:this.inputs.slice(0),lastdmabyte:this.lastdmabyte,keycode:this.keycode,irqstatus:this.irqstatus}}loadControlsState(t){this.inputs.set(t.inputs)}saveControlsState(){return{inputs:this.inputs.slice(0)}}getRasterScanline(){return this.antic.v}getDebugCategories(){return["CPU","Stack","ANTIC","GTIA","POKEY"]}getDebugInfo(t,e){switch(t){case"ANTIC":return S.stateToLongString(e.antic);case"GTIA":return w.stateToLongString(e.gtia);case"POKEY":{let i="";for(let a=0;a<16;a++)i+=l(this.readPokey(a))+" ";return i+=`
IRQ Status: `+l(this.irqstatus)+`
`,i}}}getKeyboardFunction(){return(t,e,i,a)=>{if(a&(c.KeyDown|c.KeyUp)){var h=nt;if(e==s.VK_F9.c)return this.sendIRQ(128),!0;for(var n=0;n<h.length;n++)if(h[n]&&h[n].c==e&&(this.keycode=n,a&c.Shift&&(this.keycode|=64),a&c.Ctrl&&(this.keycode|=128),a&c.KeyDown))return this.keycode|=256,this.sendIRQ(64),console.log(t,e,i,a,l(this.keycode)),!0}}}sendIRQ(t){this.pokey.pokey1.getRegister(14)&t&&(this.irqstatus=t,this.cpu.IRQ(),this.probe.logInterrupt(2))}loadROM(t){super.loadROM(t)}},I=class extends g{newBus(){return{read:m([[0,16383,65535,t=>this.ram[t]],[16384,49151,65535,t=>this.rom?this.rom[t-16384]:0],[49152,53247,31,t=>this.gtia.readReg(t)],[54272,54527,15,t=>this.antic.readReg(t)],[59392,61439,15,t=>this.readPokey(t)],[63488,65535,2047,t=>this.bios[t]]]),write:m([[0,16383,65535,(t,e)=>{this.ram[t]=e}],[49152,53247,31,(t,e)=>{this.gtia.setReg(t,e)}],[54272,54527,15,(t,e)=>{this.antic.setReg(t,e)}],[59392,61439,15,(t,e)=>{this.writePokey(t,e)}]])}}loadROM(t){let e=new Uint8Array(32768);for(let i=0;i<e.length;i+=t.length)e.set(t,i);super.loadROM(e)}},O=class extends z{constructor(){super(...arguments);this.numTotalScanlines=312;this.cpuCyclesPerLine=63;this.joymask0=0;this.joymask1=0}loadROM(t){super.loadROM(t),this.reloadROM()}reloadROM(){if(this.sys){var t=this.exports.machine_load_rom(this.sys,this.romptr,this.romlen);console.log("machine_load_rom",t)}}loadBIOS(t){super.loadBIOS(t)}reset(){super.reset(),this.reloadROM()}advanceFrame(t){return this.exports.machine_start_frame(this.sys),t?this.advanceFrameClock(t,999999):this.exports.machine_advance_frame(this.sys),this.syncVideo(),this.syncAudio(),1}getCPUState(){this.exports.machine_save_cpu_state(this.sys,this.stateptr);var t=this.statearr,e=t[6]+(t[7]<<8);return{PC:e,SP:t[2],A:t[0],X:t[3],Y:t[4],C:t[1]&1,Z:t[1]&2,I:t[1]&4,D:t[1]&8,V:t[1]&64,N:t[1]&128,o:this.readConst(e)}}saveState(){var t=this.getCPUState();return this.exports.machine_save_state(this.sys,this.stateptr),{c:t,state:this.statearr.slice(0)}}loadState(t){this.statearr.set(t.state),this.exports.machine_load_state(this.sys,this.stateptr)}getVideoParams(){return{width:384,height:240,overscan:!0,videoFrequency:60}}pollControls(){}setKeyInput(t,e,i){i&c.Shift&&(t|=256),i&c.Ctrl&&(t|=512);var a=0;t==37&&(t=8,a=4),t==38&&(t=11,a=1),t==39&&(t=9,a=8),t==40&&(t=10,a=2),t==32&&(a=256),i&c.KeyDown?(this.exports.machine_key_down(this.sys,t),this.joymask0|=a):i&c.KeyUp&&(this.exports.machine_key_up(this.sys,t),this.joymask0&=~a),this.setJoyInput(0,this.joymask0),this.setJoyInput(1,this.joymask1)}setJoyInput(t,e){this.exports.machine_joy_set(this.sys,t,e)}setPaddleInput(t,e){this.exports.machine_paddle_set(this.sys,t,e)}},X=[0,4210752,7105644,9474192,11579568,13158600,14474460,16053492,17476,1074276,2393220,3448992,4241592,5296336,6088936,6880508,10352,1328260,2645144,3963052,5016764,6070476,6862044,7915756,6276,1586328,3166380,4745408,6062288,7378144,8431852,9747708,136,2105500,3947696,5789888,7368912,8947936,10526956,11842812,6029432,7610508,8928416,10246320,11563200,12616912,13671644,14725356,7864392,9445472,10763384,12081292,13398176,14451892,15506628,16560340,8650772,9969712,11287628,12605544,13660284,14715028,15507624,16561340,8912896,10231836,11550776,12606544,13661288,14716028,15508624,16562340,8132608,9451548,11031608,12349520,13404264,14457980,15512720,16566436,6040576,7883804,9463864,11306064,12622952,13939836,15256720,16572580,2898944,4742172,6585400,8428624,9745512,11325564,12641424,13958308,15360,2120736,4226112,6069340,7648372,9228428,10806436,12123320,14356,1858612,3701840,5281900,6861956,8178844,9495732,10812616,12332,1855564,3436648,5016708,6596764,7913652,8967372,10284256,10308,1591396,3172484,4490400,5807288,7124176,8178920,9232636],$=new Uint32Array(256),Et=[];for(d=0;d<256;d++)$[d]=X[d>>1]|4278190080,Et[d]="#"+l(L(X[d>>1]),6);var d;var tt=[{id:"hello.dasm",name:"Hello World (ASM)"},{id:"hellopm.dasm",name:"Hello Sprites (ASM)"},{id:"helloconio.c",name:"Text Mode (C)"},{id:"siegegame.c",name:"Siege Game (C)"},{id:"hellodlist.c",name:"Display List (C)"}],k=tt.concat([{id:"sieve.bas",name:"Benchmark (FastBasic)"},{id:"pmtest.bas",name:"Sprites Test (FastBasic)"},{id:"dli.bas",name:"DLI Test (FastBasic)"},{id:"joyas.bas",name:"Match-3 Game (FastBasic)"}]),se=u([[s.VK_SPACE,0,0],[s.VK_ENTER,0,0]]),V={main:[{name:"RAM",start:0,size:49152,type:"ram"},{name:"Left Cartridge ROM",start:40960,size:8192,type:"rom"},{name:"GTIA",start:53248,size:32,type:"io"},{name:"POKEY",start:53760,size:16,type:"io"},{name:"PIA",start:54016,size:4,type:"io"},{name:"ANTIC",start:54272,size:16,type:"io"},{name:"Cartridge Control Line",start:54784,size:256,type:"io"},{name:"ROM",start:55296,size:2048,type:"rom"},{name:"Character Set",start:57344,size:1024,type:"rom"},{name:"ROM",start:58368,size:7168,type:"rom"}]};function E(r){return r.endsWith(".bas")||r.endsWith(".fb")||r.endsWith(".fbi")?"fastbasic":j(r)}var v=class extends W{constructor(){super(...arguments);this.getToolForFilename=E;this.getOpcodeMetadata=G}getPresets(){return tt}getDefaultExtension(){return".asm"}showHelp(t,e){t=="fastbasic"?window.open("https://github.com/dmsc/fastbasic/blob/master/manual.md","_help"):window.open("https://atariwiki.org/wiki/Wiki.jsp?page=Assembler","_help")}};var et=class extends v{constructor(){super(...arguments);this.getMemoryMap=function(){return V}}getPresets(){return k}loadROM(t,e){this.started?(this.loadROMFile(e),this.loadRegion(":cartleft:cart:rom",e)):this.startModule(this.mainElement,{jsfile:"mame8bitws.js",biosfile:"a800xl.zip",cfgfile:"a800xl.cfg",driver:"a800xl",width:336*2,height:225*2,romfn:"/emulator/cart.rom",romdata:new Uint8Array(e),romsize:8192,preInit:function(i){}})}start(){}},st=class extends v{constructor(){super(...arguments);this.getMemoryMap=function(){return{main:[{name:"RAM",start:0,size:16384,type:"ram"},{name:"Cartridge ROM",start:16384,size:32768,type:"rom"},{name:"GTIA",start:49152,size:32,type:"io"},{name:"ANTIC",start:54272,size:16,type:"io"},{name:"POKEY",start:59392,size:16,type:"io"},{name:"ATARI Character Set",start:63488,size:1024,type:"rom"},{name:"ROM",start:64512,size:1024,type:"rom"}]}}}loadROM(t,e){this.started?(this.loadROMFile(e),this.loadRegion(":cartleft:cart:rom",e)):this.startModule(this.mainElement,{jsfile:"mame8bitws.js",biosfile:"a5200/5200.rom",cfgfile:"a5200.cfg",driver:"a5200",width:336*2,height:225*2,romfn:"/emulator/cart.rom",romdata:new Uint8Array(e),romsize:32768,preInit:function(i){}})}start(){}},it=class extends A{constructor(){super(...arguments);this.getToolForFilename=E}newMachine(){return new O("atari8")}getPresets(){return k}getDefaultExtension(){return".c"}readAddress(t){return this.machine.readConst(t)}getMemoryMap(){return V}showHelp(){}getROMExtension(t){return t&&t[0]==1&&t[1]==8?".prg":".bin"}},rt=class extends it{},T=class extends A{constructor(){super(...arguments);this.getToolForFilename=E;this.biosPath="res/altirra/kernel.rom"}newMachine(){return new g}getPresets(){return k}getDefaultExtension(){return".c"}readAddress(t){return this.machine.readConst(t)}getMemoryMap(){return V}showHelp(){}getROMExtension(t){return t&&t[0]==1&&t[1]==8?".prg":".bin"}async start(){let t=await this.loadKernel();await super.start(),this.machine.loadBIOS(t)}async loadKernel(){var t=await fetch(this.biosPath);if(t.status==200||t.size){var e=await t.arrayBuffer();return new Uint8Array(e)}else throw new Error("could not load BIOS file")}},at=class extends T{constructor(){super(...arguments);this.biosPath="res/altirra/superkernel.rom"}newMachine(){return new I}};x["atari8-800.xlmame"]=et;x["atari8-5200.mame"]=st;x["atari8-800.xlwasm"]=rt;x["atari8-800"]=T;x["atari8-5200"]=at;
//# sourceMappingURL=atari8-7ER66A5A.js.map
